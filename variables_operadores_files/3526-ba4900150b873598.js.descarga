"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([["3526"],{365644:function(e,t,r){r.d(t,{$:()=>d});var n=r(314121),o=r(214813),a=r(714844),i=r(100334),l=r(547550),u=r(904812);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var d=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.shouldUseDebounce,d=void 0===r||r,p=(e=(0,n.useState)(null),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return s(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=p[0],m=p[1],y=(0,a.useMutation)(function(e){var t;return t=e,(0,l.Cu)(u.av.emailValidations.create(),{email:t})}),b=y.mutateAsync,v=y.isLoading,h="production"===window.RAILS_ENV,_=(0,n.useCallback)(function(e){var t;return(t=function(){var t;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(!h)return[2,!0];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,b(e)];case 2:if(!(t=r.sent()).accept_as_signup)return t.did_you_mean&&m(t.did_you_mean),[2,(0,i.t)("".concat("authentication_app.signup",".form.errors.please_enter_valid_email_address"))];return m(null),[2,!0];case 3:return console.error(r.sent()),m(null),[2,!0];case 4:return[2]}})},function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function i(e){c(a,n,o,i,l,"next",e)}function l(e){c(a,n,o,i,l,"throw",e)}i(void 0)})})()},[b,h]),w=(0,n.useMemo)(function(){return(0,o.debounce)(function(e,t){_(e).then(t)},500)},[_]);return{validateEmail:(0,n.useCallback)(function(e){return e?d?new Promise(function(t){w(e,t)}):_(e):(m(null),Promise.resolve(!0))},[w,_,d]),isValidatingEmail:v,suggestedEmail:f}}},727492:function(e,t,r){r.d(t,{F_:()=>i,po:()=>n,rl:()=>o,y_:()=>a});var n="settings.paywalls.modal.tabs.checkout",o={DEFAULT:"default",TESTIMONIALS:"testimonials",BADGES:"badges",BENEFITS:"benefits",COUNTDOWN:"countdown",PRICE_CALLOUTS:"price_callouts",REDUCED_PRICES:"reduced_prices"},a={STARS:"stars",QUOTATION_MARK:"quotation_mark"},i={STARS:"#FDB022",QUOTATION_MARK:"#000000"}},52932:function(e,t,r){r.d(t,{O:()=>i,z:()=>l});var n=r(698365),o=r(588893),a=/\D/g,i=function(e){return null==e?0:Number((String(e)||"0").replace(a,""))},l={serializeCountdownProperties:function(e){var t,r,a;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({enabled:null!=(a=null==e?void 0:e.enabled)&&a,displayed_text:(null==e?void 0:e.displayed_text)||"",action:(0,n.d0)(null==e||null==(t=e.action)?void 0:t.action_type)?{action_type:o.KW.REDIRECT_TO,redirect_to:null==e||null==(r=e.action)?void 0:r.redirect_to}:{action_type:o.KW.DO_NOTHING}},(0,n.$Z)(null==e?void 0:e.countdown_type)?{countdown_type:o.sI.REMAINING_TIME,remaining_time:Number(null==e?void 0:e.remaining_time),remaining_time_interval:"minutes"}:{countdown_type:o.sI.FINISH_AT,finish_at:e.finish_at?new Date(e.finish_at).toISOString():new Date().toISOString()})},serializePriceCalloutProperties:function(e){var t,r;return{callout_color:null!=(t=e.callout_color)?t:n.Um,prices:null!=(r=e.prices)?r:[]}},serializeReducedPriceProperties:function(e){return{prices:((null==e?void 0:e.prices)||[]).map(function(e){return{price_id:e.price_id,amount:i(e.amount),upfront_amount:i(e.upfront_amount),enabled:e.enabled}})}}}},385972:function(e,t,r){r.d(t,{Jd:()=>i,qm:()=>a,sm:()=>o});var n=r(314121),o=(0,n.createContext)(null);o.displayName="PaywallCheckoutAttemptsContext";var a=function(){return(0,n.useContext)(o)},i=function(){var e=a();if(!e)throw Error("usePaywallCheckoutAttemptsContext must be used within PaywallCheckoutAttemptsProvider");return e}},213070:function(e,t,r){r.d(t,{a:()=>J});var n=r(683551),o=r(314121),a=r(763536),i=r(557273),l=r(599631),u=r(396335),s=r(563506),c=r(705206),d=r(385972),p=r(564514),f=r(678731),m=r(672842),y=r(83793),b=r(280658),v=r(36630);function h(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var _=function(e,t){return{return_url:t,payment_method_data:{billing_details:{email:e.email,name:e.name,address:{city:e.city,country:e.country,line1:e.line1,line2:e.line2,postal_code:e.postalCode,state:e.state}}}}},w=function(e){var t,r=e.caller,n=e.confirmParams,o=e.paymentIntentClientSecret,a=e.stripe,i=e.stripeElements;return(t=function(){var e,t,l;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(u){switch(u.label){case 0:return[4,a.retrievePaymentIntent(o)];case 1:if((e=u.sent()).error)throw f.K.fromStripeError(r,e.error);if((null==(t=e.paymentIntent)?void 0:t.status)==="succeeded")return[2];if(!i)return[3,3];return[4,a.confirmPayment({clientSecret:o,confirmParams:n,elements:i,redirect:"if_required"})];case 2:return l=u.sent(),[3,5];case 3:return[4,a.confirmPayment({clientSecret:o,confirmParams:n,redirect:"if_required"})];case 4:l=u.sent(),u.label=5;case 5:if(l.error)throw f.K.fromStripeError(r,l.error);return[2]}})},function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function i(e){h(a,n,o,i,l,"next",e)}function l(e){h(a,n,o,i,l,"throw",e)}i(void 0)})})()};function g(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){g(a,n,o,i,l,"next",e)}function l(e){g(a,n,o,i,l,"throw",e)}i(void 0)})}}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function O(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var P=function(e){var t=e.communityProcessorPaymentMethodConfigurationId,r=e.doesCommunityProcessorSupportsLink,n=e.doesMemberHasDefaultPaymentMethod,a=e.isExpressMode,i=e.isMemberUsingDefaultPaymentMethod,l=e.memberProcessorCustomerSessionClientSecret,u=(0,y.D)(),s=(0,y.p)(),c=(0,o.useRef)(null);return(0,o.useEffect)(function(){return function(){var e=s();e&&c.current&&(e.stripeElements.off("update-end",c.current),c.current=null,(0,b.EZ)("useConfirmPayment.elements.off('update-end') - cleaned up listener",{type:"manual"}))}},[s]),(0,o.useCallback)(function(e){var o=e.memberAddress,s=e.paymentIntentClientSecret,d=e.paymentMethodType,p=e.returnUrl;return new Promise(function(e,m){var y=u("useConfirmPayment.confirmPayment"),h=y.stripe,g=y.stripeElements;if(a)return void x(function(){var t;return O(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,w({caller:"useConfirmPayment.confirmPayment.expressMode",confirmParams:_(o,p),paymentIntentClientSecret:s,stripe:h,stripeElements:void 0})];case 1:return r.sent(),e(!0),[3,3];case 2:return t=r.sent(),m(f.K.fromUnknownError("useConfirmPayment.confirmPayment.expressMode",t)),[3,3];case 3:return[2]}})})();var P=function(){x(function(){var r,n,a;return O(this,function(i){switch(i.label){case 0:if(!c.current)return[2];g.off("update-end",c.current),c.current=null,(0,b.EZ)("useConfirmPayment.confirmPayment.elements.off('update-end') - removed listener",{type:"manual"}),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,w({caller:"useConfirmPayment.confirmPayment",confirmParams:_(o,p),paymentIntentClientSecret:s,stripe:h,stripeElements:g})];case 2:return i.sent(),[3,5];case 3:return n=i.sent(),r=f.K.fromUnknownError("useConfirmPayment.confirmPayment",n),[3,5];case 4:return a={customerSessionClientSecret:l,payment_method_configuration:t,payment_method_types:null,setup_future_usage:null},(0,b.EZ)("useConfirmPayment.elements.update - restored original options",{metadata:j({},a),type:"manual"}),g.update(a),[7];case 5:if(r)return m(r),[2];return e(!0),[2]}})})()};c.current=P,(0,b.EZ)("useConfirmPayment.elements.on('update-end') - attached listener",{type:"manual"}),g.on("update-end",P);var S={customerSessionClientSecret:(0,v.Me)(l,d,n,i),payment_method_configuration:null,payment_method_types:(0,v.m9)(r,d),setup_future_usage:(0,v.O3)(d)};(0,b.EZ)("useConfirmPayment.elements.update - triggered 'update-end' event",{metadata:j({},S),type:"manual"}),g.update(S)})},[t,r,n,u,a,i,l])},S=r(600651);function k(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var I=function(e){var t=e.communityId,r=e.paymentMethodType,n=e.paywallPriceId,a=e.sessionStepId;return(0,o.useCallback)(function(e){var o;return(o=function(){var o,i,l,u;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(s){switch(s.label){case 0:var c,d;return[4,S.k.create_DEPRECATED({formData:(c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),d=d={payment_method_type:r||"card",community_id:t,paywall_price_id:n,checkout_session_step_id:a},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(d)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(d)).forEach(function(e){Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(d,e))}),c)})];case 1:if(!(!(o=s.sent())||!o.ok))return[3,3];return[4,null==o||null==(i=o.json)?void 0:i.call(o)];case 2:throw l=s.sent(),f.K.fromPaywallError("useCreateAttempt.createAttempt",l);case 3:return[4,o.json()];case 4:return[2,{id:(u=s.sent()).checkout_attempt_id,invoiceId:u.invoice_processor_id,paymentIntentClientSecret:u.payment_intent_client_secret,paymentIntentId:u.payment_intent_processor_id}]}})},function(){var e=this,t=arguments;return new Promise(function(r,n){var a=o.apply(e,t);function i(e){k(a,r,n,i,l,"next",e)}function l(e){k(a,r,n,i,l,"throw",e)}i(void 0)})})()},[t,r,n,a])};function C(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var E=function(e){var t=e.communityId,r=e.paywallPriceId,n=(0,y.D)();return(0,o.useCallback)(function(e){var o,a=e.memberAddress;return(o=function(){var e,o,i,l,u,s,c,d,p,m;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(y){switch(y.label){case 0:return o=(e=n("setupPaymentMethod")).stripe,i=e.stripeElements,[4,S.k.prepare_DEPRECATED(t,r)];case 1:if(!(!(l=y.sent())||!l.ok))return[3,3];return[4,null==l||null==(u=l.json)?void 0:u.call(l)];case 2:throw s=y.sent(),f.K.fromPaywallError("setupPaymentMethod",s);case 3:return[4,l.json()];case 4:return c=y.sent().setup_intent.client_secret,[4,o.retrieveSetupIntent(c)];case 5:if((d=y.sent()).error)throw f.K.fromStripeError("setupPaymentMethod",d.error);if("succeeded"===d.setupIntent.status)return[2,d.setupIntent.payment_method];return p=_(a,window.location.href),[4,o.confirmSetup({elements:i,clientSecret:c,confirmParams:p,redirect:"if_required"})];case 6:if((m=y.sent()).error)throw f.K.fromStripeError("setupPaymentMethod",m.error);return[2,m.setupIntent.payment_method]}})},function(){var e=this,t=arguments;return new Promise(function(r,n){var a=o.apply(e,t);function i(e){C(a,r,n,i,l,"next",e)}function l(e){C(a,r,n,i,l,"throw",e)}i(void 0)})})()},[t,n,r])};function N(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function A(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){N(a,n,o,i,l,"next",e)}function l(e){N(a,n,o,i,l,"throw",e)}i(void 0)})}}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function M(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function D(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var L=function(e){var t=e.canSubmitAttempt,r=e.communityId,n=e.communityProcessorPaymentMethodConfigurationId,a=e.doesCommunityProcessorSupportsLink,i=e.doesMemberHasDefaultPaymentMethod,u=e.isExpressMode,c=e.isMemberUsingDefaultPaymentMethod,d=e.isPaymentMethodRequired,b=e.memberAddress,v=e.memberProcessorCustomerSessionClientSecret,h=e.onStageChange,_=e.paymentMethodType,w=e.paywallPriceId,g=e.sessionId,x=e.sessionStepId,j=e.stripeElementsMode,O=(0,p.k6)(),S=(0,y.D)(),k=(0,o.useCallback)(function(e){O.replace(e)},[O]),C=(0,o.useMemo)(function(){return j===l.hX.setup&&d},[j,d]),N=(0,o.useCallback)(function(e){return A(function(){var t;return D(this,function(r){switch(r.label){case 0:return[4,S(e).stripeElements.submit()];case 1:if(null==(t=r.sent())?void 0:t.error)throw f.K.fromStripeError(e,t.error);return[2]}})})()},[S]),L=E({communityId:r,paywallPriceId:w}),R=I({communityId:r,paymentMethodType:_,paywallPriceId:w,sessionStepId:x}),U=P({communityProcessorPaymentMethodConfigurationId:n,doesCommunityProcessorSupportsLink:a,doesMemberHasDefaultPaymentMethod:i,isExpressMode:u,isMemberUsingDefaultPaymentMethod:c,memberProcessorCustomerSessionClientSecret:v});return(0,o.useCallback)(function(e){return A(function(){var r,n,o,a,i,l,c,d,p,y,v,w;return D(this,function(x){switch(x.label){case 0:if(!t())return r=f.K.generic("useSubmitAttempt.submitAttempt.cannotSubmit"),h({stage:s.U.failed,error:r}),[2];x.label=1;case 1:if(x.trys.push([1,10,,11]),u)return[3,3];return[4,N("useSubmitAttempt.submitAttempt")];case 2:x.sent(),x.label=3;case 3:if(n=M(T({},b),{name:b.name||e.name,email:b.email||e.email}),!C)return[3,5];return h({stage:s.U.settingUpPaymentMethod}),[4,L({memberAddress:n})];case 4:o=x.sent(),x.label=5;case 5:return h({stage:s.U.creatingAttempt}),i=null!=(a=e.community_member_billing_info_attributes)?a:{},[4,R(M(T({},e),{use_default_payment_method:u,community_member_billing_info_attributes:M(T({},i),{address_city:b.city,address_country:b.country,address_line1:b.line1,address_line2:b.line2,address_postal_code:b.postalCode,address_state:b.state}),payment_method_processor_id:o}))];case 6:if(c={invoiceId:(l=x.sent()).invoiceId,paymentIntentId:l.paymentIntentId,paymentMethodType:_,sessionId:g},d=(0,m.xB)(c),p=(0,m.$v)(c),y=function(){k(p)},!l.paymentIntentClientSecret||!l.paymentIntentId)return h({stage:s.U.confirmingAttempt}),y(),[2];if(!(C&&!u))return[3,8];return[4,N("useSubmitAttempt.submitAttempt.beforeConfirmPayment")];case 7:x.sent(),x.label=8;case 8:return h({stage:s.U.confirmingAttempt}),[4,U({memberAddress:n,paymentIntentClientSecret:l.paymentIntentClientSecret,paymentMethodType:_,returnUrl:d})];case 9:return x.sent(),y(),[3,11];case 10:return v=x.sent(),w=f.K.fromUnknownError("useSubmitAttempt",v),h({stage:s.U.failed,error:w}),[3,11];case 11:return[2]}})})()},[t,U,R,C,u,b,h,_,k,g,L,N])},R=r(849375),U=r(61146);function F(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function V(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){F(a,n,o,i,l,"next",e)}function l(e){F(a,n,o,i,l,"throw",e)}i(void 0)})}}function B(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var q=function(){var e=new URL(window.location.href);e.searchParams.delete("forwarded"),e.searchParams.delete("invoice"),e.searchParams.delete("payment_intent_client_secret"),e.searchParams.delete("payment_intent"),e.searchParams.delete("payment_method_type"),e.searchParams.delete("redirect_status"),window.history.replaceState({},"",e)},Z=function(e){var t=e.canVerifyAttempt,r=e.onStageChange;return(0,o.useCallback)(function(e){var n=e.invoiceId,o=void 0===n?"":n,a=e.paymentMethodType,i=void 0===a?"":a,l=e.paymentIntentId,u=void 0===l?"":l;return V(function(){var e,n,a;return B(this,function(l){switch(l.label){case 0:if(!t()||!o&&!u)return[2];r({stage:s.U.verifyingAttempt}),l.label=1;case 1:return l.trys.push([1,3,,4]),e=function(){var e;return e={invoice_id:o,payment_intent_id:u,payment_method_type:i},V(function(){var t;return B(this,function(r){switch(r.label){case 0:return[4,V(function(){var t;return B(this,function(r){switch(r.label){case 0:return[4,S.k.verifications.create(e)];case 1:if(!(t=r.sent())||!t.checkout_attempt_status)throw f.K.fromUnknownError("useVerifyAttempt.createVerification",t);return[2,{attemptId:t.checkout_attempt_id,attemptStatus:t.checkout_attempt_status,invoiceId:t.invoice_processor_id,paymentIntentId:t.payment_intent_processor_id,subscriptionId:t.subscription_processor_id}]}})})()];case 1:if(t=r.sent(),(0,R.wZ)(t.attemptStatus))return[2,null];return[2,t]}})})()},[4,(0,U.Tm)({executor:e})];case 2:if(!(n=l.sent()))throw f.K.generic("useVerifyAttempt.verifyAttempt");return r({attemptId:n.attemptId,attemptStatus:n.attemptStatus,invoiceId:n.invoiceId,paymentIntentId:n.paymentIntentId,paymentMethodType:i,stage:s.U.completed,subscriptionId:n.subscriptionId}),[3,4];case 3:return a=l.sent(),q(),r({stage:s.U.failed,error:f.K.fromUnknownError("useVerifyAttempt.verifyAttempt",a)}),[3,4];case 4:return[2]}})})()},[t,r])},z=function(e){var t=e.memberProcessorCustomerSessionClientSecret,r=e.mode===s.b.express;if(r&&!t)throw new f.K("useExpressMode.validation","Express mode requires customerSessionClientSecret to access saved payment methods");return{isExpressMode:r}},W=r(904812),H=function(){var e=(0,d.Jd)().verifyAttempt,t=(0,W.Ph)("invoice"),r=(0,W.Ph)("payment_intent"),n=(0,W.Ph)("payment_method_type");return(0,o.useEffect)(function(){(t||r)&&e({invoiceId:t||void 0,paymentIntentId:r||void 0,paymentMethodType:n||void 0})},[e,t,r,n]),null};function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function X(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Q=function(e){return e!==s.U.completed&&e!==s.U.failed&&e!==s.U.idle},$=function(e){var t=e.children,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["children"]),a=r.communityId,i=r.communityProcessorPaymentMethodConfigurationId,l=r.doesCommunityProcessorSupportsLink,u=r.doesMemberHasDefaultPaymentMethod,p=r.isMemberAddressComplete,f=r.isMemberAddressRequired,m=r.isPaymentMethodRequired,y=r.memberAddressCity,b=r.memberAddressCountry,v=r.memberAddressLine1,h=r.memberAddressLine2,_=r.memberAddressPostalCode,w=r.memberAddressState,g=r.memberEmail,x=r.memberName,j=r.memberProcessorCustomerSessionClientSecret,O=r.mode,P=r.onAddressChange,S=r.onComplete,k=r.onError,I=r.onPaymentMethodChange,C=r.onProgress,E=r.paywallPriceId,N=r.sessionId,A=r.sessionStepId,T=r.stripeElementsMode,M=Y((0,o.useState)(""),2),D=M[0],R=M[1],U=Y((0,o.useState)(!1),2),F=U[0],V=U[1],B=Y((0,o.useState)(!1),2),q=B[0],W=B[1],G=Y((0,o.useState)(!1),2),$=G[0],J=G[1],ee=Y((0,o.useState)(!1),2),et=ee[0],er=ee[1],en=Y((0,o.useState)({city:y,country:b,email:g,isComplete:p,line1:v,line2:h,name:x,postalCode:_,state:w}),2),eo=en[0],ea=en[1],ei=(0,o.useMemo)(function(){return f||(0,c.wO)(D)},[f,D]);(0,o.useEffect)(function(){null==P||P(X(K({},eo),{isComplete:!ei||eo.isComplete}))},[ei,eo,P]),(0,o.useEffect)(function(){null==I||I({isComplete:q,isDefaultPaymentMethod:F,paymentMethodType:D})},[F,q,I,D]);var el=(0,o.useRef)(s.U.idle),eu=Y((0,o.useState)(el.current),2),es=eu[0],ec=eu[1],ed=(0,o.useCallback)(function(e){var t=e.stage;if(el.current=t,ec(t),Q(t)){null==C||C(t);return}if(t===s.U.completed){var r=e.attemptId,n=e.attemptStatus,o=e.invoiceId,a=e.paymentIntentId,i=e.paymentMethodType,l=e.subscriptionId;null==S||S({attemptId:r,attemptStatus:n,invoiceId:o,paymentIntentId:a,paymentMethodType:i,subscriptionId:l});return}t===s.U.failed&&(null==k||k({error:e.error}))},[S,k,C]),ep=z({memberProcessorCustomerSessionClientSecret:j,mode:O}).isExpressMode,ef=L({canSubmitAttempt:(0,o.useCallback)(function(){return el.current===s.U.idle&&es===s.U.idle||el.current===s.U.failed&&es===s.U.failed},[es]),communityId:a,communityProcessorPaymentMethodConfigurationId:i,doesCommunityProcessorSupportsLink:l,doesMemberHasDefaultPaymentMethod:u,isExpressMode:ep,isMemberUsingDefaultPaymentMethod:F,isPaymentMethodRequired:m,memberAddress:eo,memberProcessorCustomerSessionClientSecret:j,onStageChange:ed,paymentMethodType:D,paywallPriceId:E,sessionId:N,sessionStepId:A,stripeElementsMode:T}),em=(0,o.useCallback)(function(){return el.current===s.U.idle&&es===s.U.idle||el.current===s.U.confirmingAttempt&&es===s.U.confirmingAttempt},[es]),ey=Z({canVerifyAttempt:em,onStageChange:ed}),eb=Q(es);return(0,n.jsxs)(d.sm.Provider,{value:X(K({},r),{canVerifyAttempt:em,isPaymentMethodLoaded:et,isAddressElementRequired:ei,isExpressMode:ep,isMemberUsingDefaultPaymentMethod:F,isPaymentElementReady:$,isPaymentMethodComplete:q,isProcessingAttempt:eb,memberAddress:eo,onStageChange:ed,paymentMethodType:D,setIsPaymentMethodLoaded:er,setIsMemberUsingDefaultPaymentMethod:V,setIsPaymentElementReady:J,setIsPaymentMethodComplete:W,setMemberAddress:ea,setPaymentMethodType:R,submitAttempt:ef,verifyAttempt:ey}),children:[t,(0,n.jsx)(H,{})]})},J=function(e){var t,r,c=e.children,d=e.mode,p=void 0===d?s.b.default:d,f=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["children","mode"]),m=f.communityProcessorId,y=f.communityProcessorKey,b=f.communityProcessorPaymentMethodConfigurationId,v=f.memberProcessorCustomerSessionClientSecret,h=f.orderAmount,_=f.orderCurrency,w=f.orderCurrencyMinimumChargeAmount,g=(0,o.useMemo)(function(){return(0,i.O)({stripeAccountId:m,stripePublicKey:y,locale:window.locale})},[m,y]),x=h<w?l.hX.setup:l.hX.payment,j=(0,o.useMemo)(function(){return{amount:h<w?0:h,appearance:u.RY,currency:_,customerSessionClientSecret:null!=v?v:void 0,mode:x,paymentMethodConfiguration:b}},[b,v,h,_,x,w]);return(0,n.jsx)(a.Elements,{stripe:g,options:j,children:(0,n.jsx)($,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},f),r=r={mode:p,stripeElementsMode:x,children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t))})}},659395:function(e,t,r){r.d(t,{E:()=>n});var n=function(e){var t=e.doesOfferHaveTrial,r=e.doesOrderHaveFullForeverDiscount,n=e.doesTrialRequirePaymentMethod,o=e.doesTrialRequireUpfrontPayment;return!r&&(!t||o||n)}},563506:function(e,t,r){r.d(t,{U:()=>o,b:()=>n});var n={default:"default",express:"express"},o={idle:"idle",settingUpPaymentMethod:"settingUpPaymentMethod",creatingAttempt:"creatingAttempt",confirmingAttempt:"confirmingAttempt",verifyingAttempt:"verifyingAttempt",completed:"completed",failed:"failed"}},678731:function(e,t,r){r.d(t,{K:()=>w});var n=r(100334),o=r(718215),a=r(33870);function i(e,t,r){return(i=m()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&d(o,r.prototype),o}).apply(null,arguments)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,s(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)})(e)}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}var y=function(e){return!!(e&&(void 0===e?"undefined":p(e))==="object"&&"type"in e&&"string"==typeof e.type)},b=function(e){return!!(e&&(void 0===e?"undefined":p(e))==="object"&&"error_details"in e&&e.error_details)},v=function(e){return!!(e&&(void 0===e?"undefined":p(e))==="object"&&"failure"in e&&"object"===p(e.failure)&&(0,a.kW)(e))},h="paywallError",_="unknownError",w=function(e){var t,r;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function a(e,t){var r,n,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{type:_},l=i.type,c=i.cause,d=i.context,f=i.shouldAllowToResubmit;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");return r=a,n=[t,{cause:c}],r=s(r),u(o=function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,m()?Reflect.construct(r,n||[],s(this).constructor):r.apply(this,n)),"caller",void 0),u(o,"type",void 0),u(o,"context",void 0),u(o,"shouldAllowToResubmit",void 0),o.caller=e,o.context=d,o.shouldAllowToResubmit=null==f||f,o.type=l,o}return a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),e&&d(a,e),t=[{key:"getExtra",value:function(){return this.isStripeError()?{checkout_error_type:this.type,stripe_error_type:this.context.type,stripe_error_code:this.context.code,stripe_error_decline_code:this.context.decline_code}:this.isNewPaywallError()?{checkout_error_type:this.type,paywall_failure_category:this.context.failure.category,paywall_failure_code:this.context.failure.code,paywall_failure_level:this.context.failure.level}:this.isLegacyPaywallError()?{checkout_error_type:this.type,legacy_paywall_error_details:this.context.error_details}:{checkout_error_type:this.type}}},{key:"isStripeError",value:function(){return y(this.context)}},{key:"isLegacyPaywallError",value:function(){return b(this.context)}},{key:"isNewPaywallError",value:function(){return v(this.context)}}],r=[{key:"generic",value:function(e){return new a(e,(0,n.t)("services.paywalls.failures.internal.generic"))}},{key:"stripeNotInitialized",value:function(e){return new a(e,(0,n.t)("services.paywalls.failures.stripe.not_initialized"))}},{key:"fromStripeError",value:function(e,t){var r=t.message;return r||(r=(0,n.t)("services.paywalls.failures.internal.generic")),new a(e,r,{context:t,type:"stripeError"})}},{key:"fromPaywallError",value:function(e,t){return v(t)?new a(e,t.failure.message,{context:t,type:h}):new a(e,t.message,{context:t,type:h})}},{key:"fromApiError",value:function(e,t){return b(t.body)||v(t.body)?a.fromPaywallError(e,t.body):new a(e,t.message,{cause:t,type:"apiError"})}},{key:"fromUnknownError",value:function(e,t){return c(t,o.M)?a.fromApiError(e,t):y(t)?a.fromStripeError(e,t):v(t)||b(t)?a.fromPaywallError(e,t):c(t,Error)?new a(e,t.message,{cause:t,type:_}):a.generic(e)}}],t&&l(a.prototype,t),r&&l(a,r),a}(f(Error))},590507:function(e,t,r){r.d(t,{_:()=>d});var n=r(683551),o=r(314121),a=r(100334),i=r(769487),l=r(391745);function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(c=function(){return!!e})()}var d=function(e){var t;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function r(e){var t,n,o;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return n=r,o=[e],n=u(n),(t=function(e,t){var r;if(t&&("object"==((r=t)&&"undefined"!=typeof Symbol&&r.constructor===Symbol?"symbol":typeof r)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,c()?Reflect.construct(n,o||[],u(this).constructor):n.apply(this,o))).state={hasError:!1},t}return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&s(r,e),t=[{key:"componentDidCatch",value:function(e,t){if("true"===window.DISABLE_JS_ERROR_BOUNDARIES)throw e;this.setState({hasError:!0});var r,n,o,a,i,u=this.props,s=u.checkoutProps,c=u.paywallId;(0,l.M)(e,{communityId:null==s||null==(r=s.currentCommunity)?void 0:r.id,communityMemberId:null==s||null==(n=s.currentCommunityMember)?void 0:n.id,communityMemberUserId:null==s||null==(o=s.currentUser)?void 0:o.id,extra:{error_info_component_stack:t.componentStack},paywallId:null!=(i=null==s||null==(a=s.paywall)?void 0:a.id)?i:c})}},{key:"render",value:function(){var e=this.props.children;return this.state.hasError?(0,n.jsx)(i.Z,{errorCode:500,title:(0,a.t)("paywall_checkout.error_boundary.title")}):e}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(r.prototype,t),r}(o.Component)},744453:function(e,t,r){r.d(t,{y:()=>m});var n=r(683551),o=r(904812),a=r(645391),i=function(e){var t=e.cover_image_url,r=e.cover_image,i=e.className,l=t||(0,o.C9)({filename:"cover_image",signed_id:r});return(0,n.jsx)("img",{loading:"lazy",alt:"",src:l,className:(0,a.A)("relative w-full object-cover",i),"data-testid":"paywall-cover-image"})},l=r(214813),u=r(395310),s=r(640792),c=r(241394);function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}var p=function(e){var t=e.className,r=(0,c.TC)().isDarkAppearance,o=(0,s.Y)().paywall,i=null==o?void 0:o.event;if(!i)return null;var p=i.cover_image_url,f=i.cover_image,m=i.cover_image_variants;if(!p||!f)return null;var y=r?(0,u.aP)("dark-mode-cover-thumbnail-2x.png"):(0,u.aP)("light-mode-cover-thumbnail-2x.png"),b=!(0,l.isEmpty)(m),v=d({src:b?m.original:p||y},b?{srcSet:"".concat(m.medium," 640w, ").concat(m.large," 768w, ").concat(m.original," 1024w")}:{});return(0,n.jsx)("img",d({loading:"lazy",alt:"",className:(0,a.A)("relative w-full rounded-t-lg object-cover",t)},v))},f=function(e){var t,r,o,a=e.paywall,l=e.coverImageClassName,u=e.eventImageClassName;return(null==a?void 0:a.event)?(0,n.jsx)(p,{className:u}):(null==a||null==(o=a.paywall_customization)?void 0:o.cover_image)?(0,n.jsx)(i,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},a.paywall_customization),r=r={className:l},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t)):null},m=Object.assign(f,{Offer:function(e){var t=e.paywall,r=e.coverImageClassName,o=e.eventImageClassName;return(0,n.jsx)(f,{paywall:t,coverImageClassName:(0,a.A)("max-h-[281px] rounded-t-xl md:rounded-xl",r),eventImageClassName:o})},Checkout:function(e){var t=e.paywall,r=e.coverImageClassName,o=e.eventImageClassName;return(0,n.jsx)(f,{paywall:t,coverImageClassName:(0,a.A)("max-h-[303px] rounded-t-xl",r),eventImageClassName:o})},Confirmation:function(e){var t=e.paywall,r=e.coverImageClassName,o=e.eventImageClassName;return(0,n.jsx)(f,{paywall:t,coverImageClassName:(0,a.A)("w-[71px] h-[41px] rounded-[0.416rem]",r),eventImageClassName:o})}})},343995:function(e,t,r){r.d(t,{Q:()=>p,M:()=>f});var n=r(683551),o=r(314121),a=r(709385);function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var u=function(e){return i({id:(0,a.D)()},e)},s=function(e){if(e){var t,r,n;return l(i({},e),{badge_properties:(t=e.badge_properties)?l(i({},t),{badges:(t.badges||[]).map(u)}):{enabled:!1,badges:[]},testimonial_properties:(r=e.testimonial_properties)?l(i({},r),{testimonials:(r.testimonials||[]).map(u)}):{enabled:!1,testimonials:[]},benefit_properties:(n=e.benefit_properties)?l(i({},n),{benefits:(n.benefits||[]).map(u)}):{enabled:!1,title:"",benefits:[]}})}},c=r(351838),d=(0,o.createContext)(null);d.displayName="PaywallCustomizationProvider";var p=function(){var e=(0,o.useContext)(d);return(0,c.Z)(e,"usePaywallCustomizationContext should be within the PaywallCustomizationContext"),e},f=function(e){var t=e.children,r=e.paywallCustomization,a=e.checkoutPreviewContext,i=s(r),l=(0,o.useMemo)(function(){return{paywallCustomization:i,checkoutPreviewContext:a}},[r,a]);return(0,n.jsx)(d.Provider,{value:l,children:t})}},646193:function(e,t,r){r.d(t,{p:()=>es});var n=r(683551),o=r(343995),a=r(189713),i=r(314121),l=r(903431),u=r(524090),s=r(645391),c=r(904812),d=r(241394),p=r(588893),f=function(e){var t,r,o=e.icon,a=e.dataTestId,f=o.emoji_type,m={},y=d.OR.LIGHT;if(f===p.BG.EMOJI){var b=o.emoji;m={className:(0,s.A)("!w-6 !p-0"),emptyIcon:i.Fragment,emoji:b}}if(f===p.BG.CUSTOM&&(m={className:(0,s.A)("!w-6 !p-0 !pr-1"),emptyIcon:i.Fragment,customEmojiUrl:(0,c.Gd)(o),customEmojiDarkUrl:(0,c.Gd)(o)}),f===p.BG.SHAPES){var v=o.identifier;m={className:(0,s.A)("!w-4 !p-0 !pr-1"),emptyIcon:i.Fragment,customEmojiUrl:(0,u.c)(v)||null,customEmojiDarkUrl:(0,u.c)(v)||null}}return(0,n.jsx)("span",{"data-testid":a,children:(0,n.jsx)(l.S,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},m),r=r={appearance:y},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t))})},m=function(e){var t=e.background_color,r=e.icon,o=e.label,i=e.text_color;return e.visible?(0,n.jsxs)("div",{className:"flex flex-row flex-wrap items-center gap-x-2 rounded-full px-3 py-1",style:{backgroundColor:t},"data-testid":"paywall-badge",children:[(0,n.jsx)(f,{icon:r,"data-testid":"paywall-badge-icon"}),(0,n.jsx)(a.Z.LabelXs,{weight:"medium",children:(0,n.jsx)("span",{style:{color:i},"data-testid":"paywall-badge-label",children:o})})]}):null},y=r(583972);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var v=function(){var e,t=(0,i.useRef)(null),r=(e=(0,i.useState)(0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=r[0],o=r[1];return(0,i.useEffect)(function(){var e=new ResizeObserver(function(e){var t=!0,r=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var u=i.value.contentRect.width;u>n&&o(u)}}catch(e){r=!0,a=e}finally{try{t||null==l.return||l.return()}finally{if(r)throw a}}});return t.current&&e.observe(t.current),function(){t.current&&e.unobserve(t.current)}},[n]),{contentRef:t,maxWidth:n}},h="text-green-700",_={main:{container:"bg-primary rounded-3xl border",icon:"",text:""},offer:{container:"bg-green-50 rounded-t-2xl border-t border-x w-full",icon:h,text:h}},w=function(e){var t=e.countdownProperties,r=e.useHook,i=e.variant,l=e.className,u=(0,o.Q)().checkoutPreviewContext,c=r({countdownProperties:t}).timeRemainingText,d=v(),p=d.contentRef,f=d.maxWidth,m=_[void 0===i?"main":i];return(0,n.jsxs)("div",{className:(0,s.A)("border-primary flex flex-row items-center justify-center gap-x-2 py-2.5",l,m.container),"data-testid":"countdown-container",children:[(0,n.jsx)(y.JO,{type:"16-clock",viewBox:"0 0 16 16",className:m.icon}),(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center gap-x-1",children:[(0,n.jsx)(a.Z.LabelSm,{weight:"medium",color:m.text,children:t.displayed_text}),(0,n.jsx)("div",{ref:p,style:{minWidth:!u&&f>0?"".concat(f,"px"):"auto"},children:(0,n.jsx)(a.Z.LabelSm,{weight:"semibold",color:m.text,children:c})})]})]})},g=r(698365),x=r(99929),j=r(325508),O=r(789928),P=r(555424),S=r(278836),k=r(933542),I=r(125091),C=r.n(I),E=function(e,t){var r=new Date(e),n=new Date;if(r<=n)return t&&t(Math.abs(Number(n)-Number(r))),"0s";var o=(0,x.j)(r,n),a=(0,j.A)(r,n)%24,i=(0,O.X)(r,n)%60,l=(0,P.c)(r,n)%60;return 0===o&&0===a?"".concat(i,"m : ").concat(l,"s"):o>0?"".concat(o,"d : ").concat(a,"h : ").concat(i,"m"):"".concat(a,"h : ").concat(i,"m")},N=function(e){var t;return(0,g.$Z)(e.countdown_type)?{finish_at:"minutes"===e.remaining_time_interval?(0,S.m)(new Date,e.remaining_time||1).toISOString():(0,k.v)(new Date,e.remaining_time||1).toISOString()}:{finish_at:null!=(t=e.finish_at)?t:""}},A=function(e){var t=C().get("checkout_countdown_".concat(e));if(!t)return null;try{return JSON.parse(t)}catch(e){return console.error("Can't parse the Countdown data"),null}};function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var D=function(e){var t=e.countdownProperties,r=(0,o.Q)().paywallCustomization,n=(0,i.useMemo)(function(){return A(null==r?void 0:r.paywall_id)||N(t)},[null==r?void 0:r.paywall_id,t]).finish_at,a=M((0,i.useState)(""),2),l=a[0],u=a[1],s=M((0,i.useState)(0),2),c=s[0],d=s[1];return(0,i.useEffect)(function(){var e=new URL(window.location.href);e.searchParams.delete(g.WI),window.history.replaceState({},"",e)},[]),(0,i.useEffect)(function(){if(!n)return void u("");var e=function(){u(E(n,d))};e();var t=setInterval(e,1e3);return function(){return clearInterval(t)}},[n]),{timeRemainingText:l,exceedTime:c}},L=function(e){var t=e.countdownProperties,r="";return(0,g.$Z)(t.countdown_type)&&(r=E((0,S.m)(new Date,Number(t.remaining_time)).toISOString())),(0,g.jS)(t.countdown_type)&&(r=E(t.finish_at||new Date().toISOString())),{timeRemainingText:r}},R=r(902893),U="!max-w-6 !p-0 !max-h-6",F=function(e){var t,r,o=e.icon,a=e.hide,f=o.emoji_type,m={},y=d.OR.LIGHT;if(f===p.BG.ICONS){var b=o.identifier;m={className:(0,s.A)(U),emptyIcon:i.Fragment,customEmojiUrl:(0,R.ir)(b,d.OR.LIGHT)||null,customEmojiDarkUrl:(0,R.ir)(b,d.OR.LIGHT)||null}}if(f===p.BG.EMOJI){var v=o.emoji;m={className:(0,s.A)("!p-0 text-[1.5rem] leading-8"),emptyIcon:i.Fragment,emoji:v}}if(f===p.BG.CUSTOM&&(m={className:(0,s.A)(U),emptyIcon:i.Fragment,customEmojiUrl:(0,c.Gd)(o),customEmojiDarkUrl:(0,c.Gd)(o)}),f===p.BG.SHAPES){var h=o.identifier;m={className:(0,s.A)("!p-0 !w-5 !h-5"),emptyIcon:i.Fragment,customEmojiUrl:(0,u.c)(h)||null,customEmojiDarkUrl:(0,u.c)(h)||null}}return(0,n.jsx)("div",{className:(0,s.A)("flex size-8 items-center justify-center",{invisible:a}),"data-testid":"benefit-icon",children:(0,n.jsx)(l.S,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},m),r=r={appearance:y},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t))})},V=function(e){var t=e.title,r=e.description,o=e.icon;return(0,n.jsxs)("div",{className:"grid grid-cols-8 gap-x-3 md:grid-cols-12","data-testid":"benefit-item",children:[(0,n.jsx)("div",{className:"col-span-1 max-h-[1.875rem] md:col-span-1",children:(0,n.jsx)(F,{icon:o})}),(0,n.jsx)("div",{className:"col-span-7 flex items-center md:col-span-11",children:(0,n.jsx)(a.Z.LabelSm,{weight:"semibold","data-testid":"benefit-title-item",children:t})}),(0,n.jsx)("div",{className:"col-span-1"}),(0,n.jsx)("div",{className:"col-span-7 flex items-center md:col-span-11","data-testid":"benefit-description-item",children:(0,n.jsx)(a.Z.BodySm,{children:r})})]})},B=function(e){var t=e.title;return(0,n.jsx)("div",{className:"py-2","data-testid":"benefits-title",children:(0,n.jsx)(a.Z.TitleSm,{weight:"semibold",children:t})})},q=function(){var e=(0,o.Q)().paywallCustomization,t=(null==e?void 0:e.benefit_properties)||{enabled:!1,benefits:[]},r=t.enabled,a=t.benefits,i=t.title;return r?(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)(B,{title:i}),(0,n.jsx)("div",{className:"flex flex-col gap-y-2","data-testid":"benefits-container",children:a.map(function(e){return(0,n.jsx)(V,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),e.id)})})]}):null},Z=r(727492),z=function(e){var t=e.children,r=e.dataTestId;return(0,n.jsx)("div",{className:"flex flex-row gap-x-1","data-testid":r,children:t})},W=function(e){var t=e.color;return(0,n.jsx)(z,{dataTestId:"testimonial-quotation-mark",children:(0,n.jsx)(y.JO,{type:"20-open-quote",useWithFillCurrentColor:!0,useWithStrokeCurrentColor:!0,style:{color:t},viewBox:"0 0 20 20"})})};function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}var G=function(e){return{type:"16-star-fill",useWithFillCurrentColor:!0,useWithStrokeCurrentColor:!0,style:{color:e},className:"!h-4 !w-4"}},K=function(e){var t=e.color;return(0,n.jsxs)(z,{dataTestId:"testimonial-stars",children:[(0,n.jsx)(y.JO,H({},G(t))),(0,n.jsx)(y.JO,H({},G(t))),(0,n.jsx)(y.JO,H({},G(t))),(0,n.jsx)(y.JO,H({},G(t))),(0,n.jsx)(y.JO,H({},G(t)))]})},X=r(844651),Y=r(100334),Q=function(e){var t=e.visible,r=e.quote,o=e.name,i=e.avatar_image,l=e.avatar_image_url,u=e.headline,s=e.children;if(!t)return null;var d=i?(0,c.C9)({filename:"avatar_image",signed_id:i}):l;return(0,n.jsxs)("div",{className:"flex flex-col gap-y-3.5","data-testid":"testimonial",children:[s,(0,n.jsx)(a.Z.BodySm,{"data-testid":"testimonial-quote",children:r}),(0,n.jsxs)("div",{className:"flex flex-row gap-x-3",children:[(0,n.jsx)(X.s,{name:o||(0,Y.t)("random"),src:d,size:"10",isFullRounded:!0}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-0.5",children:[o&&""!==o&&(0,n.jsx)(a.Z.LabelSm,{weight:"semibold","data-testid":"testimonial-name",children:o}),u&&""!==u&&(0,n.jsx)(a.Z.BodySm,{"data-testid":"testimonial-headline",children:u})]})]})]})},$=function(){var e=(0,o.Q)().paywallCustomization,t=(null==e?void 0:e.testimonial_properties)||{enabled:!1,testimonials:[]},r=t.enabled,a=t.testimonials;return r?(0,n.jsx)("div",{className:"flex flex-col gap-y-[2.125rem]","data-testid":"testimonials-container",children:a.map(function(e){var t,r;return(0,n.jsxs)(Q,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),r=r={children:[e.display_style.type===Z.y_.QUOTATION_MARK&&(0,n.jsx)(W,{color:e.display_style.color}),e.display_style.type===Z.y_.STARS&&(0,n.jsx)(K,{color:e.display_style.color})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t),e.id)})}):null},J=function(e){var t=e.shouldHide,r=e.className,a=(0,o.Q)(),i=a.paywallCustomization,l=a.checkoutPreviewContext,u=i||{},c=u.testimonial_properties,d=u.benefit_properties;return((null==c?void 0:c.enabled)||(null==d?void 0:d.enabled))&&!t?(0,n.jsxs)("div",{className:(0,s.A)("grid grid-cols-1 gap-y-9 divide-y *:pt-12",r,{"pb-16 md:pb-0":!!l}),children:[(0,n.jsx)(q,{}),(0,n.jsx)($,{})]}):null},ee=function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)},et=function(e,t,r){return .2126*ee(e)+.7152*ee(t)+.0722*ee(r)},er=function(e,t,r){return Math.round((1-t)*r+t*e)/255},en=function(e,t,r,n){var o=n/255;return et(er(e,o,255),er(t,o,255),er(r,o,255))},eo=function(e){if(!e)return"#FFFFFF";var t=e.startsWith("#")?e.slice(1):e,r=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16),a=parseInt(t.substring(6,8),16),i=0;return(i=isNaN(a)?et(r/255,n/255,o/255):en(r,n,o,a))>.5?"#000000":"#FFFFFF"},ea=r(333557),ei=function(e){var t=e.prices,r=e.priceId,n=e.tempId;return null==t?void 0:t.find(function(e){return[r,n].includes(e.price_id)})},el=function(e){var t=e.priceId,r=e.reducedPriceProperties;return ei({priceId:t,tempId:e.tempId,prices:null==r?void 0:r.prices})},eu=Object.assign(function(e){var t=e.children,r=e.price,n=e.couponPreviewMutation,a=(0,o.Q)().paywallCustomization,l=(0,ea._j)(Number(r.id),n),u=l.status!==ea.wH.NO_COUPON_APPLIED,s=el({priceId:Number(r.id),tempId:r.tmp_id,reducedPriceProperties:null==a?void 0:a.reduced_price_properties});return s&&s.enabled?(0,i.cloneElement)(t,{couponApplications:l,reducedPrice:u?void 0:s}):(0,i.cloneElement)(t,{couponApplications:l})},{Offer:function(e){var t=e.children,r=e.price,n=e.couponApplications,a=(0,o.Q)().paywallCustomization,l=!!n&&Number(null==n?void 0:n.application_count)>=1,u=el({priceId:Number(r.id),tempId:r.tmp_id,reducedPriceProperties:null==a?void 0:a.reduced_price_properties});return u&&u.enabled?(0,i.cloneElement)(t,{couponApplications:n,reducedPrice:l?void 0:u}):(0,i.cloneElement)(t,{couponApplications:n})}}),es=Object.assign(J,{Badges:function(){var e=(0,o.Q)().paywallCustomization,t=(null==e?void 0:e.badge_properties)||{enabled:!1,badges:[]},r=t.enabled,a=t.badges;return r?(0,n.jsx)("div",{className:"flex flex-row flex-wrap gap-2",children:a.map(function(e){return(0,n.jsx)(m,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),e.id)})}):null},Benefits:q,Countdown:function(e){var t=e.className,r=e.variant,a=void 0===r?"main":r,i=(0,o.Q)(),l=i.paywallCustomization,u=i.checkoutPreviewContext,s=((null==l?void 0:l.countdown_properties)||{enabled:!1}).enabled;if(!(null==l?void 0:l.countdown_properties)||!s)return null;var c=l.countdown_properties;return u?(0,n.jsx)(w,{className:t,countdownProperties:c,useHook:L,variant:a}):(0,n.jsx)(w,{className:t,countdownProperties:c,useHook:D,variant:a})},List:J,PriceCallout:function(e){var t,r=e.price,l=e.children,u=(0,o.Q)().paywallCustomization,c=null==u?void 0:u.price_callout_properties,d=(0,i.useMemo)(function(){return eo(null==c?void 0:c.callout_color)},[null==c?void 0:c.callout_color]),p=(0,n.jsx)(n.Fragment,{children:l});if(!u||!c||!(null==u||null==(t=u.price_callout_properties)?void 0:t.prices)||!(null==c?void 0:c.callout_color))return p;var f=u.price_callout_properties.prices.find(function(e){return(null==e?void 0:e.price_id)&&[r.id,r.tmp_id].includes(null==e?void 0:e.price_id)});if(!f||!f.callout_text)return p;var m=f.highlighted;return(0,n.jsxs)("div",{className:"flex flex-row flex-wrap items-center gap-x-1",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[l,(0,n.jsx)(a.Z.LabelXs,{color:"text-default",children:(0,Y.t)("separator_dot")})]}),(0,n.jsx)(a.Z.LabelXs,{color:"text-default",children:(0,n.jsx)("span",{className:(0,s.A)("inline-block whitespace-nowrap",{"rounded-sm px-1.5 py-0.5":m}),style:{color:m?d:c.callout_color,backgroundColor:m?c.callout_color:"transparent"},"data-testid":"paywall-price-callout",children:f.callout_text})})]})},Provider:o.M,ReducedPrice:eu,Testimonials:$})},266885:function(e,t,r){r.d(t,{_:()=>u,i:()=>l});var n=r(683551),o=r(314121),a=r(245062),i=(0,o.createContext)({Title:a.D});i.displayName="PriceProvider";var l=function(){return(0,o.useContext)(i)},u=function(e){var t=e.children,r=e.Title,o=void 0===r?a.D:r;return(0,n.jsx)(i.Provider,{value:{Title:o},children:t})}},245062:function(e,t,r){r.d(t,{D:()=>a});var n=r(683551),o=r(189713),a=function(e){var t=e.prefix,r=e.oldTitle,a=e.title,i=e.suffix;return(0,n.jsxs)("span",{className:"inline-block whitespace-nowrap",children:[t&&(0,n.jsx)("span",{className:"pr-1",children:(0,n.jsx)(o.Z.LabelSm,{weight:"normal",children:t})}),(0,n.jsxs)("span",{children:[r&&(0,n.jsx)(o.Z.LabelXs,{weight:"normal",children:(0,n.jsx)("span",{className:"text-tertiary pr-1 align-text-bottom line-through","data-testid":"old-price",children:r})}),(0,n.jsx)(o.Z.LabelMd,{weight:"semibold","data-testid":"current-price",children:a})]}),i&&(0,n.jsx)("span",{className:"pl-1",children:(0,n.jsx)(o.Z.LabelSm,{weight:"normal",children:i})})]})}},34233:function(e,t,r){r.d(t,{t:()=>C});var n=r(683551),o=r(583972),a=function(e){var t=e.children;return(0,n.jsxs)("div",{className:"inline-block",children:[(0,n.jsx)(o.JO,{type:"16-arrow-right",size:16}),t]})},i=r(507154),l=r(256826),u=function(e){var t=e.price;return(0,n.jsx)(i.f,{price:t,properties:l.YH})},s=r(100334),c=r(52932),d=r(107094),p=r(198700),f=r(266885),m=function(e){var t=e.paywall,r=e.price,n=e.couponApplication;return r.upfront_payment_amount&&n?{title:(0,d.I)(t.currency,Math.max(r.upfront_payment_amount-((null==n?void 0:n.discount_amount)||0),0),p.Q),oldTitle:(0,d.I)(t.currency,r.upfront_payment_amount,p.Q),suffix:(0,s.t)("intro_fee").toLowerCase()}:null},y=function(e){var t=e.paywall,r=e.price,n=e.reducedPrice;return!r.upfront_payment_amount||!n||(0,c.O)(n.upfront_amount)<=r.upfront_payment_amount?null:{title:(0,d.I)(t.currency,r.upfront_payment_amount,p.Q),oldTitle:(0,d.I)(t.currency,(0,c.O)(n.upfront_amount),p.Q),suffix:(0,s.t)("intro_fee").toLowerCase()}},b=function(e){var t=e.paywall,r=e.price;return r.upfront_payment_amount?{title:(0,d.I)(t.currency,r.upfront_payment_amount,p.Q),oldTitle:void 0,suffix:(0,s.t)("intro_fee").toLowerCase()}:null},v=function(e){var t=(0,f.i)().Title,r=m(e)||y(e)||b(e);return r?(0,n.jsx)(t,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},r)):null},h=r(189713),_=r(245062),w=r(963381);function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function x(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var j=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=Math.max(n,1),a=e,i=-1;return t?(a/=o,i=Math.max(Math.floor(a-((null==t?void 0:t.discount_amount)||0)),0)):r&&(0,c.O)(r.amount)>e?(a=(0,c.O)(r.amount)/o,i=e/o):a/=o,{totalPrice:a,totalPriceDiscounted:i}},O=function(e,t,r){var n,o;return r>=0?(n=(0,d.I)(t.currency,e,p.Q),o=(0,d.I)(t.currency,r,p.Q)):o=(0,d.I)(t.currency,e,p.Q),{title:o,oldTitle:n}},P=function(e){var t=e.price,r=e.paywall,n=e.couponApplication,o=e.reducedPrice,a=j(t.amount,n,o);return x(g({},O(a.totalPrice,r,a.totalPriceDiscounted)),{suffix:"/".concat((0,s.t)(["paywall_checkout.price_value.interval_suffix",t.interval_type]))})},S=function(e){var t=e.price,r=e.paywall,n=e.couponApplication,o=e.reducedPrice;if(!(0,w.t3)(t))return null;var a=j(Math.floor(t.amount-(t.upfront_payment_amount||0)),n,o,t.installments_count||1),i=a.totalPrice,l=a.totalPriceDiscounted;return x(g({prefix:"".concat(t.installments_count,"x")},O(i,r,l)),{suffix:"/".concat((0,s.t)(["paywall_checkout.price_value.interval_suffix",t.interval_type]))})},k=function(e){var t=e.price,r=e.paywall,n=e.couponApplication,o=e.reducedPrice;if(!(0,w.ZN)(t))return null;var a=j(t.amount,n,o);return g({},O(a.totalPrice,r,a.totalPriceDiscounted))},I=function(e){var t=(0,f.i)().Title;return(0,n.jsx)(t,g({},k(e)||S(e)||P(e)))},C=Object.assign(I,{Value:I,Badge:u,IntroFee:v,Arrow:a,Title:_.D,BadgeWithArrow:function(e){return(0,n.jsx)(a,{children:(0,n.jsx)(u,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e))})},IntroFeeWithArrow:function(e){return(0,n.jsx)(a,{children:(0,n.jsx)(v,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e))})},ValueWithArrow:function(e){return(0,n.jsx)(a,{children:(0,n.jsx)(I,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e))})},Subtitle:function(e){var t=e.prefix,r=e.subtitle;return(0,n.jsxs)("span",{className:"flex flex-row",children:[t&&(0,n.jsx)(h.Z.LabelXs,{color:"text-default",weight:"normal",children:(0,n.jsx)("span",{className:"pr-1 align-text-bottom line-through",children:t})}),(0,n.jsx)(h.Z.LabelXs,{color:"text-default",weight:"medium",children:(0,n.jsx)("span",{className:"inline-block whitespace-nowrap",children:r})})]})}})},433179:function(e,t,r){r.d(t,{n:()=>l});var n=r(683551),o=r(34233),a=r(645391),i={value:[o.t],trial_then_value:[o.t.Badge,o.t.ValueWithArrow],trial_then_upfront_then_value:[o.t.Badge,o.t.IntroFeeWithArrow,o.t.ValueWithArrow],upfront_then_value:[o.t.IntroFee,o.t.ValueWithArrow],upfront_then_trial_then_value:[o.t.IntroFee,o.t.BadgeWithArrow,o.t.ValueWithArrow]},l=function(e){var t=e.price,r=e.paywall,o=e.reducedPrice,l=e.couponApplications,u=e.className,s=i[t.scenario];return(0,n.jsx)("div",{className:(0,a.A)("leading-6",u),children:s.map(function(e,n){return e({price:t,paywall:r,reducedPrice:o,couponApplication:null==l?void 0:l.applications[n]})})},t.id)}},198700:function(e,t,r){r.d(t,{Q:()=>n});var n={includeCurrencyCode:!1}},758702:function(e,t,r){r.d(t,{i:()=>J});var n=r(683551),o=r(645391),a=function(e){var t=e.community;return(null==t?void 0:t.logo_url)?(0,n.jsx)("img",{loading:"lazy",className:"max-h-[2.5rem] lg:max-h-10",src:t.logo_url,alt:""}):(null==t?void 0:t.icon_url)?(0,n.jsxs)("div",{className:"flex max-h-[2.5rem] flex-row gap-x-1 lg:max-h-10",children:[(0,n.jsx)("div",{className:"box-border size-7 p-1 text-center",children:(0,n.jsx)("img",{loading:"lazy",src:t.icon_url,alt:""})}),(0,n.jsx)("span",{className:"text-lg font-medium",children:t.name})]}):(0,n.jsx)("span",{className:"max-h-[2.5rem] text-lg font-medium lg:max-h-10",children:null==t?void 0:t.name})},i=r(744453),l=r(314121),u=r(640792),s=r(994446),c=r(646193),d=r(214813),p=r(100334),f=r(333557),m=r(963381),y=r(583972),b=r(527804),v=function(e,t,r){var n=(0,d.compact)(["paywall_checkout.coupon.coupon_tag",e,r&&"forever"!=e?"plus":null]);return(0,p.t)(n,{count:t})},h=function(e,t){var r=Number(e.application_count),n=0;return(null==t?void 0:t.scenario)===m.Rt.value&&(n=2),(m.Rt.trialThenValue===(null==t?void 0:t.scenario)||m.Rt.upfrontThenValue===(null==t?void 0:t.scenario))&&(n=2),(m.Rt.trialThenUpfrontThenValue===(null==t?void 0:t.scenario)||m.Rt.upfrontThenTrialThenValue===(null==t?void 0:t.scenario))&&(n=3),Math.max(r-n,0)},_=function(e){var t,r,o,a=e.paywallPriceId,i=e.couponPreviewMutation,l=null==i||null==(t=i.data)?void 0:t.paywall_coupon,u=(0,f.k$)(Number(a),null==i||null==(o=i.data)||null==(r=o.paywall)?void 0:r.prices),s=(0,f._j)(Number(a),i);if(!l||f.wH.NO_COUPON_APPLIED===s.status)return null;if(f.wH.COUPON_NOT_AVAILABLE===s.status)return(0,n.jsx)("div",{children:(0,n.jsx)(b.T,{content:(0,p.t)("paywall_checkout.form.errors.coupon_code_not_available"),placement:"top",children:(0,n.jsx)(y.JO,{type:"20-no-tags"})})});var c=v(l.duration,h(s,u),s.has_more);return(0,n.jsx)("div",{children:(0,n.jsx)(b.T,{content:c,placement:"top",children:(0,n.jsx)(y.JO,{type:"20-tags"})})})},w=r(433179),g=r(52932),x=r(107094),j=r(34233),O=r(198700),P={subscription:function(e){return["settings.paywall_prices.subscription.title",e]},onetime:function(){return["settings.paywall_prices.onetime.type_qualifier"]},installments:function(){return[]}},S=function(e,t){var r=e.upfront_payment_amount||0,n=e.amount-r,o=(0,g.O)(t.upfront_amount),a=(0,g.O)(t.amount),i=0,l=0;return o>r?(i+=o-r,l+=o):l+=r,a>n?(i+=a-n,l+=a):l+=n,{priceOriginal:l,totalDiscount:i}},k=function(e,t,r,n){if((0,m.QT)(e)||(0,m.ZN)(e))return{subtitle:(0,p.t)(P[e.price_type](e.interval_type))};var o,a=e.amount,i=0,l=0;if((null==r?void 0:r.status)===f.wH.COUPON_APPLIED)l=(null==(o=r.applications)?void 0:o.reduce(function(e,t){return t.discount_amount+e},0))||0;else if(n){var u=S(e,n);a=u.priceOriginal,l=u.totalDiscount}return i=Math.max(0,a-l),{prefix:l>0?(0,x.I)(t.currency,a,O.Q):void 0,subtitle:(0,p.t)(["paywall_checkout.price_value.title",e.price_type,e.interval_type],{total_amount:(0,x.I)(t.currency,i,O.Q)})}},I=function(e){var t=e.price,r=e.paywall,o=e.reducedPrice,a=e.couponApplications;return(0,n.jsx)(j.t.Subtitle,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},k(t,r,a,o)))};function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}var E=function(e){var t=e.price,r=e.couponPreviewMutation;return(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,n.jsx)(c.p.ReducedPrice,{price:t,couponPreviewMutation:r,children:(0,n.jsx)(w.n,C({},e))}),(0,n.jsx)(c.p.PriceCallout,{price:t,children:(0,n.jsx)(c.p.ReducedPrice,{price:t,couponPreviewMutation:r,children:(0,n.jsx)(I,C({},e))})})]}),(0,n.jsx)(_,{paywallPriceId:t.id,couponPreviewMutation:r})]})},N=r(419104),A=function(e){var t=e.id,r=e.value,a=e.isSelected,i=e.label,l=e.dataTestId;return(0,n.jsx)("label",{className:(0,o.A)("mb-0 p-4 first:rounded-t-lg last:rounded-b-lg",{"bg-secondary":a}),htmlFor:t,"data-testid":l,"data-selected":a,children:(0,n.jsx)(N.Y,{id:t,value:r,labelWrapperClassName:"w-full",labelClassName:"flex flex-col gap-y-1 w-full",label:i,checked:a,name:"paywall_price_id"})})},T=r(186177),M=r(250822),D=r(512451),L=r(379720),R=function(e){var t=e.children,r=e.className;return(0,n.jsx)("div",{className:(0,o.A)("flex flex-col gap-3",r),"data-testid":"checkout-paywall-detail",children:t})},U=r(87355),F=r(180868),V=r(189713),B=function(e){var t=e.event,r=e.className;if(!(null==t?void 0:t.event_setting_attributes))return null;var a=t.event_setting_attributes,i=a.starts_at,l=a.ends_at,u=a.time_zone,s=a.time_zone_abbreviations,c=a.location_type,d=new Date(i),p=new Date(l),f=(0,F.lo)(d,p,u),m=[{icon:"16-calendar",text:"".concat(f," (").concat(s,")")},{icon:c===U.Bq.IN_PERSON||c===U.Bq.TBD?"16-location":"16-video",text:U.gP[c]}];return(0,n.jsx)("div",{className:(0,o.A)("flex flex-col gap-y-2",r),children:m.map(function(e){var t=e.icon,r=e.text;return(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(y.JO,{type:t,size:16,className:"text-default !w-4"}),(0,n.jsx)(V.Z.LabelXs,{children:r})]},t)})})},q=function(e){var t=e.title;return(0,n.jsx)(V.Z.LabelLg,{weight:"semibold",children:(0,n.jsx)("span",{className:"text-lg","data-testid":"paywall-title",children:t})})},Z=function(e){var t=e.description;return(0,n.jsx)(V.Z.BodySm,{color:"text-default",children:(0,n.jsx)("span",{className:"whitespace-pre-wrap","data-testid":"paywall-description",children:t})})};function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var W=function(e){var t,r=e.description,a=e.className,i=e.shouldShowMoreInitialState,u=e.maximumLength,s=(t=(0,l.useState)(void 0!==i&&i),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return z(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=s[0],d=s[1],f=function(){d(!c)};return(0,n.jsx)("div",{className:(0,o.A)(a),children:(0,n.jsx)(V.Z.BodySm,{color:"text-default",children:c?(0,n.jsxs)("span",{className:"flex flex-col gap-y-1 whitespace-pre-wrap","data-testid":"paywall-description",children:[r,(0,n.jsx)("button",{type:"button",className:"text-left underline",onClick:f,children:(0,p.t)("show_less")})]}):(0,n.jsxs)("span",{className:"whitespace-pre-wrap","data-testid":"paywall-description",children:["".concat(r.substring(0,void 0===u?160:u),"... "),(0,n.jsx)("button",{type:"button",className:"underline",onClick:f,children:(0,p.t)("show_more")})]})})})},H={desktop:160,tablet:250,mobile:120},G=function(e){var t=e.description,r=(0,M.HE)(),o=(0,M.j)()?"desktop":r?"tablet":"mobile";return t?t.length<=H[o]?(0,n.jsx)(Z,{description:t}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W,{description:t,className:"hidden lg:block",shouldShowMoreInitialState:!0,maximumLength:H.desktop}),(0,n.jsx)(W,{description:t,className:"block lg:hidden",maximumLength:H[o]})]}):null},K=r(308085),X=Object.assign(function(e){var t=e.useHooks,r=(void 0===t?u.Y:t)().paywall,o=(0,K.u)(r),a=(0,K.r)(r);return(0,n.jsxs)(R,{children:[(0,n.jsx)(q,{title:o}),(0,n.jsx)(B,{event:r.event}),(0,n.jsx)(G,{description:a}),(0,n.jsx)(c.p.Badges,{})]})},{Upsell:function(e){var t=e.useHooks,r=(void 0===t?u.Y:t)().paywall,o=(0,K.u)(r),a=(0,K.r)(r);return(0,n.jsxs)(R,{children:[(0,n.jsx)(q,{title:o}),(0,n.jsx)(B,{event:r.event}),(0,n.jsx)(G,{description:a})]})}}),Y=r(277010),Q=Object.assign(function(e){var t=e.className,r=e.dataTestId,a=(0,u.Y)(),i=a.authProviderProperties,l=a.paywall,s=a.currentCommunity,d=(0,M.a7)();return(0,n.jsxs)(T.s,{className:(0,o.A)("flex flex-row-reverse justify-center lg:justify-normal",t,{"pointer-events-none !hidden opacity-60 lg:!flex":null==i?void 0:i.is_sso_authentication_required}),dataTestId:void 0===r?"paywall-checkout-left-column":r,children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)(J.CommunityHeader,{community:s}),(0,n.jsx)(c.p.Countdown,{}),(0,n.jsxs)("div",{className:"bg-primary border-primary flex h-fit w-full flex-col rounded-lg border shadow-lg","data-testid":"paywall-checkout-info",children:[(0,n.jsx)(J.CoverImage.Checkout,{paywall:l}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 p-4 pb-5 md:p-7",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsx)(X,{}),(0,n.jsx)(J.PriceSelector,{})]}),(0,n.jsx)(D.d.CouponForm,{className:"pb-4"}),(0,n.jsx)(L.F,{variant:"with_modals"})]})]})]}),(0,n.jsx)(c.p.List,{shouldHide:!d,className:"px-4"})]})},{Skeleton:function(e){var t=e.className;return(0,n.jsx)(T.s,{className:(0,o.A)("flex flex-row-reverse justify-center lg:justify-normal",t),children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)(Y.X2,{square:!0,full:!0,x2l:!0,className:"!h-[2.5rem] lg:!h-10 my-[1.625rem] md:my-[2.625rem] !w-full lg:!w-1/2"}),(0,n.jsx)("div",{className:"bg-primary border-primary flex h-fit w-full flex-col rounded-xl border shadow-lg","data-testid":"paywall-checkout-info",children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 p-4 pb-5 md:p-7",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsx)(Y.X2,{full:!0,x2l:!0}),(0,n.jsx)(Y.X2,{full:!0,square:!0,className:"!h-[150px] !w-full"}),(0,n.jsx)(Y.X2,{full:!0,x2l:!0})]}),(0,n.jsx)(Y.X2,{full:!0,x2l:!0,className:"!h-[50px] !w-full"})]})})]})})}}),$=r(343995),J=Object.assign(Q,{Upsell:Object.assign(function(e){var t,r=e.useHooks,a=void 0===r?u.Y:r,i=e.variant,l=void 0===i?"Upsell":i,s=(0,$.Q)().paywallCustomization,d=a().paywall,p="Upsell"===l,f="Preview"===l,m=!!(null==s||null==(t=s.countdown_properties)?void 0:t.enabled),y=!!(null==s?void 0:s.cover_image);return(0,n.jsxs)("div",{className:(0,o.A)("w-full flex flex-col justify-center items-center",{"pt-20 pb-30":f}),children:[(0,n.jsx)(c.p.Countdown,{variant:"offer",className:(0,o.A)({"!max-w-[540px]":!y})}),(0,n.jsxs)("div",{className:(0,o.A)("bg-primary border-primary flex h-fit flex-col shadow-lg w-full p-0",{"max-w-[540px]":f,"md:flex-row md:gap-x-8 md:p-8":p,"md:max-w-[540px]":!y&&p,"md:max-w-[1000px]":y&&p,"rounded-lg border":!m,"rounded-b-lg border-b border-x":m}),"data-testid":"paywall-checkout-info",children:[y&&(0,n.jsx)("div",{className:(0,o.A)({"md:w-1/2 w-full":p,"w-full":f}),children:(0,n.jsx)(J.CoverImage.Offer,{paywall:d,coverImageClassName:(0,o.A)({"!rounded-none md:!rounded-xl":m,"md:!rounded-none":f})})}),(0,n.jsx)("div",{className:(0,o.A)("w-full flex flex-col gap-y-4 pb-5 px-4 pt-6",{"p-7":f,"md:p-0":p,"md:w-1/2":y&&p}),children:(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsx)(X.Upsell,{useHooks:a}),(0,n.jsx)(J.PriceSelector,{useHooks:a}),(0,n.jsx)(L.F,{variant:"with_modals"})]})})]})]})},{Skeleton:function(){return(0,n.jsxs)("div",{className:(0,o.A)("bg-primary border-primary flex h-fit flex-col md:flex-row md:gap-x-8 shadow-lg w-full justify-center p-0 md:p-8 md:max-w-[1000px] rounded-lg border"),children:[(0,n.jsx)(Y.X2,{square:!0,className:"md:!w-1/2 !w-full !h-[281px]","data-testid":"cover-image"}),(0,n.jsx)("div",{className:(0,o.A)("w-full flex flex-col gap-y-4 pb-5 px-4 pt-6 md:p-0 md:w-1/2"),children:(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsx)(Y.X2,{full:!0,x2l:!0}),(0,n.jsx)(Y.X2,{full:!0,square:!0,className:"!h-[100px] !w-full"}),(0,n.jsx)(Y.X2,{full:!0,x2l:!0})]})})]})}}),CoverImage:i.y,PriceSelector:function(e){var t=e.useHooks,r=(void 0===t?u.Y:t)(),o=r.paywall,a=r.setSelectedPrice,i=r.isSelectedPrice,c=r.couponPreviewMutation,d=(0,l.useCallback)(function(e){a(e)},[a]);return(0,n.jsx)(s.p,{divProps:{className:"border border-primary rounded-lg divide-y flex flex-col","data-testid":"upsell-price-selector"},onChange:function(e){return d(Number(e.target.id))},children:o.prices.map(function(e){return(0,n.jsx)(A,{id:e.id.toString(),value:e.value,isSelected:i(e),label:(0,n.jsx)(E,{paywall:o,price:e,couponPreviewMutation:c}),dataTestId:"checkout-paywall-price-option"},"paywall_price-".concat(e.id))})})},CommunityHeader:function(e){var t=e.className,r=e.community;return(0,n.jsx)("div",{className:(0,o.A)("flex flex-row justify-center py-[1.625rem] md:py-[2.625rem] lg:justify-start lg:py-10",t),children:(0,n.jsx)(a,{community:r})})}})},770092:function(e,t,r){r.d(t,{g:()=>i});var n=r(683551),o=r(379600),a=r.n(o),i=function(e){var t=e.className,r=e.children;return(0,n.jsx)("div",{className:a()("border-secondary-200 flex flex-col empty:hidden",t),children:r})}},928213:function(e,t,r){r.d(t,{$:()=>ek});var n,o,a,i,l=r(683551),u=r(100334),s=r(189713),c=r(314121),d=r(645391),p=r(770092),f="default",m="paywall_customization",y=r(214813),b=r(286402),v=function(e){var t;return(null==e||null==(t=e.trial_period)?void 0:t.free)?{hide:!0}:{}},h=function(e){return e.first_payment.discount<0||e.first_payment.tax>0||e.first_payment.ending_balance<0},_=r(963381),w=Object.assign({},{DefaultLine:function(e){var t=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:""},t))},EndingBalanceLine:function(e){var t=e.preview,r=e.options;return!h(t)||t.first_payment.ending_balance>=0?null:(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.first_payment.ending_balance"),tooltip:(0,u.t)("paywall_checkout.first_payment.ending_balance_tooltip"),value:t.first_payment.formatted_ending_balance,valueColor:"text-green-600",dataTestId:"checkout-form-preview-carry-over"},r))},FreeTrialLine:function(e){var t,r=e.preview,n=e.options;return[_.Rt.trialThenValue,_.Rt.trialThenUpfrontThenValue].includes(r.preview_scenario)?(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.free_trial_day",{count:null==r||null==(t=r.trial_period)?void 0:t.days}),value:r.formatted_amount_due_now,valueWeight:"semibold",dataTestId:"checkout-form-preview-today-payment-free-trial"},n)):null},PaidTrialLine:function(e){var t,r=e.preview,n=e.options;return h(r)||![_.Rt.upfrontThenTrialThenValue].includes(r.preview_scenario)?null:(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.first_payment.total_due_for_paid_trial",{count:null==r||null==(t=r.trial_period)?void 0:t.days}),value:r.formatted_amount_due_now,valueWeight:"semibold",dataTestId:"checkout-form-preview-today-payment-paid-trial"},n))},SubtotalLine:function(e){var t=e.preview,r=e.options;return!h(t)||t.first_payment.subtotal<0?null:(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.coupon.subtotal"),value:t.first_payment.formatted_subtotal,dataTestId:"checkout-form-preview-today-payment-subtotal"},r))},TaxLine:function(e){var t=e.preview,r=e.options;return h(t)&&0!==t.first_payment.tax?(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.coupon.tax"),value:t.first_payment.formatted_tax,dataTestId:"checkout-form-preview-today-tax"},r)):null},DiscountLine:function(e){var t=e.preview,r=e.options;return!h(t)||t.first_payment.discount>=0?null:(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.coupon.discount"),value:t.first_payment.formatted_discount,valueColor:"text-green-600",dataTestId:"checkout-form-preview-today-discount"},r))},TodayPaymentLine:function(e){var t=e.preview,r=e.options;return t.first_payment?(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:t.first_payment.due_on_phrase,value:t.first_payment.formatted_amount_due,labelWeight:"semibold",valueWeight:"semibold",dataTestId:"checkout-form-preview-today-payment-total"},r)):null},TotalDueTodayLine:function(e){var t=e.preview,r=e.options;return h(t)?(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.amount_due"),value:t.formatted_amount_due_now,dataTestId:"checkout-form-preview-total-due-today-line"},r)):null}}),g=r(443334),x="paywall_checkout.todays_payment",j=function(e){var t={label:(0,u.t)(x),value:e.formatted_amount_due_now,valueWeight:"semibold"},r={label:(0,u.t)(x),value:void 0};if([_.Rt.trialThenValue,_.Rt.trialThenUpfrontThenValue].includes(e.preview_scenario))return r;if([_.Rt.upfrontThenValue,_.Rt.upfrontThenTrialThenValue].includes(e.preview_scenario))return!h(e)&&(null==e||null==(a=e.trial_period)?void 0:a.paid)?r:t;if([_.Rt.value].includes(e.preview_scenario)){var n,o,a,i,l=1+ +!!e.future_payments+((null==e||null==(i=e.remaining_payments)?void 0:i.installments_preview.length)||0),s=(0,y.compact)([l>1?(0,u.t)("paywall_checkout.first_payment.header_installments"):(0,u.t)("paywall_checkout.todays_payment"),l>1?"(".concat((0,u.t)("progress_counter",{count:(0,g.hi)(1),total_count:l}),")"):null]).join(" ");return n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},t),o=o={label:s},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n}return t},O=Object.assign({},{TodayPaymentLine:function(e){var t=e.preview,r=j(t);return(0,l.jsx)(w.TodayPaymentLine,{preview:t,options:r})},TotalDueTodayLine:function(e){var t=e.preview,r=[_.Rt.upfrontThenTrialThenValue,_.Rt.upfrontThenValue].includes(t.preview_scenario)?{label:(0,u.t)("paywall_checkout.amount_due_intro_fee")}:[_.Rt.trialThenValue,_.Rt.trialThenUpfrontThenValue].includes(t.preview_scenario)?{hide:!0}:{};return(0,l.jsx)(w.TotalDueTodayLine,{preview:t,options:r})}}),P=[[O.TodayPaymentLine,y.noop],[w.FreeTrialLine,y.noop],[w.SubtotalLine,v],[w.DiscountLine,v],[w.TaxLine,v],[w.EndingBalanceLine,v],[w.PaidTrialLine,y.noop],[O.TotalDueTodayLine,y.noop]],S=[[w.TodayPaymentLine,function(){return{label:(0,u.t)("paywall_checkout.todays_payment")}}],[w.SubtotalLine,y.noop],[w.DiscountLine,y.noop],[w.TaxLine,y.noop],[w.EndingBalanceLine,y.noop],[w.TotalDueTodayLine,y.noop]],k=[[w.TodayPaymentLine,function(e){return[_.Rt.trialThenValue,_.Rt.trialThenUpfrontThenValue].includes(e.preview_scenario)?{label:(0,u.t)("paywall_checkout.todays_payment"),value:null}:{label:(0,u.t)("paywall_checkout.todays_payment")}}],[w.FreeTrialLine,y.noop],[w.SubtotalLine,v],[w.DiscountLine,v],[w.TaxLine,v],[w.EndingBalanceLine,v],[w.TotalDueTodayLine,v]];function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C=[[w.TodayPaymentLine,y.noop],[w.SubtotalLine,y.noop],[w.DiscountLine,y.noop],[w.TaxLine,y.noop],[w.EndingBalanceLine,y.noop]],E={default:(I(n={},b.E4.onetime,C),I(n,b.E4.subscription,C),I(n,b.E4.installments,C),n),paywall_customization:(I(o={},b.E4.onetime,S),I(o,b.E4.subscription,k),I(o,b.E4.installments,P),o)};function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var A=function(e){var t=e.className,r=e.preview,n=e.variant,o=(E[void 0===n?f:n]||E[f])[r.paywall_price.price_type];return(0,l.jsx)(p.g,{className:(0,d.A)("gap-y-2",t),children:(0,l.jsx)(c.Fragment,{children:o.map(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return N(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return(0,t[0])({preview:r,options:(0,t[1])(r)||{}})})},Math.random())})},T=Object.assign({},{DiscountLine:function(e){var t,r,n=e.preview,o=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.coupon.discount"),value:null==n||null==(t=n.future_payments)?void 0:t.formatted_discount,valueColor:"text-green-600",tooltip:null==n||null==(r=n.future_payments)?void 0:r.discount_phrase,dataTestId:"checkout-form-preview-future-payments-discount"},o))},HeaderLine:function(e){var t,r=e.preview,n=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.future_payments.header"),labelWeight:"semibold",value:null==r||null==(t=r.future_payments)?void 0:t.formatted_total,valueWeight:"semibold",dataTestId:"checkout-form-preview-future-payments-total"},n))},HeaderPaywallCustomizationLine:function(){return(0,l.jsx)(ek.PreviewEntry,{label:(0,u.t)("paywall_checkout.future_payments.header"),labelWeight:"semibold",dataTestId:"checkout-form-preview-future-payments-total"})},RegularPriceLine:function(e){var t,r=e.preview,n=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)(["settings.paywall_prices.subscription.regular_price",r.paywall_price.interval_type]),value:null==r||null==(t=r.future_payments)?void 0:t.formatted_subtotal,dataTestId:"checkout-form-preview-future-payments-regular-price"},n))},SubtotalLine:function(e){var t,r,n=e.preview,o=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:null==n||null==(t=n.future_payments)?void 0:t.start_on_phrase,value:null==n||null==(r=n.future_payments)?void 0:r.formatted_subtotal,dataTestId:"checkout-form-preview-future-payments-subtotal"},o))},TaxLine:function(e){var t,r=e.preview,n=e.options;return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("paywall_checkout.coupon.tax"),value:null==r||null==(t=r.future_payments)?void 0:t.formatted_tax,dataTestId:"checkout-form-preview-future-payments-tax"},n))}}),M=function(e){var t,r,n;return[_.Rt.upfrontThenTrialThenValue,_.Rt.trialThenUpfrontThenValue,_.Rt.upfrontThenValue].includes(e.preview_scenario)?1+((null==e||null==(n=e.remaining_payments)||null==(r=n.installments_preview)?void 0:r.length)||0):1+ +!!e.future_payments+((null==e||null==(t=e.remaining_payments)?void 0:t.installments_preview.length)||0)},D=function(e){return 1===M(e)},L=function(e){return e.future_payments&&(e.future_payments.discount<0||e.future_payments.tax>0)},R=Object.assign({},{DiscountLine:function(e){var t=e.preview,r=e.options;return!t.future_payments||t.future_payments.discount>=0?null:(0,l.jsx)(T.DiscountLine,{preview:t,options:r})},HeaderLine:function(e){var t=e.preview,r=e.options;return t.future_payments?(0,l.jsx)(T.HeaderLine,{preview:t,options:r}):null},HeaderPaywallCustomizationLine:function(){return(0,l.jsx)(T.HeaderPaywallCustomizationLine,{})},RegularPriceLine:function(e){var t=e.preview,r=e.options;return t.future_payments&&L(t)?(0,l.jsx)(T.RegularPriceLine,{preview:t,options:r}):null},SubtotalLine:function(e){var t=e.preview,r=e.options;return t.future_payments?(0,l.jsx)(T.SubtotalLine,{preview:t,options:r}):null},TaxLine:function(e){var t=e.preview,r=e.options;return!t.future_payments||t.future_payments.tax<=0?null:(0,l.jsx)(T.TaxLine,{preview:t,options:r})}});function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var F={total_amount_due:0,coupons_applied_quantity:0,installments_preview:[]},V=function(e){if((0,_.Mf)(e.preview_scenario)&&e.future_payments){var t,r=e.remaining_payments||F,n=e.future_payments;return{total_amount_due:(null==r?void 0:r.total_amount_due)+n.amount_due,coupons_applied_quantity:(null==r?void 0:r.coupons_applied_quantity)+ +(n.discount<0),installments_preview:[{amount_due:n.amount_due,start_on:n.start_on,coupon_status:n.discount<0?"applied":"not_applied"}].concat(function(e){if(Array.isArray(e))return U(e)}(t=r.installments_preview)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return U(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}return e.remaining_payments},B=function(e,t){return"applied"===t.coupon_status&&e.discounted?(e.discounted.totalAmountDue+=t.amount_due,e.discounted.singleInstallmentAmountDue=t.amount_due,e.discounted.quantity+=1):"not_applied"===t.coupon_status&&e.standard&&(e.standard.totalAmountDue+=t.amount_due,e.standard.singleInstallmentAmountDue=t.amount_due,e.standard.quantity+=1),e},q=function(e){var t,r;return{tooltip:void 0,hide:0===((null==(t=e.future_payments)?void 0:t.discount)||0),value:null==(r=e.future_payments)?void 0:r.formatted_discount}},Z={trial_then_value:function(e){var t;return{tooltip:void 0,hide:0===((null==(t=e.first_payment)?void 0:t.discount)||0),value:e.first_payment.formatted_discount}},trial_then_upfront_then_value:q,upfront_then_trial_then_value:q,upfront_then_value:q,value:function(){return{hide:!0}}},z=function(e){if(!e.paywall_coupon)return{hide:!0};if(1===M(e))return Z[e.preview_scenario](e);var t,r,n=V(e),o=((null==n?void 0:n.coupons_applied_quantity)||0)>0?(0,u.t)(["paywall_checkout.future_payments.discount_phrase_v2",null==e||null==(t=e.paywall_coupon)?void 0:t.duration],{count:null==n?void 0:n.coupons_applied_quantity}):void 0;return(0,_.Mf)(e.preview_scenario)?{hide:0===e.first_payment.discount,value:e.first_payment.formatted_discount,tooltip:o}:{hide:0===((null==(r=e.future_payments)?void 0:r.discount)||0),tooltip:o}},W=function(e){var t,r;return{label:(0,u.t)("paywall_checkout.future_payments.future_payment_after_x_trial_days",{count:null==e||null==(t=e.trial_period)?void 0:t.days}),value:L(e)?null==(r=e.future_payments)?void 0:r.formatted_amount_due:void 0,valueWeight:"semibold"}},H=function(e){var t;return{label:(0,u.t)("paywall_checkout.future_payments.header_installments.one_installment"),value:L(e)?null==(t=e.future_payments)?void 0:t.formatted_amount_due:void 0,valueWeight:"semibold"}},G={trial_then_value:function(e){var t,r;return t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},W(e)),r=r={value:h(e)?e.first_payment.formatted_amount_due:void 0},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t},trial_then_upfront_then_value:W,upfront_then_trial_then_value:H,upfront_then_value:H,value:function(){return{hide:!0}}},K=function(e){var t,r=M(e);return{label:(0,y.compact)([(0,u.t)(["paywall_checkout.future_payments.header_installments.first_payment",e.paywall_price.interval_type]),"(".concat((0,u.t)("progress_counter",{count:(0,g.hi)(1),total_count:r}),")")]).join(" "),value:L(e)?null==(t=e.future_payments)?void 0:t.formatted_amount_due:void 0}},X={trial_then_value:function(e){var t,r=M(e);return{label:(0,y.compact)([(0,u.t)(["paywall_checkout.future_payments.header_installments.first_payment",e.paywall_price.interval_type]),"(".concat((0,u.t)("progress_counter",{count:(0,g.hi)(1),total_count:r}),")")]).join(" "),value:h(e)?null==(t=e.first_payment)?void 0:t.formatted_amount_due:void 0}},trial_then_upfront_then_value:K,upfront_then_trial_then_value:function(e){var t,r=M(e),n=(0,y.compact)([(0,u.t)(["paywall_checkout.future_payments.header_installments.first_payment",e.paywall_price.interval_type]),"(".concat((0,u.t)("progress_counter",{count:(0,g.hi)(1),total_count:r}),")")]).join(" ");return L(e)?{label:n,value:null==(t=e.future_payments)?void 0:t.formatted_amount_due,valueWeight:"semibold"}:{label:n,value:void 0}},upfront_then_value:K,value:function(e){var t,r=M(e);return{label:[(0,u.t)(["paywall_checkout.future_payments.header_installments.next_payment",e.paywall_price.interval_type]),"(".concat((0,u.t)("progress_counter",{count:(0,g.hi)(2),total_count:r}),")")].join(" "),value:L(e)?null==(t=e.future_payments)?void 0:t.formatted_amount_due:void 0}}},Y=function(e){var t;return{value:null==e||null==(t=e.future_payments)?void 0:t.formatted_subtotal,hide:!L(e)}},Q={trial_then_value:function(e){return{value:e.first_payment.formatted_subtotal,hide:!h(e)}},trial_then_upfront_then_value:Y,upfront_then_trial_then_value:Y,upfront_then_value:Y,value:function(){return{hide:!0}}},$=function(e){var t,r;return{value:null==(t=e.future_payments)?void 0:t.formatted_amount_due,label:(0,u.t)("paywall_checkout.future_payments.one_time_payment_on",{date:null==(r=e.future_payments)?void 0:r.formatted_start_on}),valueWeight:L(e)?"normal":"semibold"}},J={trial_then_value:function(e){var t,r;return{valueWeight:h(e)?"normal":"semibold",value:null==(t=e.first_payment)?void 0:t.formatted_amount_due,label:(0,u.t)("paywall_checkout.future_payments.one_time_payment_on",{date:null==(r=e.first_payment)?void 0:r.formatted_due_on})}},trial_then_upfront_then_value:function(e){var t,r;return{valueWeight:L(e)?"normal":"semibold",value:null==(t=e.future_payments)?void 0:t.formatted_amount_due,label:(0,u.t)("paywall_checkout.future_payments.one_time_payment_on",{date:null==(r=e.future_payments)?void 0:r.formatted_start_on})}},upfront_then_trial_then_value:$,upfront_then_value:$,value:function(){return{hide:!0}}},ee=function(e){var t,r,n,o;return(0,_.Mf)(e.preview_scenario)?{value:null==(n=e.first_payment)?void 0:n.formatted_amount_due,valueWeight:h(e)?"normal":"semibold",label:(0,u.t)(["paywall_checkout.future_payments.next_payment_on_v2",e.paywall_price.interval_type],{date:null==e||null==(o=e.first_payment)?void 0:o.formatted_due_on})}:{value:null==(t=e.future_payments)?void 0:t.formatted_amount_due,valueWeight:L(e)?"normal":"semibold",label:(0,u.t)(["paywall_checkout.future_payments.next_payment_on_v2",e.paywall_price.interval_type],{date:null==(r=e.future_payments)?void 0:r.formatted_start_on})}},et=function(e){return(e||0)>0},er=function(e){var t,r;return{value:null==e||null==(t=e.future_payments)?void 0:t.formatted_tax,hide:!et(null==e||null==(r=e.future_payments)?void 0:r.tax)}},en={trial_then_value:function(e){var t;return{value:e.first_payment.formatted_tax,hide:!et(null==e||null==(t=e.first_payment)?void 0:t.tax)}},trial_then_upfront_then_value:er,upfront_then_trial_then_value:er,upfront_then_value:er,value:function(){return{hide:!0}}},eo=function(e){var t;return D(e)?en[e.preview_scenario](e):{hide:!et(null==e||null==(t=e.future_payments)?void 0:t.tax)}},ea=Object.assign({},{DiscountLine:function(e){var t=e.preview,r=z(t);return(0,l.jsx)(T.DiscountLine,{preview:t,options:r})},HeaderLine:function(e){var t=e.preview,r=1===M(t)?G[t.preview_scenario](t):X[t.preview_scenario](t);return(0,l.jsx)(T.HeaderLine,{preview:t,options:r})},RegularPriceLine:function(e){var t=e.preview,r=D(t)?Q[t.preview_scenario](t):{hide:!L(t)};return(0,l.jsx)(T.RegularPriceLine,{preview:t,options:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)("subtotal")},r)})},SubtotalLine:function(e){var t=e.preview,r=1===M(t)?J[t.preview_scenario](t):ee(t);return(0,l.jsx)(T.SubtotalLine,{preview:t,options:r})},TaxLine:function(e){var t=e.preview,r=eo(t);return(0,l.jsx)(T.TaxLine,{preview:t,options:r})}}),ei=[[ea.HeaderLine,y.noop],[ea.RegularPriceLine,y.noop],[ea.DiscountLine,y.noop],[ea.TaxLine,y.noop],[ea.SubtotalLine,y.noop]],el=r(107094),eu=function(e,t,r){var n=(0,y.compact)(["paywall_checkout.future_payments.discount_phrase_v2",e,r&&"forever"!=e?"plus":null]);return(0,u.t)(n,{count:t})},es=function(e){var t=Number(e.coupon_applications.application_count),r=0;return e.preview_scenario===_.Rt.value&&(r=2),[_.Rt.trialThenValue,_.Rt.upfrontThenValue].includes(e.preview_scenario)&&(r=2),[_.Rt.trialThenUpfrontThenValue,_.Rt.upfrontThenTrialThenValue].includes(e.preview_scenario)&&(r=3),Math.max(t-r,0)},ec=[[R.HeaderLine,function(e){var t,r;return(0,_.Mf)(e.preview_scenario)?{label:(0,u.t)("paywall_checkout.future_payments.future_payments_after_x_trial_days",{count:null==e||null==(r=e.trial_period)?void 0:r.days}),value:h(e)?e.first_payment.formatted_amount_due:null}:{value:L(e)?null==e||null==(t=e.future_payments)?void 0:t.formatted_amount_due:null}}],[T.RegularPriceLine,function(e){var t;return(0,_.Mf)(e.preview_scenario)?{hide:!h(e),value:e.first_payment.formatted_subtotal}:{hide:!L(e),value:null==(t=e.future_payments)?void 0:t.formatted_subtotal}}],[T.DiscountLine,function(e){var t,r,n=null==e||null==(t=e.paywall_coupon)?void 0:t.duration,o=es(e),a=e.coupon_applications.has_more;return(0,_.Mf)(e.preview_scenario)?{hide:0===e.first_payment.discount,value:e.first_payment.formatted_discount,tooltip:n&&o>0&&eu(n,o,a)}:{hide:0===((null==e||null==(r=e.future_payments)?void 0:r.discount)||0),tooltip:n&&o>0&&eu(n,o,a)}}],[T.TaxLine,function(e){var t,r;return(0,_.Mf)(e.preview_scenario)?{hide:0===e.first_payment.tax,value:e.first_payment.formatted_tax}:{hide:0===((null==e||null==(t=e.future_payments)?void 0:t.tax)||0),value:null==e||null==(r=e.future_payments)?void 0:r.formatted_tax}}],[T.SubtotalLine,function(e){var t;if((0,_.Mf)(e.preview_scenario)){var r,n,o,a,i,l,s=e.paywall_price,c="",d={};return(null==e||null==(r=e.paywall_coupon)?void 0:r.duration)==="forever"?(c=(null==e||null==(o=e.future_payments)?void 0:o.formatted_start_on)||"",d={value:(0,el.I)(e.currency,(null==(a=e.future_payments)?void 0:a.amount_due)||e.paywall_price.amount),valueWeight:"normal"}):(null==e||null==(n=e.paywall_coupon)?void 0:n.duration)==="once"?(c=(null==e||null==(i=e.future_payments)?void 0:i.formatted_start_on)||"",d={value:(0,el.I)(e.currency,e.paywall_price.amount),valueWeight:"normal"}):(c=e.first_payment.formatted_due_on,d={value:null==e||null==(l=e.first_payment)?void 0:l.formatted_amount_due,valueWeight:h(e)?"normal":"semibold"}),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:(0,u.t)(["paywall_checkout.future_payments.payments_starting_on_phrase",s.price_type,s.interval_type],{date:c})},d)}return{value:null==e||null==(t=e.future_payments)?void 0:t.formatted_amount_due,valueWeight:L(e)?"normal":"semibold"}}]];function ed(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ep=[[R.HeaderLine,y.noop],[R.SubtotalLine,y.noop],[R.DiscountLine,y.noop],[R.TaxLine,y.noop]],ef={default:(ed(a={},b.E4.subscription,ep),ed(a,b.E4.installments,ep),a),paywall_customization:(ed(i={},b.E4.subscription,ec),ed(i,b.E4.installments,ei),i)};function em(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ey=function(e){var t=e.preview,r=e.className,n=e.variant;if("onetime"===t.paywall_price.price_type)return null;var o=(ef[void 0===n?f:n]||ef[f])[t.paywall_price.price_type];return(0,l.jsx)(p.g,{className:(0,d.A)("gap-y-2 border-t",r),children:(0,l.jsx)(c.Fragment,{children:o.map(function(e){var r=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return em(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return em(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return(0,r[0])({preview:t,options:(0,r[1])(t)||{}})})},Math.random())})},eb=r(583972),ev=r(467213),eh={xs:s.Z.LabelXs,sm:s.Z.LabelSm,md:s.Z.LabelMd,default:s.Z.LabelMd},e_=function(e){var t=e.className,r=e.label,n=e.labelSize,o=e.labelWeight,a=e.labelColor,i=e.labelClassName,u=e.tooltip,c=e.value,p=e.valueSize,f=void 0===p?"sm":p,m=e.valueColor,y=e.valueWeight,b=e.hide,v=e.dataTestId;if(void 0!==b&&b)return null;var h=eh[void 0===n?"sm":n]||eh.default,_="sm"===f?s.Z.LabelSm:"md"===f?s.Z.LabelMd:s.Z.LabelLg;return(0,l.jsxs)("div",{className:(0,d.A)(t,"flex flex-row items-center justify-between space-x-2 whitespace-nowrap md:space-x-3"),"data-testid":v,children:[(0,l.jsxs)("div",{className:"flex flex-row gap-x-2 whitespace-normal",children:[(0,l.jsx)(h,{weight:void 0===o?"normal":o,color:a,children:(0,l.jsx)("span",{className:void 0===i?"":i,children:r})}),u&&(0,l.jsx)(ev.Y,{dataTestId:"checkout-form-preview-entry-tooltip",className:"inline-flex",content:u,children:(0,l.jsx)(eb.JO,{type:"16-question-mark",size:16,color:"text-primary"})})]}),c&&(0,l.jsx)(_,{weight:void 0===y?"normal":y,color:void 0===m?"text-primary":m,children:c})]})},ew=function(e){var t,r=null==(t=e.remaining_payments)?void 0:t.installments_preview.reduce(B,{discounted:{quantity:0,singleInstallmentAmountDue:0,totalAmountDue:0}});if(!(null==r?void 0:r.discounted)||(null==r?void 0:r.discounted.quantity)===0)return{hide:!0};var n=(0,el.I)(e.currency,(null==r?void 0:r.discounted.singleInstallmentAmountDue)||0);return{label:(0,u.t)(["paywall_checkout.future_payments.discounted_installments",e.paywall_price.interval_type],{count:null==r?void 0:r.discounted.quantity}),value:"".concat(null==r?void 0:r.discounted.quantity,"x ").concat(n)}},eg=function(e){var t,r=null==(t=e.remaining_payments)?void 0:t.installments_preview.reduce(B,{standard:{quantity:0,singleInstallmentAmountDue:0,totalAmountDue:0}});if(!(null==r?void 0:r.standard)||(null==r?void 0:r.standard.quantity)===0||(null==r?void 0:r.standard.totalAmountDue)===0)return{hide:!0};var n=(0,el.I)(e.currency,(null==r?void 0:r.standard.singleInstallmentAmountDue)||0);return{label:(0,u.t)(["paywall_checkout.future_payments.standard_installments",e.paywall_price.interval_type],{count:null==r?void 0:r.standard.quantity}),value:"".concat(null==r?void 0:r.standard.quantity,"x ").concat(n)}},ex=function(e){var t,r;return{label:(0,u.t)(["paywall_checkout.future_payments.remaining_payments",e.paywall_price.interval_type],{count:null==(t=e.remaining_payments)?void 0:t.installments_preview.length}),labelWeight:"semibold",valueWeight:"semibold",value:(0,el.I)(e.currency,(null==e||null==(r=e.remaining_payments)?void 0:r.total_amount_due)||0)}},ej=Object.assign({},{TitleLine:function(e){var t=ex(e.preview);return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:""},t))},StandardInstallmentsLine:function(e){var t=eg(e.preview);return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:""},t))},DiscountedInstallmentsLine:function(e){var t=ew(e.preview);return(0,l.jsx)(ek.PreviewEntry,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({label:""},t))}}),eO=r(507154),eP=r(256826),eS=function(e){var t=e.preview,r=e.variant;return(0,l.jsx)(p.g,{className:"gap-y-3 border-t py-8",children:(0,l.jsx)(ek.PreviewEntry,{label:(0,l.jsxs)(l.Fragment,{children:[(0,u.t)("paywall_checkout.amount_due"),(void 0===r?f:r)===f&&(0,l.jsx)(eO.f,{preview:t,properties:eP.z8})]}),labelClassName:"flex flex-row gap-x-2 items-baseline",labelSize:"md",labelWeight:"semibold",value:t.formatted_amount_due_now,valueSize:"md",valueWeight:"semibold",dataTestId:"checkout-form-preview-total-due-today"})})},ek=Object.assign(function(e){var t=e.preview;return(0,l.jsxs)("div",{className:"flex flex-col gap-y-6 md:pt-6",children:[(0,l.jsx)("div",{className:"mb-4 flex flex-row items-center",children:(0,l.jsx)(s.Z.LabelLg,{weight:"semibold",children:(0,u.t)("paywall_checkout.order_summary")})}),(0,l.jsx)(A,{className:"pb-4",preview:t}),(0,l.jsx)(ey,{className:"py-4",preview:t}),(0,l.jsx)(eS,{preview:t})]})},{ModalPreviewTemplate:function(e){var t=e.preview;return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)(ek.FirstPaymentPreview,{preview:t,className:"pb-4",variant:m}),(0,l.jsx)(ek.PaymentAfterTrialPreview,{preview:t,className:"py-4",variant:m}),(0,l.jsx)(ek.FuturePaymentsPreview,{preview:t,className:"py-4",variant:m}),(0,l.jsx)(ek.RemainingPaymentsPreview,{preview:t,className:"py-4",variant:m}),(0,l.jsx)(ek.PaymentSchedulePreview,{preview:t,className:"py-4",variant:m}),(0,l.jsx)(ek.TotalDueTodayPreview,{preview:t})]})},FirstPaymentPreview:A,FuturePaymentsPreview:ey,TotalDueTodayPreview:eS,ProratedCreditPreview:function(e){var t=e.preview,r=e.className,n=t.first_payment,o=n.prorated_credit_description,a=n.prorated_credit_amount,i=n.formatted_prorated_credit_amount;return o&&0!==a?(0,l.jsxs)(p.g,{className:(0,d.A)("gap-y-1 border-t",r),children:[(0,l.jsx)(ek.PreviewEntry,{label:(0,u.t)("paywall_checkout.prorated_credit"),labelWeight:"semibold",value:i,valueColor:a<0?"text-green-600":"text-primary",dataTestId:"checkout-form-preview-prorated-credit"}),(0,l.jsx)(s.Z.LabelXs,{children:o})]}):null},PaymentAfterTrialPreview:function(e){var t=e.preview,r=e.className;if(e.variant===f||![_.Rt.trialThenUpfrontThenValue].includes(t.preview_scenario)||!t.trial_period)return null;var n=t.first_payment.discount<0,o=t.first_payment.tax>0,a=o||n;return(0,l.jsxs)(p.g,{className:(0,d.A)("gap-y-2 border-t",r),children:[(0,l.jsx)(e_,{label:(0,u.t)("paywall_checkout.payment_after_trial.intro_fee_after_x_trial_days",{count:t.trial_period.days}),labelWeight:"semibold",value:a?t.first_payment.formatted_amount_due:void 0,valueWeight:a?"semibold":"normal"}),a&&(0,l.jsx)(e_,{label:(0,u.t)("subtotal"),value:t.first_payment.formatted_subtotal}),n&&(0,l.jsx)(e_,{label:(0,u.t)("paywall_checkout.coupon.discount"),valueColor:"text-green-600",value:t.first_payment.formatted_discount}),o&&(0,l.jsx)(e_,{label:(0,u.t)("paywall_checkout.coupon.tax"),value:t.first_payment.formatted_tax}),(0,l.jsx)(e_,{label:(0,u.t)("paywall_checkout.payment_after_trial.onetime_payment_due_on",{date:t.first_payment.formatted_due_on}),value:t.first_payment.formatted_amount_due,valueWeight:a?"normal":"semibold"})]})},RemainingPaymentsPreview:function(e){var t,r,n=e.preview,o=e.className;if(e.variant===f||"installments"!==n.paywall_price.price_type)return null;var a=(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},n),r=r={remaining_payments:V(n)},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t);return(null==a?void 0:a.remaining_payments)?(0,l.jsxs)(p.g,{className:(0,d.A)("gap-y-2 border-t",o),children:[(0,l.jsx)(ej.TitleLine,{preview:a}),(0,l.jsx)(ej.DiscountedInstallmentsLine,{preview:a}),(0,l.jsx)(ej.StandardInstallmentsLine,{preview:a})]}):null},PaymentSchedulePreview:function(e){var t,r,n=e.className,o=e.preview;return e.variant!==f&&(null==o||null==(t=o.future_payments)?void 0:t.payment_schedule_line)?(0,l.jsx)(p.g,{className:(0,d.A)("gap-y-2 border-t",n),children:(0,l.jsx)(ek.PreviewEntry,{label:(0,u.t)("paywall_checkout.payment_schedule",{payment_sentence:null==(r=o.future_payments)?void 0:r.payment_schedule_line}),labelSize:"xs",labelWeight:"medium",labelColor:"text-default",dataTestId:"checkout-form-payment-schedule"})}):null},PreviewEntry:e_})},680950:function(e,t,r){r.d(t,{o:()=>f});var n=r(683551),o=r(100334),a=r(507154),i=r(256826),l=r(595348),u=r(189713),s=function(){var e=(0,l.k)().previewMutation.data;return(0,n.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[(0,n.jsx)(u.Z.LabelMd,{weight:"semibold",children:(0,o.t)("paywall_checkout.amount_due")}),e&&(0,n.jsx)(a.f,{preview:e,properties:i.BD})]})},c=r(107094),d=r(277010),p=function(){var e,t,r=(0,l.k)().previewMutation,o=r.data;if(!o||r.isLoading)return(0,n.jsx)("div",{className:"flex flex-row items-center gap-x-1.5",children:(0,n.jsx)(d.gi,{variant:"row",lg:!0})});var a=!(null==o||null==(e=o.trial_period)?void 0:e.free)&&(null==(t=o.first_payment)?void 0:t.discount)<0;return(0,n.jsxs)("div",{className:"flex flex-row gap-x-1.5",children:[a&&(0,n.jsx)(u.Z.LabelMd,{weight:"semibold",color:"text-disabled",children:(0,n.jsx)("span",{className:"line-through",children:(0,c.I)(o.currency,o.first_payment.price_amount,{includeCurrencyCode:!1})})}),(0,n.jsx)(u.Z.LabelMd,{weight:"semibold",children:(0,c.I)(o.currency,o.amount_due_now)})]})},f=Object.assign(function(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s,{}),(0,n.jsx)(p,{})]})},{Value:p})},247110:function(e,t,r){r.d(t,{S:()=>b});var n=r(683551),o=r(100334),a=r(595348),i=r(645391),l=r(870879),u=r(189713),s=r(757977),c=r(250822),d=r(75040),p=r(318867),f=r(745481),m=r(928213),y=s.gk.create(function(e){var t=e.preview,r=(0,s.dd)(),a=function(){r.hide()};return(0,c.kK)()?(0,n.jsxs)(p.x,{isOpen:r.visible,onClose:a,shouldShowCloseButton:!0,className:"!h-auto !max-h-[80%] rounded-t-xl",children:[(0,n.jsx)(p.x.Header,{className:"border-none !py-4",children:(0,n.jsxs)("div",{className:"flex w-full flex-row items-center justify-between",children:[(0,n.jsx)(u.Z.TitleMd,{weight:"font-bold",children:(0,o.t)("paywall_checkout.order_summary")}),(0,n.jsx)(f.o,{onClick:a})]})}),(0,n.jsx)(p.x.Body,{className:"px-5",children:(0,n.jsx)(m.$.ModalPreviewTemplate,{preview:t})})]}):(0,n.jsx)(d.W,{title:(0,o.t)("paywall_checkout.order_summary"),titleClassName:"!text-left !px-0",isOpen:r.visible,onClose:a,children:(0,n.jsx)(m.$.ModalPreviewTemplate,{preview:t})})}),b=function(e){var t=e.className,r=(0,a.k)().previewMutation,c=(0,s.dd)(y);return(0,n.jsx)(l.z,{variant:"link",small:!0,className:(0,i.A)("!p-0 text-left",t),type:"button",onClick:function(){(null==r?void 0:r.data)&&c.show({preview:null==r?void 0:r.data})},disabled:r.isLoading,children:(0,n.jsx)(u.Z.LabelXs,{color:(0,i.A)("underline",{"text-secondary":!r.isLoading,"text-lightest":r.isLoading}),children:(0,n.jsx)("span",{className:"cursor-pointer",children:(0,o.t)("view_order_details")})})})}},985086:function(e,t,r){r.d(t,{U:()=>c});var n=r(683551),o=r(507154),a=r(256826),i=r(680950),l=r(247110),u=r(595348),s=r(277010),c=Object.assign(function(){var e=(0,u.k)().previewMutation.data;return(0,n.jsxs)("div",{className:"bg-primary fixed z-10 flex w-full flex-row justify-between border-b px-5 py-4 md:hidden",children:[(0,n.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[(0,n.jsx)(l.S,{}),e&&(0,n.jsx)(o.f,{properties:a.BD,preview:e})]}),(0,n.jsx)(i.o.Value,{})]})},{Skeleton:function(){return(0,n.jsxs)("div",{className:"bg-primary fixed z-10 flex w-full flex-row justify-between border-b px-5 py-4 md:hidden",children:[(0,n.jsx)("div",{className:"flex flex-row items-center gap-x-2",children:(0,n.jsx)(s.X2,{})}),(0,n.jsx)(s.X2,{xl:!0})]})}})},595348:function(e,t,r){r.d(t,{k:()=>u,m:()=>s});var n=r(683551),o=r(314121),a=r(640792),i=r(351838),l=(0,o.createContext)(null);l.displayName="PricePreviewProvider";var u=function(){var e=(0,o.useContext)(l);return(0,i.Z)(e,"usePricePreviewContext must be used within a PricePreviewContext.Provider"),e.useHooks()},s=function(e){var t=e.children,r=e.useHooks,o=void 0===r?a.Y:r;return(0,n.jsx)(l.Provider,{value:{useHooks:o},children:t})}},379720:function(e,t,r){r.d(t,{F:()=>j});var n=r(683551),o=r(705206),a=r(357382),i=r(928213),l=r(100334),u=r(595348),s=r(107094),c=r(645391),d=r(277010),p=r(189713),f=function(e){var t,r=e.className,o=(0,u.k)().previewMutation,a=o.data;if(!a||o.isLoading)return(0,n.jsx)(d.gi,{variant:"row",lg:!0,className:r});if(a.first_payment.discount>=0||(null==(t=a.trial_period)?void 0:t.free))return null;var i=(0,s.I)(a.currency,-1*a.first_payment.discount);return(0,n.jsx)("div",{className:(0,c.A)("text-right first:w-full first:text-right",r),children:(0,n.jsx)(p.Z.LabelXs,{weight:"medium",color:"text-green-success",children:(0,l.t)("total_savings_today",{formatted_discount:i})})})},m=r(378751),y=r(963381);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var v=function(e){if(e){var t=/(\d\d\d\d)-(\d\d)-(\d\d)/.exec(e);if(t){var r=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(t,4)||function(e,t){if(e){if("string"==typeof e)return b(e,4);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}}(t,4)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[1],o=r[2],a=r[3],i=new Date(Number(n),Number(o)-1,Number(a));return(0,m.w)({dateTime:i,format:m.f.short_month_and_date_with_year})}}},h=function(e){var t=e.className,r=(0,u.k)().previewMutation,o=r.data;if(!o||r.isLoading)return(0,n.jsx)(d.gi,{variant:"row",lg:!0,className:t});var a=[];if((((null==o||null==(s=o.first_payment)?void 0:s.tax)||0)>0||((null==o||null==(f=o.future_payments)?void 0:f.tax)||0)>0)&&a.push((0,l.t)("tax_included")),(0,y.Mf)(o.preview_scenario)||(0,y.$v)(o.preview_scenario)){var i=v(o.first_payment.due_on);i&&a.push((0,l.t)("next_payment",{next_payment_date:i}))}else{var s,f,m,b=v(null==(m=o.future_payments)?void 0:m.start_on);o.future_payments&&b&&a.push((0,l.t)("next_payment",{next_payment_date:b}))}var h=a.join(" ");return""===h?null:(0,n.jsx)("div",{className:(0,c.A)("size-full",t),children:(0,n.jsx)(p.Z.BodyXs,{color:"text-default",children:h})})},_=r(680950),w=r(247110),g=function(){return(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-0.5",children:[(0,n.jsx)("div",{className:"flex flex-row justify-between",children:(0,n.jsx)(_.o,{})}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)(w.S,{}),(0,n.jsx)(f,{})]})]}),(0,n.jsx)(h,{})]})},x=Object.assign(g,{CheckoutPagePreview:g,MobileFixedOnTopPreview:r(985086).U}),j=function(e){var t=e.variant,r=void 0===t?"classical":t,l=(0,u.k)(),s=l.previewMutation,c=l.hasAlreadyPurchased,d=l.paywall,p=s.data;return"with_modals"===r?(0,n.jsx)(x,{}):"mobile_fixed_on_top"===r?(0,n.jsx)(x.MobileFixedOnTopPreview,{}):s.isLoading?(0,n.jsx)(a.a,{variant:"default"}):(0,o.y9)(c,d)||s.isIdle||s.isError||!p?null:(0,n.jsx)(i.$,{preview:p})}},512451:function(e,t,r){r.d(t,{d:()=>rF});var n=r(683551),o=r(314121),a=r(100334),i=r(640792),l=r(705206),u=r(645391),s=r(904812),c=r(244289),d=r(583972),p=r(107094),f=r(527804),m=r(870879),y=r(189713),b=r(333557),v=function(e,t){return(0,a.t)(["paywall_checkout.coupon_badge",e.duration],{amount:"PaywallCoupons::Percent"===e.type?"".concat(Number(null==e?void 0:e.amount),"%"):(0,p.I)(t,Number(null==e?void 0:e.amount),{amountInCents:!1,includeCurrencyCode:!1}),count:null==e?void 0:e.duration_in_months})},h=function(){var e,t,r,o,l=(0,c.Gc)().watch,u=(0,i.Y)(),s=u.couponPreviewMutation,p=u.clearCouponCode,h=u.getSelectedPrice,_=l("coupon_code"),w=null==s||null==(e=s.data)?void 0:e.paywall_coupon,g=null==s||null==(r=s.data)||null==(t=r.paywall)?void 0:t.currency,x=null==(o=h())?void 0:o.id,j=(0,b._j)(x,s);return s.isLoading?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-secondary flex w-fit max-w-full flex-row items-center justify-between gap-x-1 rounded-md px-3 py-2.5 sm:w-fit md:gap-x-3 md:px-4","data-testid":"checkout-form-coupon-code",children:[(0,n.jsx)(d.JO,{type:"16-tags-topics",size:16,className:"text-default shrink-0"}),(0,n.jsxs)("div",{className:"flex max-w-[80%] shrink flex-row items-center gap-x-2",children:[(0,n.jsx)(y.Z.BodySm,{weight:"medium",color:"text-dark",children:_}),w&&g&&(0,n.jsx)(f.T,{content:v(w,g),placement:"top",className:"text-default truncate text-xs font-normal normal-case leading-4 tracking-normal",children:v(w,g)})]}),(0,n.jsxs)(m.z,{small:!0,className:"text-default !p-0",type:"button",variant:"plain",onClick:function(){p({resetPreview:!0})},"data-testid":"checkout-form-remove-coupon",children:[(0,n.jsx)("span",{className:"sr-only",children:(0,a.t)("paywall_checkout.form.buttons.remove_coupon")}),(0,n.jsx)(d.JO,{type:"24-close",size:24,className:"text-default"})]})]}),j.status!==b.wH.COUPON_APPLIED&&(0,n.jsx)(y.Z.LabelXs,{weight:"normal",color:"text-feedback-error",children:(0,a.t)("paywall_checkout.form.errors.paywall_coupon_does_not_apply_to_price")})]})},_=r(357382),w=r(379600),g=r.n(w),x=(0,o.forwardRef)(function(e,t){var r,o,a=e.className,i=e.error,l=e.name,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["className","error","name"]);return(0,n.jsx)("input",(r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({className:(0,u.A)(a,"placeholder:text-light h-11 grow rounded-md border border-solid border-gray-200 bg-white px-4 py-3 shadow-none outline-0 ring-0 placeholder:opacity-100 focus:border focus:border-gray-500 focus:shadow-none focus:outline-0 focus:ring-0",{"border-red-600 focus:border-red-600":void 0!==i&&i}),"data-testid":l?"checkout-form-".concat(l,"-input"):void 0,name:l},s),o=o={ref:t},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),r))});function j(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}x.displayName="CheckoutFormInput";var O=function(e){var t,r,o=e.autoFocus,i=e.className,l=e.name,u=e.placeholder,s=e.options,d=e.type,p=e.children,f=e.disabled,m=e.wrapperClassName,b=e.checkoutFormClassName,v=e.onBlur,h=e.onKeyDown,_=(0,c.Gc)(),w=_.register,O=_.formState.errors,P=(0,c.U2)(O,l),S=w(l,void 0===s?{}:s);return(0,n.jsxs)("div",{className:g()(i,"flex flex-col gap-y-1"),children:[(0,n.jsxs)("div",{className:g()("flex flex-row gap-x-2.5",m),children:[(0,n.jsx)(x,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({autoFocus:void 0!==o&&o,type:d,error:!!P,placeholder:u},S),r=r={onBlur:function(e){var t;return(t=function(){return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,S.onBlur(e)];case 1:return t.sent(),v&&v(e),[2]}})},function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function i(e){j(a,n,o,i,l,"next",e)}function l(e){j(a,n,o,i,l,"throw",e)}i(void 0)})})()},disabled:f,className:b,onKeyDown:h},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t)),p]}),P&&"password"!==l&&(0,n.jsx)(y.Z.LabelXs,{weight:"normal",color:"text-feedback-error",children:(0,a.t)("paywall_checkout.form.errors.".concat(l,"_").concat(String(P.type)))})]})},P=function(e){var t=e.applyCoupon,r=(0,c.Gc)(),l=r.watch,u=r.setError,s=(0,i.Y)().couponPreviewMutation,d=l("coupon_code");(0,o.useEffect)(function(){var e,t,r,n,o,a,i=null==s||null==(e=s.error)?void 0:e.body;(null==i||null==(r=i.failure)||null==(t=r.code)?void 0:t.match(/coupon_/))&&u("coupon_code",{type:null==i||null==(o=i.failure)||null==(n=o.code)?void 0:n.replace("coupon_",""),message:null==i||null==(a=i.failure)?void 0:a.message})},[s.error]);var p=function(e){return!["",void 0,null].includes(null==e?void 0:e.trim())};return(0,n.jsx)(O,{type:"text",name:"coupon_code",disabled:s.isLoading,checkoutFormClassName:"grow w-[150px] md:w-auto",wrapperClassName:"w-full",onKeyDown:function(e){"Enter"===e.key&&p(d)&&(e.preventDefault(),t())},placeholder:(0,a.t)("coupon_code"),children:d&&(0,n.jsx)(m.z,{large:!0,type:"button",className:"grow md:grow-0",variant:"secondary",disabled:s.isLoading,onClick:function(){p(d)&&t()},"data-testid":"checkout-form-apply-coupon",children:s.isLoading?(0,n.jsx)(_.a,{}):(0,n.jsx)(y.Z.LabelSm,{weight:"medium",children:(0,a.t)("paywall_checkout.form.buttons.apply_coupon")})})})};function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var k=function(){var e,t,r=(0,c.Gc)(),n=r.getValues,a=r.setValue,l=(0,i.Y)(),u=l.areCouponsEnabled,d=l.applyCouponCode,p=l.checkoutPreviewContext,f=l.couponPreviewMutation,m=l.previewMutation,y=l.paywall,b=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return S(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=b[0],h=b[1],_=(0,o.useCallback)(function(){var e=n().coupon_code,t={paywall_id:y.id,coupon_code:e,scenario:"apply_coupon"};f.mutate(t,{onSuccess:function(e){d({data:e})}})},[n,d,f,y.id]);return(0,o.useEffect)(function(){var e,t=(0,s.Ph)("coupon_code")||(null==p||null==(e=p.coupon_applied)?void 0:e.code);t&&!v&&m.isSuccess&&(h(!0),a("coupon_code",t),_())},[v,null==p||null==(t=p.coupon_applied)?void 0:t.code,a,_,m.isSuccess]),{areCouponsEnabled:u,couponPreviewMutation:f,applyCoupon:_}},I=r(379720),C=r(250822),E=r(763536),N=r(280658),A=r(987437),T=r(678731),M=r(391745),D=r(672842),L=r(36630),R=r(599631),U=r(365644),F=r(714844),V=r(600651),B=r(5735),q=r(83793),Z=r(955970);function z(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function W(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){z(a,n,o,i,l,"next",e)}function l(e){z(a,n,o,i,l,"throw",e)}i(void 0)})}}function H(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var G=function(){var e=(0,i.Y)(),t=e.currentCommunity,r=e.stripePaymentMethodType,n=e.currentUser,o=e.memberBillingInfo,a=(0,Z.i)().session,u=(0,q.D)(),s=function(e,t){return(null==o?void 0:o[e])||t.billing_info_attributes[e]||""};return{onSubmitMutation:(0,F.useMutation)(function(e){return W(function(){return H(this,function(o){switch(o.label){case 0:return e.payment_method_type=r,[4,W(function(){var r,o,i,c,d,p,f,m,y,b,v,h,_,w;return H(this,function(g){switch(g.label){case 0:r=u("useBuyNowPayLater.prepare").stripe,o=e.name,i=e.email,c=e.payment_method_type,d=e.paywall_price_id,p=e.coupon_code,f=e.community_member_billing_info_attributes,m=e.password,g.label=1;case 1:return g.trys.push([1,3,,4]),b={name:o,email:i,payment_method_type:c,paywall_price_id:d,community_id:t.id,coupon_code:p,community_member_billing_info_attributes:f,password:m},[4,V.k.prepare(b)];case 2:return y=g.sent(),[3,4];case 3:throw v=g.sent(),T.K.fromUnknownError("useBuyNowPayLater.prepare",v);case 4:h={payment_intent_client_secret:y.payment_intent_client_secret,billing_info_attributes:f,email:i||(null==n?void 0:n.email),name:o||(0,B.q)(n)},g.label=5;case 5:if(g.trys.push([5,12,,13]),!(0,l.dm)(e.payment_method_type))return[3,7];return[4,r.confirmKlarnaPayment(h.payment_intent_client_secret,{payment_method:{billing_details:{email:h.email,address:{country:s("address_country",h)}}},return_url:(0,D.xB)({paymentMethodType:l.Lt.KLARNA,sessionId:null==a?void 0:a.id})})];case 6:case 8:return _=g.sent(),[3,11];case 7:if(!(0,l.AL)(e.payment_method_type))return[3,9];return[4,r.confirmAfterpayClearpayPayment(h.payment_intent_client_secret,{payment_method:{billing_details:{email:h.email,name:h.name,address:{country:s("address_country",h),line1:s("address_line1",h),city:s("address_city",h),postal_code:s("address_postal_code",h)}}},shipping:{name:h.name,address:{country:s("address_country",h),line1:s("address_line1",h),city:s("address_city",h),postal_code:s("address_postal_code",h)}},return_url:(0,D.xB)({paymentMethodType:l.Lt.AFTERPAY_CLEARPAY,sessionId:null==a?void 0:a.id})})];case 9:if(!(0,l.Br)(e.payment_method_type))return[3,11];return[4,r.confirmAffirmPayment(h.payment_intent_client_secret,{payment_method:{billing_details:{email:h.email,name:h.name,address:{country:s("address_country",h),line1:s("address_line1",h),city:s("address_city",h),state:s("address_state",h),postal_code:s("address_postal_code",h)}}},shipping:{name:h.name,address:{country:s("address_country",h),line1:s("address_line1",h),city:s("address_city",h),state:s("address_state",h),postal_code:s("address_postal_code",h)}},return_url:(0,D.xB)({paymentMethodType:l.Lt.AFFIRM,sessionId:null==a?void 0:a.id})})];case 10:_=g.sent(),g.label=11;case 11:return[3,13];case 12:throw w=g.sent(),T.K.fromUnknownError("useBuyNowPayLater.prepare.confirmPayment",w);case 13:if(!_)throw T.K.generic("useBuyNowPayLater.prepare.confirmPayment");if(_.error)throw T.K.fromStripeError("useBuyNowPayLater.prepare.confirmPayment",_.error);return[2,y]}})})()];case 1:return o.sent(),[2]}})})()})}},K=r(564514),X=r(61146),Y=r(214813),Q=function(){var e,t,r,n,o,a,l=(0,i.Y)().memberBillingInfo,u=(0,c.Gc)().getValues("name")||"";return{paymentMethodDataParams:(0,Y.isEmpty)(l)?{payment_method_data:{billing_details:{name:u}}}:{payment_method_data:{billing_details:{address:(t=(e=l||{}).address_line1,r=e.address_line2,n=e.address_city,o=e.address_state,a=e.address_postal_code,{line1:t,line2:r,city:n,state:o,country:e.address_country,postal_code:a}),name:u}}}}};function $(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function J(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){$(a,n,o,i,l,"next",e)}function l(e){$(a,n,o,i,l,"throw",e)}i(void 0)})}}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function et(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function er(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var en=function(){var e=(0,q.D)(),t=(0,K.k6)(),r=(0,i.Y)(),n=r.checkoutConfirmationUrl,o=r.currentCommunity,a=r.getSelectedPrice,l=r.isCardInfoRequired,u=r.isMemberUsingSavedPaymentMethod,s=r.stripeElementsMode,c=r.stripePaymentMethodType,d=r.isPaywallsCheckoutWithoutInternalResourcesEnabled,p=(0,Z.i)().session,f=Q().paymentMethodDataParams,m=s===R.hX.setup,y=function(e,t){return J(function(){return er(this,function(r){switch(r.label){case 0:return[4,(0,X.m5)(n,e,t)];case 1:return[2,r.sent()]}})})()},b=function(t){return J(function(){var r,n;return er(this,function(o){switch(o.label){case 0:return[4,e(t).stripeElements.submit()];case 1:if(n=null==(r=o.sent())?void 0:r.error)throw T.K.fromStripeError(t,n);return[2,!0]}})})()},v=a(),h=function(e){var r=e.paymentIntentId,n=e.invoiceId,o=(0,D.$v)({paymentMethodType:c,paymentIntentId:r,invoiceId:n,sessionId:null==p?void 0:p.id});t.replace(o)};return{onSubmitMutation:(0,F.useMutation)(function(t){return J(function(){var r,n,a,i,s,_,w,g,x;return er(this,function(j){switch(j.label){case 0:if(r=t,a=(n=e("onSubmitMutation")).stripeElements,i=n.stripe,!l)return[3,8];return[4,b("useCard.onSubmitMutation.isCardInfoRequired")];case 1:if(j.sent(),!m)return[3,8];return[4,V.k.prepare_DEPRECATED(o.id,v.id)];case 2:if(!(!(s=j.sent())||!s.ok))return[3,4];return[4,null==s||null==(_=s.json)?void 0:_.call(s)];case 3:throw w=j.sent(),T.K.fromPaywallError("useCard.onSubmitMutation.prepare_DEPRECATED",w);case 4:return[4,s.json()];case 5:return g=j.sent().setup_intent.client_secret,[4,i.retrieveSetupIntent(g)];case 6:if((x=j.sent()).error)throw T.K.fromStripeError("useCard.onSubmitMutation.retrieveSetupIntent",x.error);if("succeeded"===x.setupIntent.status)return[3,8];return[4,i.confirmSetup({elements:a,clientSecret:g,confirmParams:ee({return_url:window.location.href},f),redirect:"if_required"})];case 7:if((x=j.sent()).error)throw T.K.fromStripeError("useCard.onSubmitMutation.confirmSetup",x.error);r.payment_method_processor_id=x.setupIntent.payment_method,j.label=8;case 8:var O;return[4,(O=r,J(function(){var t,r,n;return er(this,function(o){switch(o.label){case 0:return[4,V.k.create_DEPRECATED({formData:et(ee({},O),{payment_method_type:c,community_member_adding_payment_method:!u})})];case 1:if(!(!(t=o.sent())||!t.ok))return[3,3];return[4,null==t||null==(r=t.json)?void 0:r.call(t)];case 2:throw n=o.sent(),T.K.fromPaywallError("useCard.execCheckoutRequest.create_DEPRECATED",n);case 3:return[4,t.json()];case 4:var a;return[4,(a=o.sent(),J(function(){var t,r,n,o,i,l,u,s,v;return er(this,function(_){switch(_.label){case 0:if(r=(t=e("useCard.processPaymentInStripe")).stripe,n=t.stripeElements,o=a.payment_intent_processor_id,i=a.payment_intent_client_secret,l=a.invoice_processor_id,!(!o||!i))return[3,4];if(!d)return[3,1];return h({invoiceId:l}),[3,3];case 1:return[4,y(a,0)];case 2:_.sent(),_.label=3;case 3:return[2];case 4:return[4,r.retrievePaymentIntent(i)];case 5:if((u=_.sent()).error)throw T.K.fromStripeError("useCard.processPaymentInStripe.retrievePaymentIntent",u.error);if((null==(s=null==u?void 0:u.paymentIntent)?void 0:s.status)!=="succeeded")return[3,9];if(!d)return[3,6];return h({paymentIntentId:o}),[3,8];case 6:return[4,y(a,0)];case 7:_.sent(),_.label=8;case 8:return[2];case 9:if(!m)return[3,11];return[4,b("useCard.processPaymentInStripe.isSettingUpPaymentMethod")];case 10:_.sent(),_.label=11;case 11:return[4,r.confirmPayment({elements:n,clientSecret:i,confirmParams:et(ee({},f),{return_url:(0,D.xB)({paymentMethodType:c,paymentIntentId:o,invoiceId:l,sessionId:null==p?void 0:p.id})}),redirect:"if_required"})];case 12:if((v=_.sent()).error)throw T.K.fromStripeError("useCard.processPaymentInStripe.confirmPayment",v.error);return h({paymentIntentId:o,invoiceId:l}),[2]}})})())];case 5:return o.sent(),[2]}})})())];case 9:return j.sent(),[2]}})})()})}},eo=function(e){return(null==e?void 0:e.status)==="requires_action"};function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ei(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function el(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){ei(a,n,o,i,l,"next",e)}function l(e){ei(a,n,o,i,l,"throw",e)}i(void 0)})}}function eu(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var es=function(e){throw Error(null==e?void 0:e.message,{cause:e.body})},ec=function(){var e,t=(0,E.useStripe)(),r=(0,i.Y)().checkoutConfirmationUrl,n=(0,F.useMutation)(function(e){if(!t)throw Error("Stripe has not been initialized.");return t.confirmPixPayment(e.payment_intent_client_secret,{payment_method:{}})}),a=(e=(0,o.useState)({}),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return ea(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ea(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],u=a[1],s=(0,F.useMutation)(function(e){return V.k.prepare(e)}),c=(0,F.useMutation)(function(e){return V.k.create({formData:e})}),d=(0,F.useMutation)(function(e){return V.k.attempts.show(e)});return{onSubmitMutation:(0,F.useMutation)(function(e){return el(function(){var o,a;return eu(this,function(i){var p,f;switch(i.label){case 0:return[4,el(function(){var r,o,a,i,c,d,p,f;return eu(this,function(m){switch(m.label){case 0:if(!(o=JSON.stringify(l)===JSON.stringify(e)))return[3,4];if(!t)return[3,2];return[4,t.retrievePaymentIntent((null==s||null==(r=s.data)?void 0:r.payment_intent_client_secret)||"")];case 1:return c=m.sent(),[3,3];case 2:c=null,m.label=3;case 3:return i=c,[3,5];case 4:i=null,m.label=5;case 5:if(a=i,p=o&&eo(null==a?void 0:a.paymentIntent)&&(null==s?void 0:s.data))return[3,7];return[4,s.mutateAsync(e,{onSuccess:function(){u(e)},onError:es})];case 6:p=m.sent(),m.label=7;case 7:if(!(d=p))return[3,9];return[4,n.mutateAsync(d)];case 8:if(eo(f=m.sent().paymentIntent))throw Error("Pix modal is closed",{cause:D.zS});if((null==f?void 0:f.status)!=="succeeded")throw s.reset(),u({}),Error("Pix payment expired",{cause:D.C});m.label=9;case 9:return[2,d]}})})()];case 1:if(!(o=i.sent()))return[3,4];return[4,(0,X.Tm)({executor:function(){var e;return e=o,el(function(){var t,r;return eu(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,d.mutateAsync(e.payment_intent_id)];case 1:if("completed"===(t=n.sent()).status)return[2,t];return[2,null];case 2:if(404===(r=n.sent()).status)return[2,null];throw r;case 3:return[2]}})})()}})];case 2:if(!((a=i.sent())&&"completed"===a.status))return[3,4];return[4,c.mutateAsync((p=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),f=f={payment_intent_id:o.payment_intent_id},Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(f)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(f)).forEach(function(e){Object.defineProperty(p,e,Object.getOwnPropertyDescriptor(f,e))}),p))];case 3:return i.sent(),[2,(0,X.yy)({payment_intent_processor_id:o.payment_intent_id},r)];case 4:throw Error("Pix payment failed",{cause:D.PC})}})})()}),mutations:{prepareMutation:s,checkoutMutation:c,confirmPixPaymentMutation:n}}},ed=r(346752),ep=r(246249);function ef(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function em(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){ef(a,n,o,i,l,"next",e)}function l(e){ef(a,n,o,i,l,"throw",e)}i(void 0)})}}function ey(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function eb(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var ev=function(e){var t;return ey(e,Error)&&"cause"in e&&"object"==((t=e.cause)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)&&null!==e.cause&&"error_details"in e.cause&&e.cause.error_details===D.zS.error_details},eh=function(){var e=(0,i.Y)(),t=e.setIsProcessingPayment,r=e.stripePaymentMethodType,n=e.clearAlerts,o=e.currentUser,a=e.previewMutation,u=e.isPaywallsCheckoutWithoutInternalResourcesEnabled,s=e.paywall,d=(0,Z.i)().session,p=(0,ed.V)().handleCheckoutError,f=en(),m=ec(),y=G(),b=(0,U.$)({shouldUseDebounce:!1}).validateEmail,v=(0,c.Gc)(),h=v.setError,_=v.clearErrors,w=v.setFocus,g={pix:m,card:f,link:f,klarna:y,afterpay_clearpay:y,affirm:y,google_pay:f,apple_pay:f,sepa_debit:f,ideal:f,bancontact:f};return{onSubmit:function(e){return em(function(){var i,c,m,y,v,x;return eb(this,function(j){switch(j.label){case 0:if(e.coupon_code=(null==a||null==(c=a.variables)||null==(i=c.queryParams)?void 0:i.coupon_code)||"",e.checkout_session_step_id=null==(m=(0,ep.o9)(s.id,d))?void 0:m.id,n(),(0,D.IF)()&&(e.referral_metadata=(0,D.IF)()),u)y=f.onSubmitMutation;else{if(!g[v=(0,l.F_)(e.payment_method_type)?r:e.payment_method_type])throw Error("Invalid payment method type ".concat(v));y=g[v].onSubmitMutation}j.label=1;case 1:var O;return j.trys.push([1,4,5,6]),t(!0),[4,(O=e.email,em(function(){return eb(this,function(e){switch(e.label){case 0:if(!(!o&&O))return[3,2];return _("email"),[4,b(O)];case 1:if(!0!==e.sent())return h("email",{type:"manual"}),w("email"),[2,!1];e.label=2;case 2:return[2,!0]}})})())];case 2:if(!j.sent())return[2];return[4,y.mutateAsync(e)];case 3:return j.sent(),[3,6];case 4:return ev(x=j.sent())||(ey(x,T.K)?p(x):p(T.K.fromUnknownError("useOnSubmit",x))),[3,6];case 5:return t(!1),[7];case 6:return[2]}})})()}}};function e_(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var ew=function(){var e=(0,c.Gc)().getValues,t=eh().onSubmit;return(0,o.useCallback)(function(){var r;return(r=function(){return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,t(e())];case 1:return r.sent(),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var a=r.apply(e,t);function i(e){e_(a,n,o,i,l,"next",e)}function l(e){e_(a,n,o,i,l,"throw",e)}i(void 0)})})()},[e,t])};function eg(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function ex(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){eg(a,n,o,i,l,"next",e)}function l(e){eg(a,n,o,i,l,"throw",e)}i(void 0)})}}function ej(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function eO(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var eP=function(){var e=(0,i.Y)(),t=e.currentCommunityProcessorPaymentMethodConfigurationId,r=e.isLinkPreferenceEnabled,n=e.currentCommunityMemberPaymentProcessorSessionClientSecret,a=e.isMemberWithSavedPaymentMethods,l=e.isMemberUsingSavedPaymentMethod,u=e.stripePaymentMethodType,s=e.stripeElementsMode,c=e.isPaywallsCheckoutWithoutInternalResourcesEnabled,d=(0,E.useElements)(),p=ew(),f=(0,o.useRef)(null),m=(0,o.useCallback)(function(){return ex(function(){var e,o,i;return eO(this,function(m){switch(m.label){case 0:if(!d)return[2];if(s!==R.hX.setup)return[3,5];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,p()];case 2:case 3:return m.sent(),[3,4];case 4:return[2];case 5:return e=function(){ex(function(){var e;return eO(this,function(r){switch(r.label){case 0:if(!f.current)return[2];d.off("update-end",f.current),f.current=null,(0,N.EZ)("onSubmitWithPMC.elements.off('update-end') - removed listener",{type:"manual"}),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,p()];case 2:case 3:return r.sent(),[3,5];case 4:return e={customerSessionClientSecret:n,payment_method_configuration:t,payment_method_types:null,setup_future_usage:null},(0,N.EZ)("onSubmitWithPMC.elements.update - restored original options",{metadata:ej({},e),type:"manual"}),d.update(e),[7];case 5:return[2]}})})()},f.current=e,(0,N.EZ)("onSubmitWithPMC.elements.on('update-end') - attached listener",{type:"manual"}),d.on("update-end",e),o=(0,L.m9)(r,u),i={customerSessionClientSecret:(0,L.Me)(n,u,a,l),payment_method_configuration:null,payment_method_types:o,setup_future_usage:(0,L.O3)(u,c)},(0,N.EZ)("onSubmitWithPMC.elements.update - triggered 'update-end' event",{metadata:ej({},i),type:"manual"}),d.update(i),[2]}})})()},[t,r,u,n,a,l,s,d,p,c]);return(0,o.useEffect)(function(){return function(){d&&f.current&&(d.off("update-end",f.current),f.current=null,(0,N.EZ)("onSubmitWithPMC.elements.off('update-end') - cleaned up listener",{type:"manual"}))}},[d]),{onSubmit:m}},eS=function(){var e=(0,c.Gc)().watch,t=(0,i.Y)(),r=t.currentUser,n=t.hasAlreadyPurchased,a=t.loginUrl,u=t.communityRootUrl,s=t.paywall,d=t.getSelectedPrice,p=t.previewMutation,f=t.paymentError,m=t.isCardInfoValid,y=t.isPaywallActive,b=t.isCardInfoComplete,v=t.setIsCardInfoComplete,h=t.isTaxIdMandatory,_=t.shouldShowTaxIdForm,w=t.setStripePaymentMethodType,g=t.setIsMemberUsingSavedPaymentMethod,x=t.currentCommunity,j=t.currentCommunityMember,O=(0,E.useStripe)(),P=d(),S=e(),k=S.name,I=S.email,C=S.password,L=S.termsOfService,R=S.community_member_billing_info_address_attributes_complete,U=S.community_member_billing_info_attributes,F=U.tax_id_value,V=U.tax_id_type,B=A.CU.test(I),q=A.zU.test(C),Z=!R||!L||!r&&(!k||!B||!q)||!m||!y||f.disablePayButton||(0,l.y9)(n,s)||p.isLoading||p.isError||h&&_&&(!F||!V),z=p.data,W=(0,D.Gs)({isPaywallActive:y,selectedPrice:P,preview:z,currency:s.currency}),H=eP().onSubmit,G=(0,o.useCallback)(function(e){var t,r,n,o,a;w(e.value.type),e.complete?((0,N.EZ)("usePayment.onChange - completed payment method",{metadata:{payment_method_id:null==(o=e.value)||null==(n=o.payment_method)?void 0:n.id,payment_method_type:null==(a=e.value)?void 0:a.type},type:"manual"}),v(!0)):b&&v(!1),g(!!(null==(r=e.value)||null==(t=r.payment_method)?void 0:t.id))},[b,v,g,w]),K=(0,o.useCallback)(function(e){var t=T.K.fromStripeError("usePayment.onLoadError",e.error);(0,M.M)(t,{caller:t.caller,communityId:null==x?void 0:x.id,communityMemberId:null==j?void 0:j.id,communityMemberUserId:null==r?void 0:r.id,extra:t.getExtra(),paywallId:null==s?void 0:s.id})},[x,j,r,s]);return{paymentError:f,isSubmitDisabled:Z,selectedPrice:P,currentUser:r,stripe:O,loginUrl:a,communityRootUrl:u,payButtonLabel:W,hasAlreadyPurchased:n,handleOnChangeCard:G,handleOnReadyCard:function(e){return r&&e.focus()},onLoadError:K,onSubmit:H}},ek=r(758702),eI=r(646193),eC=r(186177),eE=r(722024),eN=r(770092),eA=r(712781),eT=r(343995),eM=r(698365),eD=function(){var e,t=(0,eT.Q)().paywallCustomization,r=((null==t?void 0:t.countdown_properties)||{enabled:!1}).enabled,n=null==t?void 0:t.countdown_properties;return r&&(0,eM.d0)(null==n||null==(e=n.action)?void 0:e.action_type)},eL=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=eD();return(0,o.useMemo)(function(){var r=new URL(window.location.href),n=Object.keys(e);return t&&r.searchParams.set(eM.WI,"true"),n.forEach(function(t){r.searchParams.set(t,e[t])}),r.href},[t,e])},eR=function(){var e=(0,i.Y)(),t=e.currentUser,r=e.currentCommunityMember||t,o=eL();if(!r)return null;var l="".concat((0,s.jE)(),"?redirect_back_url=").concat(o);return(0,n.jsxs)("div",{className:"border-primary bg-primary shadow-xs flex flex-row items-center gap-x-4 rounded-lg border p-4","data-testid":"checkout-form-account-details",children:[(0,n.jsx)(eA.W,{src:r.avatar_url,name:r.name,size:"10"}),(0,n.jsxs)("div",{className:"flex w-full flex-col justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,n.jsx)(y.Z.LabelSm,{weight:"medium","data-testid":"checkout-form-account-details-name",children:r.name}),(0,n.jsx)(y.Z.LabelXs,{weight:"medium",children:(0,n.jsx)("a",{className:"!text-dark cursor-pointer",href:l,children:(0,a.t)("sign_out")})})]}),(0,n.jsx)(y.Z.LabelXs,{weight:"medium",color:"text-default","data-testid":"checkout-form-account-details-email",children:r.email})]})]})},eU=r(451507);function eF(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function eV(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function eB(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eF(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eq=function(e){var t=e.fieldName,r=eB((0,o.useState)(!1),2),n=r[0],a=r[1],i=eB((0,o.useState)(!1),2),l=i[0],u=i[1],s=(0,c.Gc)(),d=s.watch,p=s.formState.errors,f=s.trigger,m=d(t),y=(0,c.U2)(p,t),b=(0,o.useMemo)(function(){return(0,eU.eF)(m||"")},[m]);return(0,o.useEffect)(function(){m||a(!1)},[m]),(0,o.useEffect)(function(){(0,eU.G2)(b)&&y&&f(t)},[b,y,f,t]),{isPasswordVisible:n,isFocused:l,setIsPasswordVisible:a,passwordFieldError:y,passwordValue:m,passwordStrength:b,handleBlur:function(){var e;return(e=function(){return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return u(!1),[4,f(t)];case 1:return e.sent(),[2]}})},function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){eV(a,n,o,i,l,"next",e)}function l(e){eV(a,n,o,i,l,"throw",e)}i(void 0)})})()},handleFocus:(0,o.useCallback)(function(){u(!0)},[])}},eZ=r(113461),ez=r(577696),eW=function(e){var t=e.email,r=e.onClose,o=(0,C.kK)();return(0,n.jsxs)("div",{className:"bg-secondary flex items-center justify-between rounded-t-lg py-[13px]",children:[(0,n.jsx)(y.Z.BodySm,{weight:"normal",size:"text-md",children:t}),(0,n.jsx)(m.z,{type:"button",variant:"tertiary",onClick:r,className:"rounded-full !p-1",children:(0,n.jsx)(d.JO,{type:o?"24-close":"20-close",size:o?24:20,className:(0,u.A)({"!text-dark":o,"text-primary":!o})})})]})},eH=function(){return(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-md border px-2 py-1",children:[(0,n.jsx)(d.JO,{type:"16-safe-lock",size:16,color:"text-tertiary"}),(0,n.jsx)(y.Z.LabelXs,{weight:"medium",color:"text-tertiary",children:(0,a.t)("paywall_checkout.form.safe_and_secure")})]})},eG="paywall_checkout.form.email_verification_states.account_setup_state",eK=function(e){var t=e.email,r=e.onClose,o=(0,i.Y)().currentCommunity,l=eq({fieldName:"password"}),u=l.isPasswordVisible,s=l.setIsPasswordVisible,c=l.passwordValue,d=l.passwordFieldError,p=l.passwordStrength,f=l.handleBlur,m=(null==o?void 0:o.name)||(0,a.t)([eG,"community_label"]);return(0,n.jsxs)("div",{className:"flex flex-col gap-5 pb-6 *:px-6",children:[(0,n.jsx)(eW,{email:t,onClose:r}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"flex flex-col gap-6",children:(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)(y.Z.TitleSm,{weight:"bold",size:"text-md",children:(0,a.t)([eG,"join_community"],{community_name:m})}),(0,n.jsx)(y.Z.BodySm,{weight:"normal",color:"text-default",children:(0,a.t)([eG,"create_password"],{community_name:m})})]})}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsxs)(rF.Item,{name:"password",children:[(0,n.jsxs)("div",{className:"relative flex items-center",children:[(0,n.jsx)(O,{type:u&&c?"text":"password",name:"password",options:{required:!0,pattern:A.zU},className:"w-full",checkoutFormClassName:"!pr-12",onBlur:f}),(0,n.jsx)(ez.Z,{passwordValue:c,isPasswordVisible:u,setIsPasswordVisible:s})]}),(0,n.jsx)(eZ.o,{passwordStrength:p,passwordFieldError:d,passwordValue:c})]})})]}),(0,n.jsx)("div",{className:"flex items-center justify-start",children:(0,n.jsx)(eH,{})})]})},eX="initial",eY="otp_required",eQ="password_signin",e$="signup",eJ="claim",e0="SET_EMAIL",e1="START_VALIDATION",e2="VALIDATION_SUCCESS",e3="VALIDATION_ERROR",e4="START_OTP_SUBMISSION",e5="OTP_SUBMISSION_SUCCESS",e6="OTP_SUBMISSION_ERROR",e8="START_RESEND_OTP",e7="RESEND_OTP_SUCCESS",e9="RESEND_OTP_ERROR",te="START_PASSWORD_SUBMISSION",tt="PASSWORD_SUBMISSION_SUCCESS",tr="PASSWORD_SUBMISSION_ERROR",tn="START_FORGOT_PASSWORD_SUBMISSION",to="FORGOT_PASSWORD_SUBMISSION_SUCCESS",ta="FORGOT_PASSWORD_SUBMISSION_ERROR",ti="SHOW_OTP_FORM",tl="SHOW_PASSWORD_FORM",tu="SHOW_CLAIM_FORM",ts="RESET_TO_INITIAL",tc=function(e){return"existing_member"===e},td=function(e){return"new_member"===e},tp=function(e){return"user_with_pending_invitation"===e},tf=function(e){return e===e$};function tm(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var ty=function(e){var t=e.onAuthenticationLinkClick,r=(0,c.Gc)(),n=r.trigger,a=r.formState.errors,i=(0,r.watch)("email"),l=(0,o.useCallback)(function(){},[]),u=(0,o.useCallback)(function(){null==t||t()},[t]);return(0,o.useEffect)(function(){var e;(e=function(){var e;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!((e=null==i?void 0:i.trim())&&A.CU.test(e)&&a.email&&"manual"!==a.email.type))return[3,2];return[4,n("email")];case 1:t.sent(),t.label=2;case 2:return[2]}})},function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){tm(a,n,o,i,l,"next",e)}function l(e){tm(a,n,o,i,l,"throw",e)}i(void 0)})})()},[i,n,a.email]),{handleBlur:l,handleAuthenticationClick:u}},tb="paywall_checkout.form.email_verification_states.initial_state",tv=function(e){var t=e.isValidating,r=void 0!==t&&t,o=e.shouldShowAuthenticationLink,i=ty({onAuthenticationLinkClick:e.onAuthenticationLinkClick}),l=i.handleBlur,u=i.handleAuthenticationClick;return(0,n.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[(0,n.jsx)(rF.Item,{name:"email",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(O,{type:"text",name:"email",onBlur:l,options:{required:!0,pattern:A.CU}}),r&&(0,n.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2",children:(0,n.jsx)(_.a,{})})]})}),void 0!==o&&o&&(0,n.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,n.jsx)(d.JO,{className:"text-v2-warning",type:"info",size:20,useWithFillCurrentColor:!0}),(0,n.jsxs)(y.Z.LabelXs,{weight:"normal",color:"text-tertiary",children:[(0,n.jsx)(m.z,{type:"button",disabled:r,variant:"link",onClick:u,className:"text-tertiary hover:text-primary !h-auto !p-0 underline",children:(0,n.jsx)(y.Z.LabelXs,{weight:"medium",color:"inherit",children:(0,a.t)([tb,"authenticate_account"])})})," ".concat((0,a.t)([tb,"before_completing_checkout"]))]})]})]})},th=function(e){var t=e.shouldShowMessage,r=e.messageType;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)(_.a,{className:"!py-0"})}),(void 0===t||t)&&(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(y.Z.BodySm,{weight:"normal",color:"text-default",children:(0,a.t)(["paywall_checkout.form","success"===r?"completing_login":"authenticating_account"])})})]})},t_=function(){var e=(0,Z.i)().refreshSession;return{reloadPage:function(){e()}}};function tw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var tg=function(e){var t,r=e.status,n=e.isSubmitting,a=void 0!==n&&n,i=e.error,l=void 0===i?null:i,u=e.onOTPSubmit,s=e.onResendCode,c=e.onShowClaimForm,d=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tw(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tw(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1],m=t_().reloadPage,y=(0,o.useRef)(!1),b=(0,o.useCallback)(function(e){null==u||u(e)},[u]),v=(0,o.useCallback)(function(){null==s||s()},[s]);(0,o.useEffect)(function(){a?(y.current=!0,f(!1)):y.current&&!a&&(y.current=!1,l||(f(!0),tc(r)||td(r)?m():(null==c||c(),f(!1))))},[a,l,r,c]),(0,o.useEffect)(function(){l&&f(!1)},[l]);var h=p&&!a&&!l,_=!(a||h);return{isSuccessShown:h,hasError:!!l,shouldShowSuccess:h,shouldShowFooter:_,handleOTPComplete:b,handleResendClick:v}},tx=function(e){var t=e.status,r=e.isSubmitting,o=e.isResending,i=e.onShowPasswordForm;return(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[tc(t)&&(0,n.jsx)(m.z,{type:"button",variant:"link",onClick:i,disabled:void 0!==r&&r||void 0!==o&&o,className:"!px-0 underline",children:(0,n.jsx)(y.Z.LabelSm,{weight:"normal",children:(0,a.t)(["paywall_checkout.form.email_verification_states.otp_state","sign_in_with_password"])})}),(0,n.jsx)(eH,{})]})},tj=r(348131);function tO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function tP(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function tS(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var tk=function(e){var t,r,i=e.onComplete,l=e.onValueChange,u=e.disabled,s=void 0!==u&&u,c=e.error,d=void 0!==c&&c,p=(t=(0,o.useState)(""),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tO(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=p[0],m=p[1],y=(0,C.WJ)();return(0,o.useEffect)(function(){d&&m("")},[d]),(0,n.jsxs)("fieldset",{className:"contents",children:[(0,n.jsx)("legend",{className:"sr-only",children:(0,a.t)("paywall_checkout.form.email_verification_states.otp_state.verification_code_legend")}),(0,n.jsx)(tj.default,{value:f,onChange:function(e){m(e),null==l||l(e),6===e.length&&(null==i||i(e))},numInputs:6,separator:(0,n.jsx)("span",{className:"w-[.65rem] sm:w-[1.9rem]"}),isInputNum:!0,shouldAutoFocus:!s,inputStyle:(r={width:y?"56px":"48px",height:y?"56px":"48px",border:"1px solid",borderRadius:"8px",fontSize:y?"18px":"16px",lineHeight:y?"28px":"24px",fontWeight:"500",textAlign:"center",outline:"none",transition:"all 0.15s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--color-white)",color:"var(--color-text-darkest)"},s?tS(tP({},r),{borderColor:"var(--color-border-tertiary)",backgroundColor:"var(--color-background-secondary)",cursor:"not-allowed",color:"var(--color-text-disabled)"}):d?tS(tP({},r),{borderColor:"var(--color-feedback-error)"}):tS(tP({},r),{borderColor:"var(--color-border-primary)",boxShadow:"none"})),focusStyle:d?{borderColor:"var(--color-feedback-error)",boxShadow:"0 0 0 2px rgba(220, 38, 38, 0.2)"}:{borderColor:"var(--color-border-light)"},isDisabled:s})]})},tI="paywall_checkout.form.email_verification_states.otp_state",tC=function(e){var t=e.isSubmitting,r=e.isResending,o=void 0!==r&&r,i=e.onResendClick;return(0,n.jsxs)("div",{children:["".concat((0,a.t)([tI,"did_not_receive_code"])," "),(0,n.jsx)(m.z,{type:"button",variant:"link",onClick:i,className:"!h-auto !p-0 underline",disabled:void 0!==t&&t||o,children:(0,n.jsx)(y.Z.LabelSm,{weight:"normal",children:o?(0,a.t)([tI,"sending"]):(0,a.t)([tI,"resend_code"])})})]})},tE="paywall_checkout.form.email_verification_states.otp_state",tN=function(e){var t=e.email,r=e.status,o=e.onClose,i=e.onShowPasswordForm,l=e.onShowClaimForm,u=e.onOTPSubmit,s=e.onResendCode,c=e.isSubmitting,d=void 0!==c&&c,p=e.isResending,f=void 0!==p&&p,m=e.error,b=tg({status:r,isSubmitting:d,error:void 0===m?null:m,onOTPSubmit:u,onResendCode:s,onShowClaimForm:l}),v=b.hasError,h=b.shouldShowSuccess,_=b.shouldShowFooter,w=b.handleOTPComplete,g=b.handleResendClick;return(0,n.jsxs)("div",{className:"flex flex-col gap-5 pb-6 *:px-6",children:[(0,n.jsx)(eW,{email:t,onClose:o}),(0,n.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)(y.Z.TitleSm,{weight:"bold",size:"text-md",children:(0,a.t)([tE,"enter_verification_code"])}),(0,n.jsxs)(y.Z.BodySm,{weight:"normal",color:"text-default",textAlign:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{children:[(0,a.t)([tE,"enter_the_code_sent_to"]),"\xa0",(0,n.jsx)(y.Z.LabelSm,{weight:"medium",children:t}),"\xa0",(0,a.t)([tE,"to_securely_authenticate_your_account"])]}),(0,n.jsx)(tC,{isSubmitting:d,isResending:f,onResendClick:g})]})]}),(0,n.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,n.jsx)(tk,{onComplete:w,disabled:d||f,error:v})})]}),(d||h)&&(0,n.jsx)(th,{messageType:h&&(tc(r)||td(r))?"success":"authenticating"}),_&&(0,n.jsx)(tx,{status:r,isSubmitting:d,isResending:f,onShowPasswordForm:i})]})};function tA(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function tT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tA(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tM=function(e){var t=e.isSubmitting,r=void 0!==t&&t,n=e.error,a=void 0===n?null:n,i=e.onPasswordSubmit,l=tT((0,o.useState)(""),2),u=l[0],s=l[1],c=tT((0,o.useState)(!1),2),d=c[0],p=c[1],f=(0,o.useRef)(!1),m=t_().reloadPage,y=(0,o.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),u.trim()&&(null==i||i(u))},[u,i]),b=(0,o.useCallback)(function(e){s(e.target.value)},[]),v=(0,o.useCallback)(function(e){"Enter"!==e.key||r||(e.preventDefault(),e.stopPropagation(),y(e))},[r,y]);return(0,o.useEffect)(function(){r?(f.current=!0,p(!1)):f.current&&!r&&(f.current=!1,a||p(!0))},[r,a]),(0,o.useEffect)(function(){a&&p(!1)},[a]),(0,o.useEffect)(function(){d&&m()},[d]),{password:u,hasError:!!a,isSuccessShown:d,handleSubmit:y,handlePasswordChange:b,handleKeyDown:v}},tD="paywall_checkout.form.email_verification_states.password_state",tL=function(e){var t=e.isSubmitting,r=e.isSubmittingForgotPassword,o=e.onForgotPasswordSubmit,i=e.onShowOTPForm;return(0,n.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,n.jsxs)("div",{className:"flex justify-between sm:gap-4",children:[(0,n.jsx)(m.z,{type:"button",variant:"link",onClick:o,disabled:t||r,className:"!px-0 underline",children:(0,n.jsx)(y.Z.LabelSm,{weight:"normal",children:(0,a.t)([tD,"forgot_password.link"])})}),(0,n.jsx)(m.z,{type:"button",variant:"link",onClick:i,disabled:t||r,className:"!px-0 underline",children:(0,n.jsx)(y.Z.LabelSm,{weight:"normal",children:(0,a.t)([tD,"sign_in_with_code"])})})]}),(0,n.jsx)("div",{className:"flex justify-start sm:justify-end",children:(0,n.jsx)(eH,{})})]})},tR="paywall_checkout.form.email_verification_states.password_state",tU=function(e){var t=e.password,r=e.hasError,o=e.isSubmitting,i=e.isSubmittingForgotPassword,l=e.shouldShowActions,u=e.onPasswordChange,s=e.onKeyDown,c=e.onSubmit;return(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)(y.Z.TitleSm,{weight:"bold",size:"text-md",children:(0,a.t)([tR,"sign_in_to_your_account"])}),(0,n.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,n.jsx)(y.Z.LabelSm,{weight:"medium",children:(0,a.t)("paywall_checkout.form.fields.password")}),(0,n.jsx)(x,{type:"password",value:t,onChange:u,onKeyDown:s,disabled:o||i,error:r,autoFocus:!0,autoComplete:"current-password"})]}),l&&(0,n.jsx)(m.z,{type:"button",variant:"circle",disabled:o||i||!t.trim(),onClick:c,className:"self-start !text-sm font-medium","data-testid":"paywall-checkout-password-sign-in-button",children:(0,a.t)([tR,"sign_in"])})]})]})},tF=function(e){var t=e.email,r=e.onClose,o=e.onShowOTPForm,a=e.onPasswordSubmit,i=e.onForgotPasswordSubmit,l=e.isSubmitting,u=void 0!==l&&l,s=e.isSubmittingForgotPassword,c=void 0!==s&&s,d=e.error,p=tM({isSubmitting:u,error:void 0===d?null:d,onPasswordSubmit:a}),f=p.password,m=p.hasError,y=p.isSuccessShown,b=p.handleSubmit,v=p.handlePasswordChange,h=p.handleKeyDown,_=u||c,w=y&&!_,g=!_&&!w;return(0,n.jsxs)("div",{className:"flex flex-col gap-5 pb-6 *:px-6",children:[(0,n.jsx)(eW,{email:t,onClose:r}),(0,n.jsx)(tU,{password:f,hasError:m,isSubmitting:u,isSubmittingForgotPassword:c,shouldShowActions:g,onPasswordChange:v,onKeyDown:h,onSubmit:b}),(_||w)&&(0,n.jsx)(th,{shouldShowMessage:u||w,messageType:w?"success":"authenticating"}),g&&(0,n.jsx)(tL,{isSubmitting:u,isSubmittingForgotPassword:c,onForgotPasswordSubmit:i,onShowOTPForm:o})]})},tV=function(e){var t=e.displayedStep,r=e.state,o=e.onAuthenticationLinkClick,a=e.resetToInitial,i=e.showPasswordForm,l=e.showClaimForm,u=e.handleOTPSubmit,s=e.handleResendOTP,c=e.showOTPForm,d=e.handlePasswordSubmit,p=e.handleForgotPasswordSubmit;return t===eX||"validating"===t?(0,n.jsx)(tv,{isValidating:r.isLoading,shouldShowAuthenticationLink:r.shouldShowAuthenticationLink,onAuthenticationLinkClick:o}):t===eY?(0,n.jsx)(tN,{email:r.email,status:r.status,onClose:a,onShowPasswordForm:i,onShowClaimForm:l,onOTPSubmit:u,onResendCode:s,isSubmitting:r.isSubmittingOTP,isResending:r.isResendingOTP,error:r.error}):t===eQ?(0,n.jsx)(tF,{email:r.email,onClose:a,onShowOTPForm:c,onPasswordSubmit:d,onForgotPasswordSubmit:p,isSubmitting:r.isSubmittingPassword,isSubmittingForgotPassword:r.isSubmittingForgotPassword,error:r.error}):tf(t)||t===eJ?(0,n.jsx)(eK,{email:r.email,onClose:a}):null};function tB(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var tq=function(e){var t=e.verifyEmail,r=e.onEmailChange,n=e.onValidationStart,a=e.onValidationSuccess,i=e.onValidationError,l=(0,(0,c.Gc)().watch)("email")||"",u=(0,o.useMemo)(function(){return(0,Y.debounce)(function(e){var r;return(r=function(){return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(!A.CU.test(e))return[2];n(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t(e)];case 2:return a(r.sent().status),[3,4];case 3:return r.sent(),i(""),[3,4];case 4:return[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var a=r.apply(e,t);function i(e){tB(a,n,o,i,l,"next",e)}function l(e){tB(a,n,o,i,l,"throw",e)}i(void 0)})})()},500)},[t,n,a,i]),s=(0,o.useCallback)(function(e){r(e),A.CU.test(e)&&u(e)},[r,u]);return(0,o.useEffect)(function(){var e=l.trim();e&&s(e)},[l,s]),{handleEmailChange:s}},tZ=function(e){var t=e.state,r=e.dispatch,n=e.setValue,a=e.mutations,i=a.verifyEmailMutation,l=a.verifyOTPMutation,u=a.resendOTPMutation,s=a.signInWithPasswordMutation,c=a.forgotPasswordMutation;return{handleEmailChange:(0,o.useCallback)(function(e){r({type:e0,payload:e}),n("email",e)},[r,n]),startValidation:(0,o.useCallback)(function(){r({type:e1})},[r]),handleValidationSuccess:(0,o.useCallback)(function(e){r({type:e2,payload:{status:e}})},[r]),handleValidationError:(0,o.useCallback)(function(e){r({type:e3,payload:e})},[r]),handleOTPSubmit:(0,o.useCallback)(function(e){t.email&&(r({type:e4}),l.mutate({email:t.email,otp:e}))},[t.email,r,l]),handlePasswordSubmit:(0,o.useCallback)(function(e){t.email&&(r({type:te}),s.mutate({email:t.email,password:e}))},[t.email,r,s]),handleForgotPasswordSubmit:(0,o.useCallback)(function(){t.email&&(r({type:tn}),c.mutate(t.email))},[t.email,r,c]),handleResendOTP:(0,o.useCallback)(function(){t.email&&(r({type:e8}),u.mutate(t.email))},[t.email,r,u]),showOTPForm:(0,o.useCallback)(function(){r({type:ti})},[r]),showPasswordForm:(0,o.useCallback)(function(){r({type:tl})},[r]),showClaimForm:(0,o.useCallback)(function(){r({type:tu}),t.verifiedOTP&&tp(t.status)&&n("otp",t.verifiedOTP)},[r,t.verifiedOTP,t.status,n]),resetToInitial:(0,o.useCallback)(function(){r({type:ts}),n("password",""),n("otp","")},[r,n]),handleAuthenticationLinkClick:(0,o.useCallback)(function(){t.email&&A.CU.test(t.email)&&(r({type:e1}),i.mutate(t.email))},[t.email,r,i])}},tz=r(547550),tW=r(191369),tH=r(169530),tG=r(192918),tK=r(637261);function tX(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var tY=function(){var e=(0,F.useQueryClient)();return(0,F.useMutation)({mutationFn:function(e){var t;return(t=function(){var t;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){return t=tG.c.update({sessionId:e.sessionId,paywallId:e.paywallId}),[2,(0,tz.aU)(t,{})]})},function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function i(e){tX(a,n,o,i,l,"next",e)}function l(e){tX(a,n,o,i,l,"throw",e)}i(void 0)})})()},onSuccess:function(t,r){(0,tK.m)(e,r.paywallId,t)},onError:function(e){console.error(e.message)}})},tQ=function(e){var t=e.dispatch,r=(0,tH.pm)(),n=r.success,o=r.error,i=(0,Z.i)().session,l=tY().mutate,u=function(){if(i){var e=(0,ep.J$)(i.steps[0]);e&&i.id&&l({sessionId:i.id,paywallId:e.paywall.id})}},c=function(e){return function(r){var n=(null==r?void 0:r.message)||(0,a.t)("paywall_checkout.form.errors.generic_error");t({type:e,payload:n}),o(n,{duration:"long"})}};return{verifyEmailMutation:(0,F.useMutation)(function(e){return(0,tz.Cu)(s.av.paywallCheckout.emailVerifications.create(),{email:e})},{onSuccess:function(e){t({type:e2,payload:{status:e.status}})},onError:c(e3)}),verifyOTPMutation:(0,F.useMutation)(function(e){var t=e.email,r=e.otp;return(0,tz.Cu)(s.av.paywallCheckout.otpSessions.create(),{user:{email:t,otp:r}})},{onSuccess:function(e,r){t({type:e5,payload:{otp:r.otp}}),u()},onError:c(e6)}),resendOTPMutation:(0,F.useMutation)(function(e){return(0,tz.Cu)(tW.P.resendOtp(),{user:{email:e}})},{onSuccess:function(){t({type:e7}),n((0,a.t)("paywall_checkout.form.resent_otp"))},onError:c(e9)}),signInWithPasswordMutation:(0,F.useMutation)(function(e){var t=e.email,r=e.password;return(0,tz.Cu)(s.av.paywallCheckout.authSessions.create(),{user:{email:t,password:r}})},{onSuccess:function(){t({type:tt}),u()},onError:c(tr)}),forgotPasswordMutation:(0,F.useMutation)(function(e){return(0,tz.Cu)(tW.P.resetPassword(),{user:{email:e}})},{onSuccess:function(){t({type:to}),n((0,a.t)("paywall_checkout.form.email_verification_states.password_state.forgot_password.success"))},onError:c(ta)})}};function t$(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function tJ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function t0(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var t1=function(e,t){var r,n;switch(t.type){case e0:return t0(tJ({},e),{email:t.payload,error:null});case e1:return t0(tJ({},e),{isLoading:!0,error:null});case e2:return t0(tJ({},e),{isLoading:!1,status:t.payload.status,step:"user_not_found"===(r=t.payload.status)?e$:tc(r)||td(r)||tp(r)?eY:eX,error:null});case e3:return t0(tJ({},e),{isLoading:!1,error:t.payload||null});case e4:return t0(tJ({},e),{isSubmittingOTP:!0,error:null});case e5:return t0(tJ({},e),{isSubmittingOTP:!1,verifiedOTP:(null==(n=t.payload)?void 0:n.otp)||null});case e6:return t0(tJ({},e),{isSubmittingOTP:!1,error:t.payload});case e8:return t0(tJ({},e),{isResendingOTP:!0,error:null});case e7:return t0(tJ({},e),{isResendingOTP:!1});case e9:return t0(tJ({},e),{isResendingOTP:!1,error:t.payload});case te:return t0(tJ({},e),{isSubmittingPassword:!0,error:null});case tt:return t0(tJ({},e),{isSubmittingPassword:!1});case tr:return t0(tJ({},e),{isSubmittingPassword:!1,error:t.payload});case tn:return t0(tJ({},e),{isSubmittingForgotPassword:!0,error:null});case to:return t0(tJ({},e),{isSubmittingForgotPassword:!1});case ta:return t0(tJ({},e),{isSubmittingForgotPassword:!1,error:t.payload});case ti:return t0(tJ({},e),{step:eY,error:null});case tl:return t0(tJ({},e),{step:eQ,error:null});case"SHOW_SIGNUP_FORM":return t0(tJ({},e),{step:e$,error:null});case tu:return t0(tJ({},e),{step:eJ,error:null});case ts:return t0(tJ({},e),{step:eX,status:null,verifiedOTP:null,error:null,shouldShowAuthenticationLink:!0});default:return e}},t2={step:eX,email:"",status:null,verifiedOTP:null,isLoading:!1,isSubmittingOTP:!1,isResendingOTP:!1,isSubmittingPassword:!1,isSubmittingForgotPassword:!1,error:null,shouldShowAuthenticationLink:!1},t3=function(){var e,t=(e=(0,o.useReducer)(t1,t2),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,2)||function(e,t){if(e){if("string"==typeof e)return t$(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t$(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=t[0],n=t[1],a=(0,c.Gc)(),i=a.setValue,l=a.formState.errors,u=a.setFocus,s=tQ({dispatch:n}),d=tZ({state:r,dispatch:n,setValue:i,mutations:s});return(0,o.useEffect)(function(){l.email&&tf(r.step)&&setTimeout(function(){n({type:ts}),i("password",""),u("email")},0)},[l.email,r.step,i,u]),tJ({state:r,verifyEmail:s.verifyEmailMutation.mutateAsync},d)};function t4(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t5(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,l=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(l)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return t4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t4(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t6=function(e){var t=e.currentStep,r=t5((0,o.useState)(!1),2),n=r[0],a=r[1],i=t5((0,o.useState)(void 0),2),l=i[0],u=i[1],s=t5((0,o.useState)(t),2),c=s[0],d=s[1],p=(0,o.useRef)(null);return(0,o.useEffect)(function(){t!==c&&p.current&&(a(!0),u(p.current.offsetHeight),setTimeout(function(){d(t),setTimeout(function(){p.current&&(u(p.current.scrollHeight),setTimeout(function(){a(!1),u(void 0)},300))},50)},200))},[t,c]),{isTransitioning:n,currentHeight:l,displayedStep:c,contentRef:p}},t8=function(){var e=t3(),t=e.state,r=e.verifyEmail,o=e.handleEmailChange,a=e.startValidation,i=e.handleValidationSuccess,l=e.handleValidationError,s=e.handleOTPSubmit,c=e.handlePasswordSubmit,d=e.handleForgotPasswordSubmit,p=e.handleResendOTP,f=e.showOTPForm,m=e.showPasswordForm,y=e.showClaimForm,b=e.resetToInitial,v=e.handleAuthenticationLinkClick;tq({verifyEmail:r,onEmailChange:o,onValidationStart:a,onValidationSuccess:i,onValidationError:l});var h=t6({currentStep:t.step}),_=h.isTransitioning,w=h.currentHeight,g=h.displayedStep,x=h.contentRef;return(0,n.jsx)("div",{className:(0,u.A)("border-primary shadow-xs rounded-lg border bg-white","relative w-full overflow-hidden","mx-auto","sm:mx-auto md:mx-0"),children:(0,n.jsx)("div",{className:"overflow-hidden transition-all duration-300 ease-out",style:{height:w?"".concat(w,"px"):"auto"},children:(0,n.jsx)("div",{ref:x,className:(0,u.A)("transition-all duration-200 ease-in-out",{"-translate-y-2 opacity-0":_,"translate-y-0 opacity-100":!_}),children:(0,n.jsx)(tV,{displayedStep:g,state:t,onAuthenticationLinkClick:v,resetToInitial:b,showPasswordForm:m,showClaimForm:y,handleOTPSubmit:s,handleResendOTP:p,showOTPForm:f,handlePasswordSubmit:c,handleForgotPasswordSubmit:d})})})})},t7=r(277010),t9=Object.assign(function(){var e=(0,i.Y)().currentUser;return(0,eE.wh)().isLoading?null:(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 lg:pb-6",children:[(0,n.jsx)("div",{children:(0,n.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,a.t)("paywall_checkout.your_account")})}),(0,n.jsx)(eN.g,{className:"gap-y-5 !py-0",children:e?(0,n.jsx)(eR,{}):(0,n.jsx)(t8,{})})]})},{Skeleton:function(){return(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 lg:pb-6",children:[(0,n.jsx)(t7.X2,{square:!0,xl:!0,half:!0}),(0,n.jsx)(eN.g,{className:"gap-y-5 !py-0",children:(0,n.jsxs)("div",{className:(0,u.A)("flex flex-col gap-y-4 p-6","border-primary shadow-xs rounded-xl border bg-white","relative w-full overflow-hidden","mx-auto","sm:mx-auto md:mx-0"),children:[(0,n.jsx)(t7.X2,{square:!0,half:!0}),(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0})]})})]})}}),re=r(976598),rt=r(687401),rr=function(){return(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)("div",{className:"inline-flex items-start gap-3",children:(0,n.jsx)(rt.X,{id:"terms",name:"termsOfService","data-testid":"checkout-form-terms-checkbox",label:(0,n.jsx)(re.y,{variant:"paywallCheckout"})})})})},rn=r(421065),ro=r(84440),ra=r(531744),ri="community_member_billing_info_attributes.tax_id_type",rl={addressCountry:"community_member_billing_info_attributes.address_country",taxIdType:ri,taxIdTypeLabel:"community_member_billing_info_attributes.tax_id_type_label",taxIdValue:"community_member_billing_info_attributes.tax_id_value"},ru=function(){var e,t=(0,(0,c.Gc)().watch)().community_member_billing_info_attributes,r=(void 0===t?{}:t).address_country,a=(0,i.Y)(),l=a.isTaxCollectionEnabled,u=a.isBrazilianAccountAndProcessorStripeBr,s=(0,o.useMemo)(function(){return{fieldNames:rl,selectedCountry:r,isBrazilianCommunity:u,isTaxCollectionEnabled:l}},[r,u,l]),d=(0,ro.g)(s),p=d.handleTaxIdTypeChange,f=d.isRequired,m=d.isTaxIdValueRequired,y=d.isVisible,b=d.selectedTaxIdType,v=d.selectOptions,h=d.taxIdTypeLabel;if(!y)return null;var _=(null==b||null==(e=b.formOptions)?void 0:e.pattern)||/.+/;return(0,n.jsxs)(rF.Item,{name:"tax_id",optional:!f,children:[(0,n.jsx)(ra.P,{variant:"single",name:"taxIdTypeLabel",data:v,value:h,onChange:p,filterBy:rn.gf,hideSelectedItems:!0,dataTestId:"checkout-form-".concat(ri)}),h&&(0,n.jsx)(O,{className:"mt-2 grow",type:"text",name:"community_member_billing_info_attributes.tax_id_value",placeholder:null==b?void 0:b.example,options:{required:m,pattern:_}})]})},rs=function(){var e=(0,(0,c.Gc)().watch)().community_member_billing_info_attributes.address_country,t=(0,i.Y)(),r=t.isMemberAddressRequired,o=t.isTaxIdCollectionEnabled,l=t.shouldShowTaxIdForm,u=t.enableTaxIdCollection;return l&&(!r||e)&&(!e||(0,rn.Zx)(e))?o?(0,n.jsx)(ru,{}):(0,n.jsx)("div",{className:"flex flex-row items-center gap-x-1 underline",children:(0,n.jsx)(m.z,{type:"button",variant:"link",className:"!p-0",onClick:u,"data-testid":"checkout-form-add-tax-id-button",children:(0,n.jsx)(y.Z.LabelSm,{weight:"normal",color:"text-default",children:(0,a.t)("paywall_checkout.form.tax_id.cta")})})}):null},rc=r(190920),rd=function(e){var t=e.children,r=e.value,o=e.className;return(0,n.jsx)(rc.E.Option,{value:r,className:function(e){var t=e.checked;return g()("bg-primary hover:border-secondary relative flex cursor-pointer justify-center rounded-xl border py-3 transition-colors focus:outline-none",{"border-secondary bg-secondary border-1":t,"border-primary":!t},o)},children:(0,n.jsx)("span",{className:"flex flex-row items-center space-x-2",children:t})})},rp=function(){var e,t=(0,c.Gc)(),r=t.control,u=t.setValue,s=(0,i.Y)(),p=s.getSelectedPrice,f=s.amountDue,m=p(),b=(null==m||null==(e=m.payable_payment_methods)?void 0:e.length)===1,v=f<l.eq.MINIMUM||f>l.eq.MAXIMUM;return((0,o.useEffect)(function(){(b||v)&&u("payment_method_type",l.Lt.CARD)},[b,f]),b||v)?null:(0,n.jsx)(c.Qr,{control:r,name:"payment_method_type",render:function(e){var t=e.field,r=t.onChange,o=t.value;return(0,n.jsx)(rc.E,{value:o,onChange:r,children:(0,n.jsxs)("div",{className:"flex flex-row space-x-4",children:[(0,n.jsxs)(rd,{value:l.Lt.CARD,className:"basis-1/2",children:[(0,n.jsx)(d.JO,{type:"credit-card",size:16}),(0,n.jsx)(y.Z.LabelMd,{children:(0,a.t)("paywall_checkout.payment_method_type.card")})]}),(0,n.jsxs)(rd,{value:l.Lt.PIX,className:"basis-1/2",children:[(0,n.jsx)(d.JO,{type:"20-pix",viewBox:"0 0 24 24",size:24}),(0,n.jsx)(y.Z.LabelMd,{children:(0,a.t)("paywall_checkout.payment_method_type.pix")})]})]})})}})},rf=r(146422),rm=r.n(rf),ry=function(){return(0,n.jsx)(rF.Item,{name:"business_name",optional:!0,children:(0,n.jsx)(O,{type:"text",name:"community_member_billing_info_attributes[business_name]",options:{maxLength:200}})})},rb=function(e){var t=e.name,r=e.addon,o=e.className,i=e.childClassName,l=e.children,s=e.optional,c=e.LabelComponent,d=void 0===c?y.Z.LabelSm:c,p=e["data-testid"];return(0,n.jsxs)("div",{className:(0,u.A)(o,"flex flex-col"),"data-testid":p,children:[(0,n.jsxs)("div",{className:(0,u.A)(i,"mb-1 flex flex-row items-center"),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,n.jsx)(d,{weight:"semibold",children:a.ZP.t("paywall_checkout.form.fields.".concat(t))}),s&&(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(y.Z.LabelSm,{weight:"normal",color:"text-light",children:"(".concat(a.ZP.t("paywall_checkout.form.fields.optional"),")")})]})]}),r]}),l]})},rv=function(){return(0,n.jsx)(rb,{name:"name",children:(0,n.jsx)(O,{type:"text",name:"name",options:{required:!0}})})},rh=r(385972),r_=r(953337),rw=r(822993),rg=function(){var e=(0,rh.Jd)(),t=e.isAddressElementRequired,r=e.isMemberAddressComplete,a=e.memberAddress,i=e.memberName,l=e.setMemberAddress,u=(0,o.useMemo)(function(){return a&&a.country?{address:{city:a.city,country:a.country,line1:a.line1,line2:a.line2,postalCode:a.postalCode,state:a.state},name:a.name||i}:{}},[a,i]),s=(0,rw.B)(),c=(0,r_.X)(),d=R.I7.billing,p=(0,o.useMemo)(function(){return{defaultValues:u,display:s,fields:c,mode:d}},[u,s,c,d]),f=(0,o.useCallback)(function(e){var t=e.value.address||{};l({city:t.city||void 0,country:t.country||void 0,isComplete:e.complete,line1:t.line1||void 0,line2:t.line2||void 0,name:e.value.name||void 0,postalCode:t.postal_code||void 0,state:t.state||void 0})},[l]);return!t||r?null:(0,n.jsx)(E.AddressElement,{options:p,onChange:f})},rx=r(620895),rj=function(){var e=(0,i.Y)(),t=e.setMemberAddressAttributes,r=e.currentUser,a=e.memberBillingInfo,l=R.I7.billing,u=(0,rx.u)({billingInfo:a,name:(0,B.q)(r)}),s=(0,r_.X)(),c=(0,rw.B)(),d=(0,o.useMemo)(function(){return{mode:l,defaultValues:u,fields:s,display:c}},[l,u,s,c]);return(0,n.jsx)(E.AddressElement,{options:d,onChange:t})},rO=function(){return(0,i.Y)().isUpsellsEnabled?(0,n.jsx)(rg,{}):(0,n.jsx)(rj,{})};let rP=r.p+"static/images/paywalls/payment-form-desktop-96eca658a6c63cf0.png",rS=r.p+"static/images/paywalls/payment-form-mobile-0db9dd043640c20c.png",rk=r.p+"static/images/paywalls/payment-form-tablet-96eca658a6c63cf0.png";var rI=function(){return(0,o.useMemo)(function(){return{billingDetails:{name:"never",address:"auto"}}},[])},rC=function(){return(0,o.useMemo)(function(){return{card:"never",googlePay:"never",applePay:"never"}},[])},rE=function(){return{type:R.jw.accordion,radios:!0}},rN=function(){var e=(0,rh.Jd)(),t=e.communityId,r=e.isExpressMode,a=e.memberAddress,i=e.memberEmail,l=e.memberId,u=e.memberName,s=e.paywallPriceId,c=e.sessionStepId,d=e.setIsPaymentMethodLoaded,p=e.setIsMemberUsingDefaultPaymentMethod,f=e.setIsPaymentElementReady,m=e.setIsPaymentMethodComplete,y=e.setPaymentMethodType,b=(0,o.useMemo)(function(){var e={};return e.email=i,e.name=a.name||u,e.address={city:a.city,country:a.country,line1:a.line1,line2:a.line2,postal_code:a.postalCode,state:a.state},{billingDetails:e}},[a,i,u]),v=rI(),h=rE(),_=rC(),w=(0,o.useMemo)(function(){return{defaultValues:b,fields:v,terms:_,layout:h}},[b,v,h,_]),g=(0,o.useCallback)(function(e){var t,r;d(!0),p(!!(null==(r=e.value)||null==(t=r.payment_method)?void 0:t.id)),m(e.complete),y(e.value.type)},[d,p,m,y]),x=(0,o.useCallback)(function(e){var r=T.K.fromStripeError("PaywallsCheckoutAttemptsPaymentElement.onLoadError",e.error);(0,M.M)(r,{caller:r.caller,extra:r.getExtra(),communityId:t,communityMemberId:l,paywallPriceId:s,sessionStepId:c})},[t,l,s,c]),j=(0,o.useCallback)(function(e){f(!0),l&&!r&&e.focus()},[r,l,f]);return(0,n.jsx)(E.PaymentElement,{options:w,onChange:g,onLoadError:x,onReady:j})},rA=function(){var e=(0,c.Gc)().watch,t=(0,i.Y)(),r=t.currentUser,n=t.memberBillingInfo,a=e("email"),l=e("name");return(0,o.useMemo)(function(){var e,t,o={};return o.email=null!=(e=null==r?void 0:r.email)?e:a,o.name=null!=(t=(0,B.q)(r))?t:l,(null==n?void 0:n.address_country)&&(o.address={line1:n.address_line1,line2:n.address_line2||void 0,city:n.address_city,state:n.address_state,postal_code:n.address_postal_code,country:n.address_country}),{billingDetails:o}},[r,n,a,l])},rT=function(){var e=rA(),t=rI(),r=rC(),a=rE(),i=(0,o.useMemo)(function(){return{defaultValues:e,fields:t,terms:r,layout:a}},[e,t,a,r]),l=eS(),u=l.handleOnChangeCard,s=l.handleOnReadyCard,c=l.onLoadError;return(0,n.jsx)(E.PaymentElement,{options:i,onChange:u,onReady:s,onLoadError:c})},rM=function(){var e=(0,i.Y)(),t=e.isUpsellsEnabled,r=e.getSelectedPrice,o=e.checkoutPreviewContext,l=r(),u=!!o;return(0,n.jsxs)(rb,{name:"payment",childClassName:"!mb-4",LabelComponent:y.Z.TitleSm,addon:l.trial_enabled&&(0,n.jsx)("span",{className:"inline-flex",children:(0,n.jsx)(f.T,{className:"inline-flex",content:a.ZP.t("paywall_checkout.payment_subtitle_tooltip"),children:(0,n.jsx)(d.JO,{type:"12-question-mark",size:12,color:"text-primary"})})}),"data-testid":"checkout-form-payment-methods-field-wrapper",children:[u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:rP,alt:"",loading:"lazy",className:"hidden lg:block"}),(0,n.jsx)("img",{src:rk,alt:"",loading:"lazy",className:"hidden sm:block lg:hidden"}),(0,n.jsx)("img",{src:rS,alt:"",loading:"lazy",className:"sm:hidden"})]}),!u&&(t?(0,n.jsx)(rN,{}):(0,n.jsx)(rT,{}))]})},rD=r(659395),rL=function(){var e=(0,c.Gc)().watch,t=(0,i.Y)(),r=t.paywall,n=t.getSelectedPrice,a=t.couponPreviewMutation,u=n(),s=(0,l.Lf)(e("payment_method_type")),d=(0,b._j)(u.id,a);return(0,o.useMemo)(function(){var e,t,n,o;return!s&&(0,rD.E)({doesOfferHaveTrial:null!=(e=u.trial_enabled)&&e,doesOrderHaveFullForeverDiscount:null!=(t=null==d?void 0:d.free_forever)&&t,doesTrialRequirePaymentMethod:null!=(n=r.trial_requires_card)&&n,doesTrialRequireUpfrontPayment:null!=(o=u.trial_requires_upfront_payment)&&o})},[null==d?void 0:d.free_forever,s,r.trial_requires_card,u.trial_enabled,u.trial_requires_upfront_payment])},rR=function(){var e=(0,i.Y)(),t=e.currentUser,r=e.isMemberAddressRequired,o=e.memberBillingInfo,a=e.stripePaymentMethodType,u=rL(),s=!t||rm()(o)||!(null==o?void 0:o.address_complete),c=(r||(0,l.wO)(a))&&s,d=!(null==o?void 0:o.business_name);return(0,n.jsxs)(n.Fragment,{children:[u&&(0,n.jsx)(rM,{}),c&&(0,n.jsx)(rO,{}),!c&&!t&&(0,n.jsx)(rv,{}),d&&(0,n.jsx)(ry,{})]})},rU=function(){var e=(0,i.Y)().isUpsellsEnabled,t=eS(),r=t.onSubmit,n=t.isSubmitDisabled,o=(0,rh.qm)();if(e&&!o)throw Error("useCheckoutSubmit: isUpsellsEnabled is true but PaywallCheckoutAttemptsProvider not found");return{submit:e&&o?o.submitAttempt:r,isSubmitDisabled:n}},rF=Object.assign(Object.assign(function(e){var t=e.className,r=(0,c.Gc)().handleSubmit,o=(0,i.Y)(),l=o.isProcessingPayment,s=o.authProviderProperties,p=o.checkoutPreviewContext,f=o.isPaywallsCheckoutWithoutInternalResourcesEnabled,y=o.currentCommunity,b=eS(),v=b.payButtonLabel,h=b.stripe,w=rU(),g=w.submit,x=w.isSubmitDisabled,j=(0,C.a7)();return(null==s?void 0:s.is_sso_authentication_required)?null:(0,n.jsxs)(eC.s,{className:(0,u.A)("flex h-auto w-full flex-col items-center lg:items-start",t,{"pb-6":!!p}),dataTestId:"paywall-checkout-right-column",children:[(0,n.jsx)(ek.i.CommunityHeader,{className:"hidden lg:invisible lg:block",community:y}),l&&(0,n.jsx)(_.a,{variant:"fullscreen",message:(0,a.t)("paywalls.checkout.bnpl_processing")}),(0,n.jsxs)("form",{className:"flex flex-col gap-y-6",onSubmit:r(g),"data-testid":"checkout-form",children:[(0,n.jsx)(rF.Alerts,{className:"hidden lg:block",shouldFocus:!0}),(0,n.jsx)(t9,{}),(0,n.jsxs)(eN.g,{className:"gap-y-5",children:[!f&&(0,n.jsx)(rp,{}),(0,n.jsx)(rR,{}),(0,n.jsx)(rs,{})]}),(0,n.jsx)(rF.Alerts,{className:"block lg:hidden"}),(0,n.jsxs)(eN.g,{className:"gap-y-5",children:[(0,n.jsx)(rr,{}),(0,n.jsxs)(m.z,{type:"submit",extraLarge:!0,variant:"circle",disabled:!h||x||l,"data-testid":"checkout-form-submit-button",className:"flex flex-row items-center justify-center gap-x-2",children:[(0,n.jsx)(d.JO,{size:20,type:"20-lock"}),v]})]})]}),(0,n.jsx)(eI.p,{shouldHide:j})]})},{Skeleton:function(e){var t=e.className;return(0,n.jsxs)(eC.s,{className:(0,u.A)("flex h-auto w-full flex-col items-center lg:items-start",t),dataTestId:"paywall-checkout-right-column",children:[(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0,className:"!h-[2.5rem] lg:!h-10 my-[1.625rem] md:my-[2.625rem] !w-full lg:!w-1/2 hidden lg:invisible lg:block"}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-6",children:[(0,n.jsx)(t9.Skeleton,{}),(0,n.jsxs)(eN.g,{className:"gap-y-5",children:[(0,n.jsx)(t7.X2,{square:!0,half:!0,xl:!0}),(0,n.jsxs)("div",{className:"flex flex-col border-primary shadow-xs rounded-xl border bg-primary p-6 gap-y-4",children:[(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0}),(0,n.jsx)(t7.X2,{full:!0}),(0,n.jsxs)("div",{className:"w-full flex flex-col gap-y-2",children:[(0,n.jsx)(t7.X2,{half:!0}),(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0})]}),(0,n.jsxs)("div",{className:"flex flex-row gap-x-3",children:[(0,n.jsxs)("div",{className:"w-full flex flex-col gap-y-2",children:[(0,n.jsx)(t7.X2,{half:!0}),(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0})]}),(0,n.jsxs)("div",{className:"w-full flex flex-col gap-y-2",children:[(0,n.jsx)(t7.X2,{half:!0}),(0,n.jsx)(t7.X2,{square:!0,full:!0,x2l:!0})]})]})]})]}),(0,n.jsxs)(eN.g,{className:"gap-y-2",children:[(0,n.jsx)(t7.X2,{full:!0}),(0,n.jsx)(t7.X2,{square:!0,x2l:!0,full:!0})]})]})]})}}),{Item:function(e){var t=e.name,r=e.addon,o=e.className,i=e.childClassName,l=e.children,s=e.optional,c=e.LabelComponent,d=void 0===c?y.Z.LabelSm:c;return(0,n.jsxs)("div",{className:(0,u.A)(o,"flex flex-col"),children:[(0,n.jsxs)("div",{className:(0,u.A)(i,"mb-1 flex flex-row items-center"),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,n.jsx)(d,{weight:"semibold",children:a.ZP.t("paywall_checkout.form.fields.".concat(t))}),s&&(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(y.Z.LabelSm,{weight:"normal",color:"text-light",children:"(".concat(a.ZP.t("paywall_checkout.form.fields.optional"),")")})]})]}),r]}),l]})},PricePreview:I.F,CouponForm:function(e){var t=e.className,r=e.shouldHideCoupon,o=e.useHooks,a=(void 0===o?k:o)(),i=a.couponPreviewMutation,l=a.areCouponsEnabled,s=a.applyCoupon;return!l||void 0!==r&&r?null:i.isSuccess?(0,n.jsx)("div",{className:(0,u.A)("flex flex-col gap-y-3"),children:(0,n.jsx)(h,{})}):(0,n.jsx)("div",{className:(0,u.A)("flex w-full flex-col gap-y-2",t),children:(0,n.jsx)(P,{applyCoupon:s})})},Alerts:function(e){var t=e.className,r=e.shouldFocus,c=(0,i.Y)(),d=c.paywall,p=c.communityRootUrl,f=c.hasAlreadyPurchased,m=c.paymentError,y=c.paywallFailure,b=c.isPerformingVerification,v=(0,o.useRef)(null),h="",_="";return((0,l.y9)(f,d)?(h="warning",_=(0,a.t)("services.paywalls.failures.paywall.already_purchased",{billing_url:"".concat(p).concat(s.G3.billing.slice(1))})):y?(h=y.level,_=y.message):m&&m.message&&(h=m.type,_=m.message),(0,o.useEffect)(function(){if(r&&v&&_){var e;null==(e=v.current)||e.scrollIntoView({behavior:"smooth"})}},[_,r]),!b&&h&&_)?(0,n.jsx)("div",{ref:v,className:(0,u.A)("rounded-lg border px-6 py-5",t,{"border-red-500 bg-red-50 text-red-800":"danger"===h,"border-yellow-500 bg-yellow-50 text-yellow-800":"warning"===h}),dangerouslySetInnerHTML:{__html:_},"data-testid":"checkout-alert"}):null}})},186177:function(e,t,r){r.d(t,{s:()=>a});var n=r(683551),o=r(645391),a=function(e){var t=e.children,r=e.className,a=e.wrapperClassName,i=e.dataTestId;return(0,n.jsx)("div",{className:(0,o.A)("w-full",r),"data-testid":i,children:(0,n.jsx)("div",{className:(0,o.A)("w-full sm:max-w-[540px]",a),children:t})})}},596878:function(e,t,r){r.d(t,{u:()=>ee});var n=r(683551),o=r(640792),a=r(645391),i=r(314121),l=r(714844),u=r(564514),s=r(100334),c=r(672842),d=r(61146),p=r(718215),f=r(280658),m=r(849375),y=r(705206),b=r(600651),v=r(357382),h=r(904812),_=function(){var e=(0,h.Ph)("invoice")||"",t=(0,h.Ph)("payment_intent")||"";return{invoiceId:e,paymentIntentId:t,paymentMethodType:(0,h.Ph)("payment_method_type")||"",wasForwarded:!!(0,h.Ph)("forwarded"),isVerifiable:!!t||!!e}},w=r(955970),g=r(246249),x=r(722024),j=r(81812);function O(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function P(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){O(a,n,o,i,l,"next",e)}function l(e){O(a,n,o,i,l,"throw",e)}i(void 0)})}}function S(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var k=function(){var e=(0,o.Y)(),t=e.checkoutConfirmationUrl,r=e.handleError,a=e.isPerformingVerification,h=e.setIsPerformingVerification,O=(0,w.i)().session,k=(0,x.wh)().currentCommunitySettings,I=(0,u.k6)(),C=(0,u.UO)().checkoutPath,E=_(),N=E.invoiceId,A=E.paymentIntentId,T=E.paymentMethodType,M=E.wasForwarded,D=function(){var e=new URL(window.location.href);e.searchParams.delete("forwarded"),e.searchParams.delete("invoice"),e.searchParams.delete("payment_intent_client_secret"),e.searchParams.delete("payment_intent"),e.searchParams.delete("payment_method_type"),e.searchParams.delete("redirect_status"),window.history.replaceState({},"",e)},L=(0,l.useMutation)(function(){return b.k.verifications.create({invoice_id:N,payment_intent_id:A,payment_method_type:T})}),R=function(){return P(function(){var e,t;return S(this,function(r){var n,o;switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L.mutateAsync()];case 1:if(!(e=r.sent())||(void 0===e?"undefined":e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)!="object")return[2,{failure:{message:c.PC}}];if("failure"in e)return[2,e];if("checkout_attempt_status"in e){if((0,m.wZ)(e.checkout_attempt_status))return[2,null];return[2,e]}return[3,3];case 2:if(n=t=r.sent(),null!=(o=p.M)&&"undefined"!=typeof Symbol&&o[Symbol.hasInstance]?!!o[Symbol.hasInstance](n):n instanceof o)return[2,t.body];return(0,f.dD)(t),[2,{failure:{message:t.message||c.PC}}];case 3:return[2]}})})()},U=function(e){var t=e||c.PC;if(!M&&((0,y.LZ)(T)||(0,y.Vr)(T))){var n=new URL(window.location.href);n.searchParams.append("forwarded","true"),window.location.replace(n.toString());return}setTimeout(function(){r({message:t,disablePayButton:!1}),h(!1),D()},2e3)},F=function(e){if(null===e)return void B();if("failure"in e){var r;U((null==e||null==(r=e.failure)?void 0:r.message)||null);return}if(V(e)){if((null==k?void 0:k.paywall_upsells_enabled)&&C){var n=(0,g.Q0)(null==O?void 0:O.steps);if(n)return void I.push((0,j.QZ)(C,n.id));if(O)return void I.push((0,j.UZ)(C,O.id))}(0,d.yy)(e,t);return}U(null)},V=function(e){return"checkout_attempt_status"in e&&((0,m.N2)(e.checkout_attempt_status)||(0,m.wF)(e.checkout_attempt_status))},B=function(){r({message:c.PC,disablePayButton:!1}),h(!1),D()};return((0,i.useEffect)(function(){P(function(){return S(this,function(e){switch(e.label){case 0:if(!A&&!N)return[2];h(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(0,d.Tm)({executor:R})];case 2:return F(e.sent()),[3,4];case 3:return e.sent(),U(null),[3,4];case 4:return[2]}})})()},[A,N]),a)?(0,n.jsx)(v.a,{variant:"fullscreen",message:(0,s.t)("paywalls.checkout.bnpl_processing")}):null},I=function(){return(0,o.Y)().isUpsellsEnabled?null:(0,n.jsx)(k,{})},C=r(758702),E=r(512451),N=r(379720),A=r(870879),T=r(189713),M=r(186177),D=function(e){var t=e.className,r=(0,o.Y)(),i=r.currentCommunity,l=r.loginRedirectUrl,u=r.authProviderProperties;return(null==u?void 0:u.is_sso_authentication_required)?(0,n.jsxs)(M.s,{className:(0,a.A)("flex size-full flex-col items-center text-center lg:h-auto lg:items-start",t),wrapperClassName:"h-full lg:pt-20 flex flex-col items-center",children:[(0,n.jsx)(C.i.CommunityHeader,{className:"lg:invisible lg:block",community:i}),(0,n.jsx)("div",{className:"flex h-full items-center justify-center lg:h-auto",children:(0,n.jsxs)("div",{className:"flex max-w-[24rem] flex-col gap-y-8",children:[i.icon_url&&(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("img",{loading:"lazy",className:"w-[4rem]",src:i.icon_url,alt:""})}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,n.jsx)(T.Z.TitleMd,{children:(0,s.t)("paywall_checkout.sso_login_prompt.title")}),(0,n.jsx)(T.Z.BodyMd,{color:"text-default",children:(0,s.t)("paywall_checkout.sso_login_prompt.subtitle",{community_name:i.name})})]}),(0,n.jsx)("div",{className:"flex flex-row justify-center",children:(0,n.jsx)("a",{href:l,children:(0,n.jsx)(A.z,{variant:"circle",large:!0,children:(0,s.t)("paywall_checkout.sso_login_prompt.call_to_action",{auth_provider_name:u.name})})})}),(0,n.jsx)(T.Z.LabelXs,{color:"text-default",children:(0,s.t)("paywall_checkout.sso_login_prompt.note")})]})})]}):null},L=function(e){var t=e.children,r=e.className;return(0,n.jsx)("div",{className:(0,a.A)("flex h-full flex-col",r),children:t})},R=function(e){var t=e.children,r=e.className,o=e.dataTestId;return(0,n.jsx)("div",{className:(0,a.A)("flex w-full flex-col lg:grid lg:grid-cols-2",r),"data-testid":o,children:t})},U=r(763536),F=r(557273),V=r(396335),B=r(599631),q=r(227984),Z=function(){var e,t=(0,o.Y)(),r=t.currentCommunityProcessorPaymentMethodConfigurationId,n=t.currentCommunityMemberPaymentProcessorSessionClientSecret,a=t.paywall,l=t.getSelectedPrice,u=t.previewMutation,s=a.currency.code,c=l(),d=u.data,p=(0,q.J)(c,d);return e=0===p?B.hX.setup:B.hX.payment,(0,i.useMemo)(function(){return{appearance:V.RY,paymentMethodConfiguration:r,customerSessionClientSecret:n,mode:e,currency:s,amount:p}},[r,n,e,s,p])},z=function(e){var t=e.children,r=(0,o.Y)(),a=r.processorId,l=r.processorKey,u=r.setStripeElementsMode,s=(0,i.useMemo)(function(){return(0,F.O)({stripeAccountId:a,stripePublicKey:l,locale:window.locale})},[a,l]),c=Z(),d=c.mode;return(0,i.useEffect)(function(){d&&u(d)},[u,d]),(0,n.jsx)(U.Elements,{stripe:s,options:c,children:t})},W=r(244289),H=r(213070),G=r(659395),K=r(815791),X=r(346752),Y=r(333557),Q=function(e){var t,r,a,l,u,s,c=e.children,p=(0,W.Gc)(),f=p.setValue,m=(0,p.watch)("email"),y=(0,X.V)().handleCheckoutError,b=(0,w.i)().session,v=(0,o.Y)(),h=v.couponPreviewMutation,_=v.currentCommunity,g=v.currentCommunityMember,x=v.currentCommunityMemberPaymentProcessorSessionClientSecret,j=v.currentCommunityProcessorPaymentMethodConfigurationId,O=v.currentUser,P=v.getSelectedPrice,S=v.isLinkPreferenceEnabled,k=v.isMemberAddressRequired,I=v.isMemberWithSavedPaymentMethods,C=v.memberBillingInfo,E=v.paywall,N=v.previewMutation,A=v.processorId,T=v.processorKey,M=v.sessionStepId,D=v.setIsCardInfoComplete,L=v.setIsMemberUsingSavedPaymentMethod,R=v.setIsProcessingPayment,U=v.setStripePaymentMethodType,F=v.checkoutConfirmationUrl,V=(0,K.R)().goToNextStep,B=P(),Z=N.data,z=(0,q.J)(B,Z),Q=E.currency.code.toLowerCase(),$=E.currency.min_charge_amount,J=B.id,ee={communityId:_.id,communityProcessorId:A,communityProcessorKey:T,communityProcessorPaymentMethodConfigurationId:j,doesCommunityProcessorSupportsLink:S},et={doesMemberHasDefaultPaymentMethod:I,isMemberAddressComplete:(null==C?void 0:C.address_complete)||!1,memberAddressCity:null==C?void 0:C.address_city,memberAddressCountry:null==C?void 0:C.address_country,memberAddressLine1:null==C?void 0:C.address_line1,memberAddressLine2:(null==C?void 0:C.address_line2)||void 0,memberAddressPostalCode:null==C?void 0:C.address_postal_code,memberAddressState:null==C?void 0:C.address_state,memberEmail:(null==O?void 0:O.email)||m,memberId:null==g?void 0:g.id,memberName:(null==g?void 0:g.name)||(null==O?void 0:O.name),memberProcessorCustomerSessionClientSecret:x,memberUserId:null==O?void 0:O.id},er={orderCurrencyMinimumChargeAmount:$,orderAmount:z,orderCurrency:Q,paywallPriceId:J,sessionId:null==b?void 0:b.id,sessionStepId:M},en=(0,Y._j)(B.id,h),eo=(0,G.E)({doesOfferHaveTrial:null!=(a=B.trial_enabled)&&a,doesOrderHaveFullForeverDiscount:null!=(l=null==en?void 0:en.free_forever)&&l,doesTrialRequirePaymentMethod:null!=(u=E.trial_requires_card)&&u,doesTrialRequireUpfrontPayment:null!=(s=B.trial_requires_upfront_payment)&&s}),ea=(0,i.useCallback)(function(e){f("name",e.name),f("community_member_billing_info_attributes[address_line1]",e.line1),f("community_member_billing_info_attributes[address_line2]",e.line2),f("community_member_billing_info_attributes[address_city]",e.city),f("community_member_billing_info_attributes[address_state]",e.state),f("community_member_billing_info_attributes[address_postal_code]",e.postalCode),f("community_member_billing_info_attributes[address_country]",e.country),f("community_member_billing_info_address_attributes_complete",e.isComplete)},[f]),ei=(0,i.useCallback)(function(e){D(e.isComplete),U(e.paymentMethodType),L(e.isDefaultPaymentMethod),f("payment_method_type",e.paymentMethodType)},[D,L,U,f]),el=(0,i.useCallback)(function(e){var t=e.invoiceId,r=e.paymentIntentId,n=e.subscriptionId;R(!1),V()||(0,d.yy)({subscription_processor_id:n,payment_intent_processor_id:r,invoice_processor_id:t},F)},[F,V,R]),eu=(0,i.useCallback)(function(e){y(e.error),R(!1)},[y,R]),es=(0,i.useCallback)(function(){R(!0)},[R]);return(0,n.jsx)(H.a,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},ee,et,er),r=r={isMemberAddressRequired:k,isPaymentMethodRequired:eo,onAddressChange:ea,onComplete:el,onError:eu,onPaymentMethodChange:ei,onProgress:es,children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t))},$=function(e){var t=e.children;return(0,o.Y)().isUpsellsEnabled?(0,n.jsx)(Q,{children:t}):(0,n.jsx)(z,{children:t})},J=r(985086),ee=Object.assign(function(){var e=(0,o.Y)().authProviderProperties;return(0,n.jsxs)(L,{children:[!(null==e?void 0:e.is_sso_authentication_required)&&(0,n.jsx)(N.F,{variant:"mobile_fixed_on_top"}),(0,n.jsxs)(R,{className:(0,a.A)("bg-primary h-full gap-y-6 *:px-5 md:gap-y-10 md:pt-0",{"pt-12 *:lg:pt-0":!(null==e?void 0:e.is_sso_authentication_required)}),dataTestId:"paywall-checkout-container",children:[(0,n.jsx)(C.i,{className:"!bg-secondary pb-8 md:pb-10 xl:pr-28"}),(0,n.jsx)(D,{className:"xl:pl-28"}),(0,n.jsx)($,{children:(0,n.jsx)(E.d,{className:"bg-primary pb-8 xl:pl-28"})})]}),(0,n.jsx)(I,{})]})},{Skeleton:function(){return(0,n.jsxs)(L,{children:[(0,n.jsx)(J.U.Skeleton,{}),(0,n.jsxs)(R,{className:(0,a.A)("bg-primary h-full gap-y-6 *:px-5 md:gap-y-10 md:pt-0"),dataTestId:"paywall-checkout-container",children:[(0,n.jsx)(C.i.Skeleton,{className:"!bg-secondary pb-8 md:pb-10 xl:pr-28"}),(0,n.jsx)(E.d.Skeleton,{className:"bg-primary pb-8 xl:pl-28"})]})]})}})},256826:function(e,t,r){r.d(t,{BD:()=>l,YH:()=>a,z8:()=>i});var n="!bg-blue-100 py-1 px-2",o="!text-blue-800 font-medium",a={trial_then_value:{labelLocale:"price_badge",className:n,labelClassName:o},trial_then_upfront_then_value:{labelLocale:"price_badge",className:n,labelClassName:o},upfront_then_trial_then_value:{labelLocale:"price_badge",className:"!bg-tertiary text-dark px-2 py-1",labelClassName:"!text-primary font-medium"},value:null,upfront_then_value:null},i={trial_then_value:{labelLocale:"free_trial",className:n,labelClassName:o},trial_then_upfront_then_value:{labelLocale:"free_trial",className:n,labelClassName:o},upfront_then_trial_then_value:{labelLocale:"paid_trial",className:"!bg-tertiary text-dark px-2 py-1",labelClassName:"!text-primary font-medium"},value:null,upfront_then_value:null},l={trial_then_value:{labelLocale:"free_trial",className:n,labelClassName:o},trial_then_upfront_then_value:{labelLocale:"free_trial",className:"!bg-blue-100 py-1  px-2",labelClassName:o},upfront_then_trial_then_value:null,value:null,upfront_then_value:null}},507154:function(e,t,r){r.d(t,{f:()=>l});var n=r(683551),o=r(100334),a=r(645391),i=r(263229),l=function(e){var t=e.price,r=e.preview,l=e.properties;if(!t&&!r)return null;var u=l[(null==t?void 0:t.scenario)||(null==r?void 0:r.preview_scenario)||"value"];return u?(0,n.jsx)(i.g,{label:(0,o.t)([u.labelLocale],{count:null==t?void 0:t.trial_days}),className:(0,a.A)("rounded-md border-0",u.className),labelClassName:u.labelClassName,textSizeClassName:"text-xs"}):null}},448045:function(e,t,r){r.d(t,{o:()=>E});var n=r(683551),o=r(314121),a=r(501482),i=r(714844),l=r(241394),u=r(453079),s=r(169530),c=r(590507),d=r(244289),p=r(640792),f=r(967561),m=r(5735),y=r(904812),b=r(227984),v=function(e){var t,r=e.paywall,n=(0,y.Ph)("price_id");if(n){var o=parseInt(n,10);isNaN(o)||(t=o)}return(0,b.r)(r,t)},h=function(e,t,r,n){var o,a=(o=null==n?void 0:n.address_country)?o:e&&"brl"===t?f.n.br:void 0;return{address_city:null==n?void 0:n.address_city,address_complete:r,address_country:a,address_line1:null==n?void 0:n.address_line1,address_line2:null==n?void 0:n.address_line2,address_postal_code:null==n?void 0:n.address_postal_code,address_state:null==n?void 0:n.address_state,business_name:null==n?void 0:n.business_name,tax_id_type:null==n?void 0:n.tax_id_type,tax_id_value:null==n?void 0:n.tax_id_value}},_=function(e){var t,r=e.currentCommunity,n=e.currentUser,o=e.isMemberAddressComplete,a=e.isBrazilianAccountAndProcessorStripeBr,i=e.memberBillingInfo,l=e.paywall,u=v(e);return(0,d.cI)({defaultValues:{community_id:r.id,paywall_price_id:u.id,user_id:null==n?void 0:n.id,email:null==n?void 0:n.email,name:(0,m.q)(n),payment_method_type:"card",coupon_code_applied:!1,community_member_billing_info_attributes:h(a,null==l||null==(t=l.currency)?void 0:t.code,o,i),community_member_billing_info_address_attributes_complete:o}})},w=r(646193),g=r(595348);function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function j(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var O=function(e){var t,r=e.children,o=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,["children"]),a=_(o);return(0,n.jsx)(c._,{checkoutProps:o,children:(0,n.jsx)(d.RV,j(x({},a),{children:(0,n.jsx)(p.G,j(x({},o),{children:(0,n.jsx)(g.m,{children:(0,n.jsx)(w.p.Provider,{paywallCustomization:null==o||null==(t=o.paywall)?void 0:t.paywall_customization,checkoutPreviewContext:null==o?void 0:o.checkoutPreviewContext,children:r})})}))}))})},P=r(308085),S=function(e){var t=e.paywall;return(0,P.u)(t)};function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function I(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function C(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var E=Object.assign(function(e){var t=e.children,r=C(e,["children"]),c=(0,o.useMemo)(function(){return new i.QueryClient(u.V)},[]),d=S(r);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.q,{children:(0,n.jsx)("title",{children:d})}),(0,n.jsx)(l.hk,{children:(0,n.jsx)(i.QueryClientProvider,{client:c,children:(0,n.jsx)(s.VW,{children:(0,n.jsx)(O,I(k({},r),{children:t}))})})})]})},{Preview:function(e){var t=e.children,r=C(e,["children"]);return(0,n.jsx)(l.hk,{children:(0,n.jsx)(O,I(k({},r),{children:t}))})}})},391745:function(e,t,r){r.d(t,{M:()=>a});var n=r(280658),o=r(919742),a=function(e,t){var r,a,i={checkout:(r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},t.extra),a=a={caller:t.caller,community_id:t.communityId,community_member_id:t.communityMemberId,community_member_user_id:t.communityMemberUserId,paywall_id:t.paywallId,paywall_price_id:t.paywallPriceId,session_step_id:t.sessionStepId,stripe_elements_mode:t.stripeElementsMode,stripe_payment_method_type:t.stripePaymentMethodType,url:window.location.href},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(a)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))}),r)};(0,n.dD)(e,i),(0,o.aD)()&&console.error(e,t)}},955970:function(e,t,r){r.d(t,{l:()=>j,i:()=>O});var n=r(683551),o=r(314121),a=r(714844),i=r(100334),l=r(547550),u=r(192918),s=r(637261);function c(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var d=function(){var e=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:function(e){var t;return(t=function(){var t;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(r){return t=u.c.create(),[2,(0,l.Cu)(t,{checkout_session:{paywall_id:e.paywallId,referrer:e.referrer,event_id:e.eventId}})]})},function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function i(e){c(a,n,o,i,l,"next",e)}function l(e){c(a,n,o,i,l,"throw",e)}i(void 0)})})()},onSuccess:function(t,r){(0,s.m)(e,r.paywallId,t)},retry:3})},p=r(922612);function f(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}var m=function(e){var t=e.paywallId,r=e.sessionId,n=e.stepId,o=e.paymentValidationParams;return(0,a.useQuery)({queryKey:(0,p.H)(null!=t?t:0),queryFn:function(){var e;return(e=function(){var e;return function(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}(this,function(a){if(!t)throw Error("paywallId is required");return e=u.c.show({paywallId:t,sessionId:r||void 0,stepId:n||void 0,paymentIntentId:null==o?void 0:o.paymentIntentId,invoiceId:null==o?void 0:o.invoiceId}),[2,(0,l.UT)(e)]})},function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){f(a,n,o,i,l,"next",e)}function l(e){f(a,n,o,i,l,"throw",e)}i(void 0)})})()},enabled:!!t&&(!!r||!!n),refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,refetchOnReconnect:!1})},y=r(769487),b=r(904812),v=r(722024),h=function(e){var t,r,n=e.session,o=(0,v.wh)(),a=o.currentUser,i=o.currentCommunityMember,l=o.currentCommunitySettings;if(!(null==l?void 0:l.paywall_upsells_enabled))return{isSessionOwnershipValid:!0};var u=!!a&&!!(null==n?void 0:n.user)&&a.id!==(null==(t=n.user)?void 0:t.id),s=!!i&&!!(null==n?void 0:n.community_member)&&i.id!==(null==(r=n.community_member)?void 0:r.id);return{isSessionOwnershipValid:!u&&!s}};function _(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function w(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){_(a,n,o,i,l,"next",e)}function l(e){_(a,n,o,i,l,"throw",e)}i(void 0)})}}function g(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var x=(0,o.createContext)(void 0);x.displayName="CheckoutSessionContext";var j=function(e){var t=e.children,r=e.paywallId,l=e.sessionId,u=e.stepId,s=e.paymentValidationParams,c=(0,a.useQueryClient)(),f=d(),v=f.mutateAsync,_=f.isLoading,j=f.error,O=m({paywallId:r,sessionId:l,stepId:u,paymentValidationParams:s}),P=O.data,S=O.isFetching,k=O.error,I=O.refetch,C=!!u||!!l,E=c.getQueryData((0,p.H)(r))||P,N=C?S:_,A=C?k:j,T=(0,o.useCallback)(function(){return w(function(){return g(this,function(e){switch(e.label){case 0:if(!C)return[3,2];return[4,I()];case 1:e.sent(),e.label=2;case 2:return[2]}})})()},[C,I]),M=(0,o.useCallback)(function(){return w(function(){var e;return g(this,function(t){switch(t.label){case 0:if(!r)return[3,2];return e=(0,b.Ph)("event_id"),[4,v({paywallId:r,referrer:globalThis.location.href,eventId:e?parseInt(e):void 0})];case 1:t.sent(),t.label=2;case 2:return[2]}})})()},[r,v]);(0,o.useEffect)(function(){if(!C&&r&&!E&&!N){var e=(0,b.Ph)("event_id");v({paywallId:r,referrer:globalThis.location.href,eventId:e?parseInt(e):void 0})}},[C,r,E,N,v]);var D=(0,o.useMemo)(function(){var e;return{session:E||null,isLoading:N,error:(null!=(e=Error)&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](A):A instanceof e)?A:null,refetchSession:T,refreshSession:M}},[E,N,A,T,M]),L=h({session:E}).isSessionOwnershipValid;return!A&&(N||E)&&L?(0,n.jsx)(x.Provider,{value:D,children:t}):(0,n.jsx)(y.Z,{errorCode:500,title:(0,i.t)("paywall_checkout.error_boundary.title")})},O=function(){var e=(0,o.useContext)(x);return void 0===e?{session:null,isLoading:!1,error:null,refetchSession:function(){return w(function(){return g(this,function(e){return[2]})})()},refreshSession:function(){return w(function(){return g(this,function(e){return[2]})})()}}:e}},308085:function(e,t,r){r.d(t,{r:()=>o,u:()=>n});var n=function(e){var t;return(null==e||null==(t=e.event)?void 0:t.name)?e.event.name:e.display_name},o=function(e){var t,r,n;return e.description?r=e.description:(null==(t=e.event)?void 0:t.body)&&(r=null==(n=e.event)?void 0:n.body),r}},165744:function(e,t,r){r.d(t,{fA:()=>a,sP:()=>i,w0:()=>o});var n=r(668774),o=function(e){return[n.l.pending,n.l.offered].includes(e.status)},a=function(e){return e.status===n.l.processing},i=function(e){return(null==e?void 0:e.status)===n.l.pending}},922612:function(e,t,r){r.d(t,{H:()=>n});var n=function(e){return["checkoutSession",e]}},637261:function(e,t,r){r.d(t,{m:()=>o});var n=r(922612),o=function(e,t,r){e.setQueryData((0,n.H)(t),r)}},5735:function(e,t,r){r.d(t,{q:()=>n});var n=function(e){var t;return(null==e?void 0:e.name)?t=e.name:((null==e?void 0:e.first_name)||(null==e?void 0:e.last_name))&&(t=[e.first_name,e.last_name].filter(function(e){return!!e}).join(" ").trim()),t}},61146:function(e,t,r){r.d(t,{Tm:()=>f,yy:()=>d,m5:()=>m});var n=r(547550),o=r(904812),a=r(600651),i=r(15921),l=r(678731);function u(e,t,r,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){r(e);return}l.done?t(u):Promise.resolve(u).then(n,o)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){u(a,n,o,i,l,"next",e)}function l(e){u(a,n,o,i,l,"throw",e)}i(void 0)})}}function c(e,t){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){var s=[l,u];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}}var d=function(e,t){var r,n,o=(null==e?void 0:e.subscription_processor_id)||(null==e?void 0:e.payment_intent_processor_id)||(null==e?void 0:e.invoice_processor_id),a="".concat(t).concat(o);return null==(n=window.webview)||null==(r=n.paymentSuccessful)||r.call(n,{redirect_url:a}),window.open(a,"_self")},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;return s(function(){return c(this,function(t){return[2,new Promise(function(t){return setTimeout(t,e)})]})})()},f=function(e){var t=e.retriesThreshold,r=void 0===t?30:t,n=e.sleepTimeInMilliseconds,o=void 0===n?2e3:n,a=e.executor;return s(function(){var e,t;return c(this,function(n){switch(n.label){case 0:e=null,t=0,n.label=1;case 1:if(!(t<r))return[3,5];return[4,a()];case 2:if(e=n.sent())return[3,5];return[4,p(o)];case 3:n.sent(),n.label=4;case 4:return t++,[3,1];case 5:return[2,e]}})})()},m=function(e,t,r){return s(function(){var u,s,f,y,b,v,h;return c(this,function(c){switch(c.label){case 0:var _;if(u=t.payment_intent_processor_id,s=t.invoice_processor_id,r>30)throw l.K.generic("useCard.verifyPayment.tries");return[4,(_=null!=u?u:s,(0,n.t5)(o.av.communityMemberCharge.show({processorId:_}),{method:"GET"}))];case 1:if(!((f=c.sent())&&f.ok))return[3,6];return[4,f.json()];case 2:if(y=c.sent(),!(0,i.Om)(y))return[3,6];return[4,a.k.complete(t)];case 3:if(!(!(b=c.sent())||!b.ok))return[3,5];return[4,null==b||null==(v=b.json)?void 0:v.call(b)];case 4:throw h=c.sent(),l.K.fromPaywallError("useCard.verifyPayment.complete",h);case 5:return[2,d(t,e)];case 6:return[4,p()];case 7:return c.sent(),[4,m(e,t,r+1)];case 8:return c.sent(),[2,void 0]}})})()}},346752:function(e,t,r){r.d(t,{V:()=>u});var n=r(314121),o=r(640792),a=r(391745),i=r(672842);function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}var u=function(){var e=(0,o.Y)(),t=e.currentCommunity,r=e.currentCommunityMember,u=e.currentUser,s=e.handleError,c=e.loginRedirectUrl,d=e.paywall,p=e.resetPasswordRedirectUrl,f=e.setPaywallFailure,m=e.stripeElementsMode,y=e.stripePaymentMethodType,b=(0,n.useMemo)(function(){return{communityId:null==t?void 0:t.id,communityMemberId:null==r?void 0:r.id,communityMemberUserId:null==u?void 0:u.id,paywallId:null==d?void 0:d.id,stripeElementsMode:m,stripePaymentMethodType:y}},[t,r,u,d,m,y]);return{handleCheckoutError:(0,n.useCallback)(function(e){if((0,a.M)(e,(t=l({},b),r=r={caller:e.caller,extra:e.getExtra()},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t)),e.isNewPaywallError())return void f(e.context.failure);var t,r,n={message:e.message,disablePayButton:!e.shouldAllowToResubmit};e.isLegacyPaywallError()&&(n=l({},n,(0,i.bE)(e.context,{loginUrl:c,resetPasswordRedirectUrl:p}))),s(n)},[b,s,c,p,f])}}},875621:function(e,t,r){r.d(t,{h:()=>i});var n=r(683551),o=r(596878),a=r(448045),i=function(e){var t,r,i=e.shouldUseWrapper,l=null==i||i?a.o:a.o.Preview;return(0,n.jsx)(l,(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),r=r={children:(0,n.jsx)(o.u,{})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t))}},83793:function(e,t,r){r.d(t,{D:()=>l,p:()=>i});var n=r(314121),o=r(763536),a=r(678731),i=function(){var e=(0,o.useStripe)(),t=(0,o.useElements)();return(0,n.useCallback)(function(){return t&&e?{stripe:e,stripeElements:t}:null},[e,t])},l=function(){var e=(0,o.useStripe)(),t=(0,o.useElements)();return(0,n.useCallback)(function(r){if(!t||!e)throw a.K.stripeNotInitialized(r);return{stripe:e,stripeElements:t}},[e,t])}},81812:function(e,t,r){r.d(t,{BC:()=>n,QZ:()=>a,UZ:()=>i,sM:()=>o});var n={MAIN_OFFER:"/checkout/:checkoutPath",OFFER:"/checkout/:checkoutPath/step/:stepId",CONFIRMATION:"/checkout/:checkoutPath/confirmation/:sessionId"},o=function(e){return"/checkout/".concat(e)},a=function(e,t){return"/checkout/".concat(e,"/step/").concat(t)},i=function(e,t){return"/checkout/".concat(e,"/confirmation/").concat(t)}},246249:function(e,t,r){r.d(t,{$G:()=>w,DE:()=>m,Df:()=>b,Iq:()=>a,J$:()=>s,L6:()=>h,Q0:()=>l,T$:()=>v,V1:()=>_,Wz:()=>f,Zb:()=>o,_H:()=>i,_x:()=>y,c1:()=>p,o9:()=>u,xG:()=>c});var n=r(165744),o=function(e,t){return e.find(function(e){return e.id===t})},a=function(e){return e.find(function(e){return 0===e.sequence})},i=function(e,t){return e.filter(function(e){return t.includes(e.status)})},l=function(e,t){if(e)return e.filter(function(e){return e.sequence>0&&(0,n.w0)(e)&&(!t||t!==e.id)}).sort(function(e,t){return e.sequence-t.sequence})[0]},u=function(e,t){return null==t?void 0:t.steps.find(function(t){return t.offers.some(function(t){return t.paywall.id===e})})},s=function(e){var t;return null==e||null==(t=e.offers)?void 0:t.find(function(e){return e.main})},c=function(e){var t;return null==e||null==(t=e.offers[0])?void 0:t.paywall},d=function(e){var t,r,n,o;return(null==e||null==(r=e.steps[0])||null==(t=r.community_member_subscription)?void 0:t.paywall_price)||(null==e||null==(o=e.steps[0])||null==(n=o.community_member_charge)?void 0:n.paywall_price)},p=function(e){var t;return null==(t=s(null==e?void 0:e.steps[0]))?void 0:t.paywall},f=function(e){var t;return null==(t=s(null==e?void 0:e.steps[0]))?void 0:t.paywall.id},m=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=null==e?void 0:e.offers[n];return(null==o||null==(r=o.paywall_offer)||null==(t=r.paywall_coupon)?void 0:t.code)||""},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null==e?void 0:e.offers[t];return null==r?void 0:r.paywall},b=function(e){return e?e.community_member_subscription||e.community_member_charge:null},v=function(e){return e?e.paywall_price:null},h=function(e){return(e||[]).reduce(function(e,t){var r;return Math.max((null==t||null==(r=t.community_member_charge)?void 0:r.amount)||0,0)+e},0)},_=function(e){return(null==e?void 0:e.created_at)?new Date(e.created_at):new Date},w=function(e){var t,r=p(e),n=d(e);return(null==n?void 0:n.redirect_event_url)||(null==r?void 0:r.redirect_url)||(null==e||null==(t=e.settings)?void 0:t.community_root_url)}},815791:function(e,t,r){r.d(t,{R:()=>s});var n=r(314121),o=r(564514),a=r(955970),i=r(442983),l=r(246249),u=r(81812),s=function(){var e=(0,o.k6)(),t=(0,o.UO)().checkoutPath,r=(0,a.i)().session,s=(0,i.P)();return{goToNextStep:(0,n.useCallback)(function(n){if(!t||!r||!s)return!1;var o=(0,l.Q0)(r.steps,n);if(o)return e.replace((0,u.QZ)(t,o.id)),!0;var a=(0,l.c1)(r),i=(0,l.$G)(r);return(null==a?void 0:a.thank_you_page_enabled)===!1&&i?location.replace(i):e.replace((0,u.UZ)(t,r.id)),!0},[t,e,s,r]),redirectAfterConfirmation:(0,n.useCallback)(function(){var e=(0,l.$G)(r);e&&location.replace(e)},[r])}}},36630:function(e,t,r){r.d(t,{Me:()=>i,O3:()=>l,m9:()=>a});var n=r(705206),o=r(599631);r(678731);var a=function(e,t){return(0,n.Lm)(t)?[n.Lt.CARD]:(0,n.F_)(t)||(0,n.u$)(t)?e?[n.Lt.CARD,n.Lt.LINK]:[n.Lt.CARD]:[t]},i=function(e,t,r,o){return(0,n.F_)(t)&&r&&!o?"":e},l=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,n.mG)(e)||t&&(0,n.dm)(e)?o.pB.off_session:null}},396335:function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),o.forEach(function(t){n(e,t,r[t])})}return e}r.d(t,{RY:()=>d});var a,i,l,u,s={variables:{borderRadius:"12px",colorPrimary:"#19283a"},rules:(n(l={},".AccordionItem",{padding:"1.5rem"}),n(l,".RadioIcon",{width:"18px"}),n(l,".RadioIconOuter",{stroke:"#D4D4D8"}),n(l,".RadioIconOuter--checked",{stroke:"#000000",strokeWidth:"28px"}),n(l,".RadioIconInner--checked",{r:"0"}),l)},c={appearance:{theme:"stripe",variables:{spacingGridRow:"20px"},rules:(n(u={},".Label",{color:"rgb(59, 59, 59)",fontFamily:'system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"14px",fontWeight:"600",lineHeight:"20px",margin:"0",padding:"0"}),n(u,".Input",{backgroundColor:"rgb(255, 255, 255)",border:"1px solid rgb(229, 231, 235)",borderColor:"rgb(229, 231, 235)",borderRadius:"8px",borderStyle:"solid",borderWidth:"1px",boxShadow:"none",color:"rgb(59, 59, 59)",fontFamily:'system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"16px",fontWeight:"400",lineHeight:"18px",margin:"0",marginTop:"4px",outline:"transparent solid 0px",outlineOffset:"0",padding:"12px 16px",transition:"none"}),n(u,".Input:focus",{border:"1px solid rgba(107, 114, 128)",borderColor:"rgba(107, 114, 128)",borderWidth:"1px",boxShadow:"none",outline:"transparent solid 0px",outlineOffset:"0",transition:"none"}),u)}}.appearance,d=(a=o({},c),i=i={variables:o({},c.variables,s.variables),rules:o({},c.rules,s.rules)},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(i)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))}),a)},620895:function(e,t,r){r.d(t,{u:()=>o});var n=r(314121),o=function(e){var t=e.billingInfo,r=e.name;return(0,n.useMemo)(function(){var e={};return t&&t.address_country&&(e.name=r,e.address={line1:t.address_line1,line2:t.address_line2,city:t.address_city,state:t.address_state,postal_code:t.address_postal_code,country:t.address_country}),e},[t,r])}},822993:function(e,t,r){r.d(t,{B:()=>o});var n=r(314121),o=function(){return(0,n.useMemo)(function(){return{name:"full"}},[])}},953337:function(e,t,r){r.d(t,{X:()=>o});var n=r(314121),o=function(){return(0,n.useMemo)(function(){return{phone:"never"}},[])}},849375:function(e,t,r){r.d(t,{wZ:()=>a,N2:()=>n,wF:()=>o});var n=function(e){return"completed"===e},o=function(e){return"delayed_confirmation"===e},a=function(e){return"processing"===e||"waiting_for_confirmation"===e}},451507:function(e,t,r){r.d(t,{E0:()=>s,G2:()=>i,eF:()=>u});var n=r(100334),o="great",a="none",i=function(e){return e.status===o},l=function(e,t){var r=0,i=a,l="",u="bg-neutral-200",s=t.length,c=[t.uppercase,t.number,t.symbol].filter(Boolean).length,d="paywalls.checkout.password_strength";return e?s&&3===c?(i=o,r=100,l=(0,n.t)("".concat(d,".great")),u="bg-green-600"):s&&c>=1?(i="better",r=20,l=(0,n.t)("".concat(d,".better")),u="bg-amber-400"):(i="weak",r=10,l=(0,n.t)("".concat(d,".weak")),u="bg-red-500"):(i=a,r=0,l="",u="bg-neutral-200"),{status:i,percentage:r,strengthMessage:l,progressBarColor:u}},u=function(e){var t,r,n={uppercase:/[A-Z]/.test(e),number:/\d/.test(e),symbol:/\W/.test(e),length:e.length>=6};return t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},l(e,n)),r=r={requirementsMet:n},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t},s=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="paywalls.checkout.password_requirement";if(i(e))return r?"":(0,n.t)("".concat(o,".success_message"));var a=[];return e.requirementsMet.length&&t||a.push((0,n.t)("".concat(o,".min_length"),{count:6})),t?(e.requirementsMet.uppercase||a.push((0,n.t)("".concat(o,".uppercase"))),e.requirementsMet.number||a.push((0,n.t)("".concat(o,".number"))),e.requirementsMet.symbol||a.push((0,n.t)("".concat(o,".symbol")))):(a.push((0,n.t)("".concat(o,".uppercase"))),a.push((0,n.t)("".concat(o,".number"))),a.push((0,n.t)("".concat(o,".symbol")))),(0,n.t)("".concat(o,".prefix"),{requirements:a.join(", ")})}},698365:function(e,t,r){r.d(t,{$Z:()=>s,Ll:()=>x,Um:()=>m,V5:()=>p,WI:()=>f,Wt:()=>v,bB:()=>g,d0:()=>d,hZ:()=>y,jS:()=>c,uf:()=>b});var n=r(214813),o=r(100334),a=r(727492),i=r(23919),l=r(588893),u=r(963381),s=function(e){return e===l.sI.REMAINING_TIME},c=function(e){return e===l.sI.FINISH_AT},d=function(e){return e===l.KW.REDIRECT_TO},p=10,f="skip_redirect",m="#063CFF",y={name:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.testimonials.fields.name_placeholder"),avatar_image_url:"",avatar_image:"",quote:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.testimonials.fields.quote_placeholder"),headline:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.testimonials.fields.headline_placeholder"),visible:!0,display_style:{type:a.y_.STARS,color:a.F_.STARS}},b={background_color:"#F6F6F6",icon:{emoji_type:"emoji",emoji:"\uD83D\uDE00"},label:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.badges.fields.label_placeholder"),text_color:"#000000",visible:!0},v={title:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.benefits.fields.title_placeholder"),description:(0,o.t)("settings.paywalls.modal.tabs.checkout.builder.benefits.fields.description_placeholder"),icon:{emoji_type:"emoji",emoji:""}},h=function(e){var t=e.upfront_payment_amount||0,r=e.amount;return(0,u.ZN)(e)?{amount:r,upfront_amount:0}:(0,u.t3)(e)?{amount:r-t,upfront_amount:t}:{amount:r,upfront_amount:t}},_=function(e,t,r){if((null==e?void 0:e._destroy)||!t)return null;var n=(0,i.Bj)(t),o=(r||[]).find(function(t){return t.price_id===((null==e?void 0:e.id)||(null==e?void 0:e.tmp_id))}),a=h(e);return{price_id:(null==o?void 0:o.price_id)||(null==e?void 0:e.id)||(null==e?void 0:e.tmp_id),amount:n((null==o?void 0:o.amount)||a.amount)||0,original_amount:n(a.amount),upfront_amount:n((null==o?void 0:o.upfront_amount)||a.upfront_amount)||0,original_upfront_amount:n(a.upfront_amount),enabled:(null==o?void 0:o.enabled)||!1}},w=function(e,t){if(null==e?void 0:e._destroy)return null;var r=(t||[]).find(function(t){return t.price_id===((null==e?void 0:e.id)||(null==e?void 0:e.tmp_id))});return r||{price_id:(null==e?void 0:e.id)||(null==e?void 0:e.tmp_id),callout_text:"",highlighted:!1}},g=function(e,t){return(0,n.compact)(e.map(function(e){return w(e,t)}))},x=function(e,t,r){return(0,n.compact)(e.map(function(e){return _(e,r,t)}))}},557273:function(e,t,r){r.d(t,{C:()=>l,O:()=>i});var n=r(448773),o=r(722024),a={en:"en",pt:"pt-BR","pt-PT":"pt",es:"es",fr:"fr",it:"it"},i=function(e){var t,r=e.stripeAccountId,o=e.stripePublicKey,i={stripeAccount:r,locale:a[null!=(t=e.locale)?t:"en"]};return("development"===window.RAILS_ENV||"staging"===window.RAILS_ENV)&&(i.developerTools={assistant:{enabled:!0}}),(0,n.J)(o,i)},l=function(){var e,t,r=(0,o.wh)().currentCommunity;return{stripePromise:i({stripeAccountId:null==r||null==(e=r.payment_processor)?void 0:e.id,stripePublicKey:(null==r||null==(t=r.payment_processor)?void 0:t.public_api_key)||window.STRIPE_PUBLIC_KEY,locale:window.locale||"en"})}}},442983:function(e,t,r){r.d(t,{P:()=>o});var n=r(722024),o=function(){var e=(0,n.wh)().currentCommunitySettings;return!!(null==e?void 0:e.paywall_upsells_enabled)}},588893:function(e,t,r){r.d(t,{BG:()=>a,KW:()=>n,sI:()=>o});var n={DO_NOTHING:"do_nothing",REDIRECT_TO:"redirect_to"},o={REMAINING_TIME:"remaining_time",FINISH_AT:"finish_at"},a={EMOJI:"emoji",CUSTOM:"custom",SHAPES:"shapes",ICONS:"icons"}},668774:function(e,t,r){r.d(t,{l:()=>o,z:()=>n});var n={pending:"pending",completed:"completed",abandoned:"abandoned",skipped:"skipped"},o={pending:"pending",completed:"completed",abandoned:"abandoned",offered:"offered",processing:"processing",declined:"declined",failed:"failed",skipped:"skipped"}},967561:function(e,t,r){r.d(t,{R:()=>o,n:()=>n});var n={br:"BR",us:"US"},o=function(e,t){var r,n,o,a,i=null!=(o=null==e||null==(r=e.toUpperCase())?void 0:r.trim())?o:"",l=null!=(a=null==t||null==(n=t.toUpperCase())?void 0:n.trim())?a:"";return!!(i&&l&&i===l)}},84440:function(e,t,r){r.d(t,{g:()=>c});var n=r(314121),o=r(244289),a=r(100334),i=r(967561),l=r(421065),u=r(674798);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var c=function(e){var t=e.fieldNames,r=e.isBrazilianCommunity,c=e.isTaxCollectionEnabled,d=e.selectedCountry,p=t.taxIdType,f=t.taxIdTypeLabel,m=t.taxIdValue,y=(0,o.Gc)(),b=y.setValue,v=(0,y.watch)(f),h=(0,l.SU)(v),_=(0,n.useRef)(null),w=(0,i.R)(d,i.n.br),g=(0,n.useMemo)(function(){return d?u.A.filter(function(e){return(0,i.R)(e.countryCode,d)}):u.A},[d]),x=(0,n.useMemo)(function(){return g.map(l.xG)},[g]),j=(0,n.useMemo)(function(){return(r||c)&&g.length>0},[r,c,g]),O=(0,n.useMemo)(function(){var e=function(e){if(Array.isArray(e))return s(e)}(x)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(x)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}}(x)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return w||e.unshift({value:"",text:(0,a.t)("not_applicable")}),e},[x,w]);(0,n.useEffect)(function(){h?b(p,h.enum):(b(p,""),b(m,""))},[h,b,p,m]),(0,n.useEffect)(function(){var e=d||null,t=_.current!==e;e&&h&&!(0,i.R)(h.countryCode,e)&&b(f,""),t&&e&&1===g.length&&b(f,g[0].label,{shouldDirty:!0}),_.current=e},[d,h,g,b,f]),(0,n.useEffect)(function(){if(r&&w&&!v){var e=(0,l.Re)();e&&b(f,e.label,{shouldDirty:!0})}},[r,b,w,f,v]);var P=(0,n.useCallback)(function(e){b(f,e.value,{shouldDirty:!0})},[b,f]),S=w||!!h;return{handleTaxIdTypeChange:P,isRequired:w,isTaxIdValueRequired:S,isVisible:j,selectedTaxIdType:h,selectOptions:O,taxIdTypeLabel:v}}}}]);
//# sourceMappingURL=/packs/js/3526-ba4900150b873598.js.map